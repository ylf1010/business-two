var CON_VERSION = {
	release:'2017.10.19_155924',
	dir:	'nt6.91',
	script:	'2017.10.17',
	ntid:	'2017.10.17',
	im: 	'2017.10.17',
	chat:	'2017.10.17',
	publish:'2016.09.21_000000'
};
var CON_RULE = {};
var CON_SERVER = {
	flashserver:'http://downtjx.jxwmanage.com/t2d/',
	configserver:'http://downtjx.jxwmanage.com/'
};

/* @file nt1.js
 * @date 2017.10.17 18:52:26 
 */
(function(window,underfined){var root,readyList=[],loadList={},core_strUndefined=typeof undefined,location=window.location,document=window.document,navigator=window.navigator,core_deletedIds=[],class2type={},core_push=core_deletedIds.push,core_slice=core_deletedIds.slice,core_hasOwn=class2type.hasOwnProperty,core_version="2015.09.23",rQuickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,rSingleTag=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,cssValueExp=/[\-\+0-9\.]/gi,rCamelCase=/-([a-z])/gi,clearHtmlExp=/(<.*?>)/gi,nTalk=function(selector,context){return new nTalk.fn.init(selector,context,root)},readyComplete=false,emptyFunc=function(){};nTalk.fn=nTalk.prototype={talkVersion:core_version,constructor:nTalk,init:function(selector,context,root){var match,elem;if(!selector){return this}if(typeof selector==="string"){if(selector.charAt(0)==="<"&&selector.charAt(selector.length-1)===">"&&selector.length>=3){match=[null,selector,null]}else{match=rQuickExpr.exec(selector)}if(match&&(match[1]||!context)){if(match[1]){context=context instanceof nTalk?context[0]:context;nTalk.merge(this,nTalk.parseHTML(match[1],context&&context.nodeType?context.ownerDocument||context:document,true));return this}else{elem=document.getElementById(match[2]);if(elem&&elem.parentNode){this.length=1;this[0]=elem}this.context=document;this.selector=selector;return this}}else if(!context||context.talkVersion){return(context||root).find(selector)}else{return this.constructor(context).find(selector)}}else if(selector.nodeType||nTalk.isWindow(selector)){this.context=this[0]=selector;this.length=1;return this}else if(nTalk.isObject(selector)&&selector.talkVersion){if(selector.length){this.context=this[0]=selector[0];this.length=1}return this}else if(nTalk.isPlainObject(selector)){var tag=selector.tag||"div";delete selector.tag;this.context=this[0]=nTalk.Element(tag,selector);this.length=1;return this}else if(nTalk.isFunction(selector)){return nTalk.ready(selector)}if(selector.selector!==undefined){this.selector=selector.selector;this.context=selector.context}return nTalk.merge(this,[selector])},selector:"",length:0,toArray:function(){return core_slice.call(this)},get:function(num){return num===null?this.toArray():num<0?this[this.length+num]:this[num]},pushStack:function(elems){var ret=nTalk.merge(this.constructor(),elems);ret.prevObject=this;ret.context=this.context;return ret},slice:function(){return this.pushStack(core_slice.apply(this,arguments))},eq:function(i){var len=this.length,j=+i+(i<0?len:0);return this.pushStack(j>=0&&j<len?[this[j]]:[])},first:function(){return this.eq(0)},last:function(){return this.eq(this.length-1)},each:function(callback,args){return nTalk.each(this,callback,args)},find:function(selector){var child=this.constructor.selector.query(selector,this);return this.pushStack(child)},push:core_push,sort:[].sort,splice:[].splice};nTalk.fn.init.prototype=nTalk.fn;nTalk.extend=nTalk.fn.extend=function(){var options,src,copy,copyIsArray,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=false;if(typeof target==="boolean"){deep=target;target=arguments[1]||{};i=2}if(typeof target!=="object"&&!nTalk.isFunction(target)){target={}}if(length===i){target=this;--i}for(;i<length;i++){options=arguments[i];if(options){for(var key in options){if(!options.hasOwnProperty(key))continue;src=target[key];copy=options[key];if(target===copy){continue}if(deep&&copy&&(nTalk.isPlainObject(copy)||(copyIsArray=nTalk.isArray(copy)))){if(copyIsArray){copyIsArray=false;clone=src&&nTalk.isArray(src)?src:[]}else{clone=src&&nTalk.isPlainObject(src)?src:{}}target[key]=nTalk.extend(deep,clone,copy)}else if(copy!==undefined){target[key]=copy}}}}return target};nTalk.extend({CON_CACHE_COOKIE:"nTalk_CACHE_DATA",CON_MANAGE_COOKIE:"nTalk_PAGE_MANAGE",CON_PCID_KEY:"NTKF_T2D_CLIENTID",CON_CONNECT_FLASH:"FLASH",CON_CONNECT_COMET:"COMET",STYLE_BODY:"margin:0;padding:0;border:none;float:none;width:auto;height:auto;min-width:none;min-height:none;max-width:none;max-height:none;clear:none;position:static;left:auto;top:auto;right:auto;bottom:auto;text-align:left;box-sizing:content-box;color:#000;background-color:transparent;font:normal normal normal 12px/160% Arial,Microsoft YaHei;",STYLE_NBODY:"margin:0;padding:0;border:none;float:none;width:auto;height:auto;min-width:none;min-height:none;max-width:none;max-height:none;clear:none;position:static;left:auto;top:auto;right:auto;bottom:auto;text-align:left;box-sizing:content-box;color:#000;background-color:transparent;font:normal normal normal 0px/0px Arial,Microsoft YaHei;",isReady:false,Log:emptyFunc,charset:document.charset||document.characterSet,language:navigator.language||navigator.systemLanguage,protocol:location.protocol,url:location.href,title:document.title,referrer:document.referrer,source:"",domain:"",baseProtocol:"",baseURI:"",sourceURI:"",baseName:"",baseExt:"",extParmas:{},pageURI:"",pageName:"",params:null,hashParams:null,user:{},lang:null,server:null,global:{},IMPRESENCE:null,version:{pub:core_version},elementParent:null,elementBefore:null,themesURI:"",isNumeric:function(obj){return!isNaN(parseFloat(obj))&&isFinite(obj)},isBoolean:function(v){return typeof v==="boolean"},isDefined:function(v){return typeof v!=="undefined"},isWindow:function(obj){return obj&&obj==obj.window},isFunction:function(obj){return Object.prototype.toString.call(obj)==="[object Function]"},isArray:function(obj){return nTalk.isFunction(Array.isArray)?Array.isArray(obj):Object.prototype.toString.call(obj)==="[object Array]"},isObject:function(obj){return Object.prototype.toString.call(obj)==="[object Object]"&&obj&&!this.isDefined(obj.nodeType)},isEmptyObject:function(obj){for(var name in obj){if(!obj.hasOwnProperty(name))continue;return false}return true},isPlainObject:function(obj){if(typeof obj!=="object"||obj.nodeType||this.isWindow(obj)){return false}try{if(obj.constructor&&!core_hasOwn.call(obj.constructor.prototype,"isPrototypeOf")){return false}}catch(e){return false}return true},getWindow:function(elem){return nTalk.isWindow(elem)?elem:elem.nodeType===9&&elem.defaultView},bind:function(object,func){var args=Array.prototype.slice.call(arguments).slice(2);return function(event){return func.apply(object,[event||window.event].concat(args))}},parseHTML:function(html,context){if(!html||typeof html!=="string"){return null}context=context||document;var parsed=rSingleTag.exec(html);if(parsed){return[context.createElement(parsed[1])]}if(!/<|&#?\w+;/.test(html)){return[context.createTextNode(html)]}else{var tmp=context.createElement("div");tmp.innerHTML=html;return nTalk.merge([],tmp.childNodes)}},merge:function(){var target=arguments[0]||{},args=arguments,i,k,len;if(args.length<=1)return target;for(i=1;i<args.length;i++){if(!args[i]||args[i]===null)continue;if(args[i].length===undefined){for(k in args[i]){if(!args[i].hasOwnProperty(k))continue;target[k]=args[i][k]}}else{for(k=0,len=args[i].length;k<len;k++){if(target.length!==undefined)target.push(args[i][k]);else target[k]=args[i][k]}}}return target},each:function(obj,callback,args){if(!nTalk.isArray(args))args=[];if(nTalk.isArray(obj)||nTalk.isObject(obj)&&obj.talkVersion){for(var i=0;i<obj.length;){if(callback.apply(obj[i],[i,obj[i++]].concat(args))===false){break}}}else if(nTalk.isObject(obj)){for(var name in obj){if(!obj.hasOwnProperty(name))continue;callback.apply(obj[name],[name,obj[name]].concat(args))}}else{callback.apply(obj,[0,obj].concat(args))}return obj},access:function(elems,fn,key,value,chainable){var i=0,length=elems.length;if(nTalk.isPlainObject(key)){chainable=true;for(var k in key){if(!key.hasOwnProperty(k))continue;nTalk.access(elems,fn,k,key[k],true)}}else if(value!==undefined){chainable=true;for(;i<length;i++){fn(elems[i],key,value)}}return chainable?elems:length?fn(elems[0],key):null},strFormat:function(str,length){for(var result="",i=1,maxLength=length||2;i<=maxLength;i++)result+="0";result+=str||"";return result.substr(result.length-maxLength)},getTime:function(type){var time=(new Date).getTime(),random=Math.random()*1e3;random=this.strFormat(Math.floor(random),3);switch(type){case 2:return time.toString()+random;case 1:return time+random;default:return time}},secondsToMinutes:function(seconds){var a="",b=seconds,f=this.strFormat;if(b>=60){a+=f(Math.floor(b/60));b=b%60}else{a+="00"}return a+":"+f(b)},formatDate:function(time,format){var cDate,regs;if(this.isNumeric(time)){cDate=new Date(time)}else if(typeof time=="string"){cDate=new Date;format=time}else{cDate=new Date}format=format||"HH:mm:ss";regs={"M+":cDate.getMonth()+1,"d+":cDate.getDate(),"h+":cDate.getHours()%12===0?12:cDate.getHours()%12,"H+":cDate.getHours(),"m+":cDate.getMinutes(),"s+":cDate.getSeconds(),"q+":Math.floor((cDate.getMonth()+3)/3),"S+":cDate.getMilliseconds()};if(/(y+)/i.test(format)){format=format.replace(RegExp.$1,(cDate.getFullYear()+"").substr(4-RegExp.$1.length))}for(var k in regs){if(regs.hasOwnProperty(k)&&new RegExp("("+k+")").test(format)){if(RegExp.$1=="S"){format=format.replace(RegExp.$1,("00"+regs[k]).substr(3))}else{format=format.replace(RegExp.$1,RegExp.$1.length==1?regs[k]:("00"+regs[k]).substr((""+regs[k]).length))}}}return format},randomChar:function(len,radix){var tmp="",l=len||8,strR=radix==10?"0123456789":"0123456789ABCDEF";for(var i=0;i<l;i++){tmp+=strR.charAt(Math.round(Math.random()*(strR.length-1)))}return tmp}});nTalk.selector={tagGuid:1,attrMap:{"class":"className","for":"htmlFor"},rex:{R_RULE:/[ +>~]/g,NR_RULE:/[^ +>~]+/g,TRIM_LR:/^ +| +$/g,TRIM_ALL:/ *([ +>~,]) */g,PSEU_PARAM:/\([^()]+\)/g,ATTR_PARAM:/[^\[]+(?=])/g,ATTR:/=|!=|\^=|\$=|\*=|~=|\|=/,CLS:/\./g,PSEU:/[^:]+/g,NUM:/\d+/,NTH:/(-?\d*)n([+-]?\d*)/,RULES:/((?:#.+)*)([a-zA-Z1-6*]*)([^\[:]*)((?:\[.+])*)((?::.+)*)/},query:function(selector,context){if(typeof selector=="undefined"||!selector)return[];var results=[],selectors,contexts,rules,i,j,n,m;switch(typeof context){case"undefined":contexts=[document];break;case"string":selector=context+" "+selector;contexts=[document];break;case"object":if(context.nodeType){contexts=[context]}else{contexts=context}}selectors=this.format(selector);context=contexts;for(i=0,j=selectors.length;i<j;i++){selector=selectors[i];rules=(" "+selector).match(this.rex.R_RULE);selector=selector.match(this.rex.NR_RULE);contexts=context;for(n=0,m=rules.length;n<m;n++){contexts=this.parse(selector[n],contexts,rules[n])}results=results.concat(contexts)}if(j>1){return this.makeDiff(results)}return results},format:function(selector){var pseuParams=[],attrParams=[];this.pseuParams=pseuParams;this.attrParams=attrParams;selector=selector.replace(this.rex.TRIM_LR,"").replace(this.rex.TRIM_ALL,"$1").replace(this.rex.ATTR_PARAM,function(match){return attrParams.push(match)-1});var tmpFunc=function(match){return pseuParams.push(match.substring(1,match.length-1))-1};while(selector.indexOf("(")!==-1){selector=selector.replace(this.rex.PSEU_PARAM,tmpFunc)}return selector.split(",")},parse:function(selector,contexts,rule){var matched,rules,id,cls,attrs,pseudos;rules=this.rex.RULES.exec(selector);if(id=rules[1]){if(id=document.getElementById(id.substring(1))){return[id]}return[]}matched=nTalk.selector.queryRelative[rule](contexts,rules[2]||"*",this);if(cls=rules[3]){matched=this.filterClass(matched,cls.replace(this.rex.CLS,""))}if(attrs=rules[4]){matched=this.filterAttr(matched,this.getAttrRules(attrs.match(this.rex.ATTR_PARAM),this.attrParams))}if(pseudos=rules[5]){matched=this.filterPseudo(matched,this.getPseudoRules(pseudos.match(this.rex.PSEU),this.pseuParams))}return matched},getRules:function(selector){var rules,attrs,pseudos;rules=this.rex.RULES.exec(selector);if(!rules[2]){rules[2]="*"}rules[3]=rules[3].replace(this.rex.CLS,"");if(attrs=rules[4]){rules[4]=this.getAttrRules(attrs.match(this.rex.ATTR_PARAM),this.attrParams)}if(pseudos=rules[5]){rules[5]=this.getPseudoRules(pseudos.match(this.rex.PSEU),this.pseuParams)}return rules},getAttrRules:function(attrs,attrParams){var arr=[],len=attrs.length,rex=this.rex.ATTR,i=0,attr,rule;for(;i<len;i++){attr=attrParams[attrs[i]];rule=attr.match(rex)||" ";attr=attr.split(rex);arr.push(nTalk.selector.queryAttrs[rule]);arr.push(attr)}return arr},getPseudoRules:function(pseudos,pseuParams){var arr=[],i=0,len=pseudos.length,guid=this.tagGuid++,name,param,rules;for(;i<len;i++){name=pseudos[i];if(this.rex.NUM.test(name)){param=pseuParams[RegExp["$&"]];name=RegExp["$`"];switch(name){case"nth-child":if(this.rex.NTH.test(param==="odd"&&"2n+1"||param==="even"&&"2n"||param)){param=RegExp.$1;param=param===""?1:param==="-"?-1:param;param=[guid,true,param,RegExp.$2];if(param[2]===1&&param[3]===0){continue}}else{param=[guid,false,param]}break;case"not":rules=param.split(",");param=[];while(rules.length){param.push(this.getRules(rules.pop()))}break;case"contains":}}arr.push(nTalk.selector.queryPseudos[name]);arr.push(param)}return arr},filterPseudo:function(els,pseudoRules){var len=els.length,i=0,m=pseudoRules.length,matched=[],n,el,pseudo,param;for(;i<len;i++){el=els[i];for(n=0;n<m;n+=2){pseudo=pseudoRules[n];param=pseudoRules[n+1];if(!pseudo||!pseudo(el,param,this)){break}}if(n===m){matched.push(el)}}return matched},filterAttr:function(els,attrRules){var len=els.length,i=0,m=attrRules.length,matched=[],n,el,attr,rule,val,name;for(;i<len;i++){el=els[i];for(n=0;n<m;n+=2){rule=attrRules[n];attr=attrRules[n+1];name=attr[0];if(!(val=name==="href"?el.getAttribute(name):el.getAttribute(name))){if(!(val=el[this.attrMap[name]||name])){break}}if(!rule(val+"",attr[1])){break}}if(n===m){matched.push(el)}}return matched},filterClass:function(els,cls){var i=0,len=els.length,matched=[],clsName,rex,el;for(;i<len;i++){el=els[i];if(typeof el.className=="string"){clsName=el.className;rex=new RegExp(clsName.replace(" ","|"),"g");if(!cls.replace(rex,"")){matched.push(el)}}}return matched},filterEl:function(el,tag,cls,attrRules,pseudoRules){if(tag!=="*"&&el.nodeName.toLowerCase()!==tag){return false}if(cls&&!this.filterClass([el],cls).length){return false}if(attrRules&&!this.filterAttr([el],attrRules).length){return false}return!(pseudoRules&&!this.filterPseudo([el],pseudoRules).length)},makeDiff:function(arr){var gUid=this.tagGuid++,len=arr.length,diff=[],i=0,el,data;for(;i<len;i++){el=arr[i];data=this.getElData(el);if(data.tagGuid!==gUid){diff.push(el);data.tagGuid=gUid}}return diff},getElData:function(el){var data=el.mojoExpando;if(!data){data=el.mojoExpando={mQuery:{tagGuid:0}}}if(!(data=data.mQuery)){data={tagGuid:0}}return data},queryRelative:{" ":function(contexts,tag,joQuery){var guid=joQuery.tagGuid++,len=contexts.length,arr=[],i=0,n,m,nodes,el,pel;for(;i<len;i++){el=contexts[i];if(pel=el.parentNode){if(joQuery.getElData(pel).tagGuid===guid){continue}joQuery.getElData(el).tagGuid=guid}nodes=el.getElementsByTagName(tag)||null;for(n=0,m=nodes.length;n<m;n++){arr.push(nodes[n])}}return arr},">":function(contexts,tag){var arr=[],len=contexts.length,i=0,el;for(;i<len;i++){el=contexts[i].firstChild;while(el){if(el.nodeType===1){if(el.nodeName.toLowerCase()===tag||tag==="*"){arr.push(el)}}el=el.nextSibling}}return arr},"+":function(contexts,tag){var arr=[],len=contexts.length,i=0,el;for(;i<len;i++){el=contexts[i];while(el=el.nextSibling){if(el.nodeType===1){if(el.nodeName.toLowerCase()===tag||tag==="*"){arr.push(el)}break}}}return arr},"~":function(contexts,tag,joQuery){var guid=joQuery.tagGuid++,len=contexts.length,arr=[],i=0,el,pel,data;for(;i<len;i++){el=contexts[i];if(pel=el.parentNode){if((data=joQuery.getElData(pel)).tagGuid===guid){continue}data.tagGuid=guid}while(el=el.nextSibling){if(el.nodeType===1){if(el.nodeName.toLowerCase()===tag||tag==="*"){arr.push(el)}}}}return arr}},queryAttrs:{" ":function(){return true},"=":function(attrVal,inputVal){return attrVal===inputVal},"!=":function(attrVal,inputVal){return attrVal!==inputVal},"^=":function(attrVal,inputVal){return attrVal.indexOf(inputVal)===0},"$=":function(attrVal,inputVal){return attrVal.substring(attrVal.length-inputVal.length)===inputVal},"*=":function(attrVal,inputVal){return attrVal.indexOf(inputVal)!==-1},"~=":function(attrVal,inputVal){return(" "+attrVal+" ").indexOf(" "+inputVal+" ")!==-1},"|=":function(attrVal,inputVal){return attrVal===inputVal||attrVal.substring(0,inputVal.length+1)===inputVal+"-"}},queryPseudos:{eq:function(el,param,joQuery){var pel,index,node,i,data;if((pel=el.parentNode)&&(data=joQuery.getElData(pel)).tagGuid!==param){node=pel.firstChild;i=1;while(node){if(node.nodeType===1){joQuery.getElData(node).nodeIndex=i++}node=node.nextSibling}data.tagGuid=param}index=joQuery.getElData(el).nodeIndex;return index==param},lt:function(el,param,joQuery){var pel,index,node,i,data;if((pel=el.parentNode)&&(data=joQuery.getElData(pel)).tagGuid!==param){node=pel.firstChild;i=1;while(node){if(node.nodeType===1){joQuery.getElData(node).nodeIndex=i++}node=node.nextSibling}data.tagGuid=param}index=joQuery.getElData(el).nodeIndex;return index<param},gt:function(el,param,joQuery){var pel,index,node,i,data;if((pel=el.parentNode)&&(data=joQuery.getElData(pel)).tagGuid!==param){node=pel.firstChild;i=1;while(node){if(node.nodeType===1){joQuery.getElData(node).nodeIndex=i++}node=node.nextSibling}data.tagGuid=param}index=joQuery.getElData(el).nodeIndex;return index>param},"first-child":function(el){while(el=el.previousSibling){if(el.nodeType===1){return false}}return true},"last-child":function(el){while(el=el.nextSibling){if(el.nodeType===1){return false}}return true},"only-child":function(el){var next=el.nextSibling,pre=el.previousSibling;while(next){if(next.nodeType===1){return false}next=next.nextSibling}while(pre){if(pre.nodeType===1){return false}pre=pre.previousSibling}return true},"nth-child":function(el,param,joQuery){var pel,index,node,i,data;if((pel=el.parentNode)&&(data=joQuery.getElData(pel)).tagGuid!==param[0]){node=pel.firstChild;i=1;while(node){if(node.nodeType===1){joQuery.getElData(node).nodeIndex=i++}node=node.nextSibling}data.tagGuid=param[0]}index=joQuery.getElData(el).nodeIndex;if(param[1]){index=index-param[3];param=param[2];return index*param>=0&&index%param===0}return index===param[2]},not:function(el,params,joQuery){var i=0,len=params.length,param;for(;i<len;i++){param=params[i];if(param[1]){if("#"+el.id!==param[1]){continue}return false}if(joQuery.filterEl(el,param[2],param[3],param[4],param[5])){return false}}return true},contains:function(el,text){return(el.textContent||el.innerText||"").indexOf(text)>-1},enabled:function(el){return el.disabled===false},disabled:function(el){return el.disabled===true},checked:function(el){return el.checked===true},empty:function(el){return!el.firstChild}}};nTalk.Class={create:function(){return function(){this.initialize.apply(this,arguments)}}};nTalk.extend({initializeCore:function(){var domain=/([^\.]+(\.com(\.cn)?|\.net(\.cn)?|\.edu(\.cn)?|\.org(\.cn)?|\.gov(\.cn)?|\.cn|\.mobi|\.tel|\.asia|\.me|\.info|\.hk|\.cc|\.biz|\.tv))$/i.exec(document.domain),match=/(.*\/)(.*?\.\w+)?([\?#].*)?$/gi.exec(location.protocol+"//"+document.domain+location.pathname),strParams="";root=nTalk(document);var ntkfscript=nTalk("script[src*=ntkf]");var baseoutscript=nTalk("script[src*=base.out]");var scripts=[];if(ntkfscript&&ntkfscript.length!=0){scripts.push(ntkfscript[0])}if(baseoutscript&&baseoutscript.length!=0){scripts.push(baseoutscript[0])}for(var i=0,l=scripts.length;i<l;i++){var element=scripts[i];if(!element.src)return;var match=/^((https?:).*\/)?(.*?\.js)?(\?.*)?/gi.exec(element.src);if(match&&match[1]&&match[3]&&/^((ntkfstat|ntkf|base\.out).*?)\.js/gi.test(match[3])&&match[4]&&match[4].indexOf("siteid")>-1){nTalk.baseProtocol=match[2]||nTalk.protocol;nTalk.baseURI=match[1]||nTalk.pageURI;nTalk.baseName=match[3];strParams=match[4]?match[4]:"";nTalk.elementParent=element.parentNode;nTalk.elementBefore=element}}if(!nTalk.baseURI){throw"get script url failure"}nTalk.domain=domain&&domain[0]||document.domain;nTalk.pageURI=match&&match[1]?match[1]:"";nTalk.pageName=match&&match[2]?match[2]:"";nTalk.params=nTalk.uriToJSON(location.search.substr(1));nTalk.hash=location.hash?location.href.substr(location.href.indexOf("#")+1):"";nTalk.hashParams=nTalk.uriToJSON(nTalk.hash);nTalk.loadList=loadList;if(nTalk.flash.support&&!nTalk.browser.mobile){nTalk.global.connect=nTalk.CON_CONNECT_FLASH}else{nTalk.global.connect=nTalk.CON_CONNECT_COMET}if(nTalk.browser.msie6){try{document.execCommand("BackgroundImageCache",false,true)}catch(e){}}var arrs=strParams.length?strParams.substr(1).split("&"):["lan=zh_cn",""];for(var tmp,i=0;i<arrs.length;i++){tmp=arrs[i].split("=");nTalk.extParmas[tmp[0]]=tmp[0]=="lan"?tmp[1]||"zh_cn":tmp[1]}nTalk.cache.init()}});nTalk.browser=function(ua){var browser={"360ee":!1,lbbrowser:!1,se:!1,chrome:!1,safari:!1,msie:!1,firefox:!1,oupeng:!1,opera:!1,webkit:!1,iPod:!1,iPad:!1,iPhone:!1,android:!1,gecko:!1,windows:!1,"windows ce":!1,edge:!1,uc:!1,micromessenger:!1,weibo:!1},core=["applewebkit/([^\\s]*)","presto\\/([\\d.]*)","trident([^;]*)","gecko\\/([\\d.]*)","msie ([\\d.]*)"];var ISOldIOS=/OS (\d)_.* like Mac OS X/g.exec(window.navigator.userAgent);nTalk.each(browser,function(name){browser[name]=ua.indexOf(name.toLowerCase())>-1});browser.ua=ua;browser.ieversion=0;browser.coreversion=0;browser.mac=!!ua.match(/cpu.+mac\s+os\s+x/g);for(var j=0;j<core.length;j++){if(new RegExp(core[j],"i").test(ua)){if(j==core.length-1){browser.ieversion=RegExp["$1"]||RegExp["$2"]}else{browser.coreversion=RegExp["$1"]}}}browser.ieversion=document.documentMode||browser.ieversion||browser.ieversion;browser.msie=browser.msie||browser.ieversion>0;browser.gecko=browser.gecko&&!browser.webkit&&!browser.msie;browser.msie6=browser.msie&&browser.ieversion==6;browser.msie7=browser.msie&&browser.ieversion==7;browser.msie8=browser.msie&&browser.ieversion==8;browser.msie9=browser.msie&&browser.ieversion==9;browser.msie10=browser.msie&&browser.ieversion==10;browser.msie11=browser.msie&&browser.ieversion==11;browser.edge=browser.edge;browser.uc=browser.uc;browser.oldmsie=browser.ieversion&&browser.ieversion<=9;browser.safari=browser.safari&&!browser.chrome;browser.safari2=browser.safari&&!/adobeair/i.test(ua);browser.Quirks=document.compatMode==="BackCompat";browser.mobile=/mobile|android|linux/i.test(ua);browser.android=/android (\d.*?);/g.exec(ua);browser.oldAndroid=browser.android&&browser.android.pop().substr(0,3)<4.5;browser.oldIOS=ISOldIOS?+ISOldIOS.pop()<8:false;browser.iPhone6=browser.iPhone&&document.body.offsetWidth==375;browser.iPhone6Plus=browser.iPhone&&document.body.offsetWidth==414;browser.iOS=navigator.platform=="Mac68K"||navigator.platform=="MacPPC"||navigator.platform=="Macintosh"||ua.indexOf("mac")>-1;browser.is=function(keyword){return new RegExp(keyword,"ig").test(ua)};browser.html5=!!window.applicationCache;isStorageSupported=function(){var supported=null;try{supported=window.localStorage}catch(e){return false}if(supported){var mod="test";try{if(localStorage.getItem(mod)!==null){localStorage.removeItem(mod)}localStorage.setItem(mod,mod);if(localStorage.getItem(mod)==mod){localStorage.removeItem(mod);return true}else{return false}}catch(e){return false}}};browser.supportMqtt="WebSocket"in window&&window.WebSocket!==null&&"localStorage"in window&&window.localStorage!==null&&"ArrayBuffer"in window&&window.ArrayBuffer!==null&&isStorageSupported();return browser}(navigator.userAgent.toLowerCase());nTalk.extend({ready:function(fn){var self=this,readyState=document.readyState,oldWebkit=nTalk.browser.webkit&&nTalk.browser.version<525,completed=function(){if(readyComplete)return;if(!oldWebkit&&window.removeEventListener){document.removeEventListener("DOMContentLoaded",completed,false);window.removeEventListener("load",completed,false)}nTalk.isReady=readyComplete=true;for(var i=0;i<readyList.length;i++){readyList[i].apply(document)}readyList=[]};if(readyComplete||/loaded|complete/gi.test(readyState)){nTalk.isReady=readyComplete=true;fn.call(self)}else{readyList[readyList.length]=function(){return fn.call(self)}}if(oldWebkit){(function(){/^loaded|complete$/i.test(readyState)?completed():setTimeout(arguments.callee(),50)})()}else if(document.addEventListener){if(readyState=="interactive"){completed()}else{document.addEventListener("DOMContentLoaded",completed,false);window.addEventListener("load",completed,false)}}else{var temp=document.createElement("div");(function(){(function(){try{temp.doScroll("left");document.body.insertBefore(temp,document.body.lastChild).setAttribute("html","temp")}catch(e){}return temp})?completed():setTimeout(arguments.callee(),50)})()}},require:function(content,callback,bind){var queue=[],result=[],attrs,item=null,l,url;if(!content){return}content=typeof content==="string"?[content]:content;callback=callback||emptyFunc;bind=bind||document.head||nTalk("head")[0]||document.documentElement;l=nTalk._getObjectNumber(content);if(queue.length===0&&l===0){callback.apply(item,result)}nTalk.each(content,function(name,src){if(!src)return;var isImage,time=nTalk.getTime(),lchar=src.indexOf("?")==-1?"?":"&",fix=src.replace(/(.*\/)?(.*?)[\?$](.*)?/i,"$2"),modeName=!nTalk.isNumeric(name)?name:"",scriptComplete=function(){queue.splice(nTalk.inArray(src,queue),1);l--;if(queue.length===0&&l===0){callback.apply(item,result)}},scriptCompleteImg=function(){queue.splice(nTalk.inArray(src,queue),1);l--;callback.apply(item,result)},onScriptLoad=function(event){event=nTalk.Event.fixEvent(event);var node=event.currentTarget||event.srcElement;var reg=/loaded|complete/gi;var readyState=node.readyState;if(event.type==="load"||reg.test(readyState)){setTimeout(function(){if(modeName){loadList[fix]=nTalk[modeName];result.push(nTalk[modeName])}else{loadList[fix]=node;result.push(node)}scriptComplete()},nTalk.browser.msie6?500:0)}else if(event.type==="error"){event.error=true;result.push(modeName?false:event);scriptComplete()}};queue.push(src);fix+=src.indexOf("#rnd")>-1?String(time).substring(5,11):src.indexOf("#image")>-1?src.replace(/(.*?)\?(.*?)(#.*?)?$/gi,"-$2"):"";isImage=/\.((gif)|(png)|(jpg)|(bmp)|(jpeg))$/i.test(src)||/#image$/gi.test(src);isRobotImage=/#robotImg/gi.test(src);src=src.replace(/#rnd/i,lchar+"ts="+time).replace(/#image/i,"");url=(!/^(https?:\/\/)/i.test(src)?nTalk.baseURI:"")+src;if(modeName&&nTalk[modeName]){result.push(nTalk[modeName]);scriptComplete()}else if(!modeName&&loadList[fix]){result.push(loadList[fix]);scriptComplete()}else if(isImage){item=nTalk.preloadImage(url,function(elem){elem.error=false;loadList[fix]=elem;result.push(elem);scriptCompleteImg()},function(event){event.error=true;result.push(event);scriptComplete()},isRobotImage?120:6)}else{attrs=/\.css[^\.]*$/gi.test(src)?{tag:"link",type:"text/css",rel:"stylesheet",href:url}:{tag:"script",type:"text/javascript",async:"async",charset:"utf-8",src:url};if(attrs.tag=="script"&&modeName){attrs["data-requiremodule"]=modeName}item=nTalk(attrs).appendTo(bind);if(typeof item.get(0).onreadystatechange=="undefined"){item.bind("load",onScriptLoad).bind("error",onScriptLoad)}else{item.bind("readystatechange",onScriptLoad).bind("error",onScriptLoad)}}})},jsonp:function(url,callback){var args,callName="call_"+nTalk.randomChar(16);url=url+(/\?/gi.test(url)?"&":"?")+"callback="+callName;window[callName]=function(){args=arguments;setTimeout(function(){if(nTalk.isFunction(callback)){callback.apply(self,args)}},0);try{delete window[callName]}catch(e){}};nTalk.require(url,function(script){nTalk(script.error?script.target:this).remove()})},preloadImage:function(src,load,error,count){var self=this;load=load||emptyFunc;error=error||emptyFunc;var timeID,img=new Image;img.src=src;img.setAttribute("loadTime",0);if(img.complete){load.call(nTalk,img);return img}img.onload=function(){clearInterval(timeID);load.call(nTalk,this)};img.onError=function(){clearInterval(timeID);error.call(nTalk,this)};timeID=setInterval(function(){img.setAttribute("loadTime",parseInt(img.getAttribute("loadTime"))+1);if(parseInt(img.getAttribute("loadTime"),10)>=count){clearInterval(timeID);error.call(nTalk,self)}if(img.readyState!="complete"&&!nTalk.browser.msie7)return;clearInterval(timeID);img.onLoad=img.onError=null;load.call(nTalk,img)},500);return img},_getObjectNumber:function(obj){if(!obj){return false}else if(nTalk.isArray(obj)){return obj.length}else{var length=0;for(var k in obj){if(obj.hasOwnProperty(k))length++}return length}}});nTalk.cookie={enable:function(){var result=false,testCookie="testcookie";if(navigator.cookieEnabled){return true}this.set(testCookie,"yes",0);if(this.get(testCookie)=="yes")result=true;this.del(testCookie);return result},set:function(key,value,time,domain){var cDate,exp,_cookie,path;value=value||"";domain=domain?domain:""||nTalk.domain;if(typeof time!="number"){time=0}if(time===0){exp=nTalk.browser.msie||nTalk.browser.mobile?" ":"expires=0; "}else{cDate=new Date;cDate.setTime(cDate.getTime()+time);exp=cDate?"expires="+cDate.toGMTString()+"; ":""}domain="domain="+domain+"; ";_cookie=key+"="+(""+value).replace(/\"|\'/gi,"|")+"; ";path="path=/; ";document.cookie=_cookie+exp+domain+path;return value},get:function(key){var reg,_cookie=document.cookie;if(_cookie.length){reg=new RegExp("(?:^|;)\\s*"+key+"=(.*?)(?:;|$)").exec(_cookie);if(reg&&reg.length){return decodeURIComponent(reg[1].replace(/\|/gi,'"'))}}return null},del:function(key,domain){return this.set(key,"",1,domain)}};nTalk.flash=function(){var axo,counter,hasFlash=false,version=[0,0,0,0],fnRemove=function(selector){nTalk(selector).each(function(i,element){var tElement;if(nTalk.browser.msie||!element.parentNode){for(var k in element)try{eval("element."+k+"=null")}catch(e){}tElement=document.createElement("DIV");try{tElement.appendChild(element);tElement.innerHTML="";if(tElement.parentNode)tElement.parentNode.removeChild(tElement)}catch(e){}}else try{element.parentNode.removeChild(element)}catch(e){nTalk.Log("remove flash node failure",3)}})};if(navigator.plugins&&navigator.mimeTypes.length){var x=navigator.plugins["Shockwave Flash"];if(x&&x.version){hasFlash=true;version=x.version.split(".")}else if(x&&x.description){hasFlash=true;version=x.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+r|\s+b[0-9]+)/,".").split(".");if(version.length==3)version[version.length]=0}}else if(nTalk.browser["windows ce"]){axo=1;counter=3;while(axo){try{counter++;axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+counter);hasFlash=true;version=[counter,0,0]}catch(e){axo=null}}}else{try{axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");if(axo!==null){hasFlash=true;version=axo.GetVariable("$version").split(" ")[1].toString().replace(/,/g,".").split(".")}}catch(e){hasFlash=false}}return{remove:fnRemove,GT:gt,support:(version.join(".").indexOf("11.6.602")===0||version.join(".").indexOf("11.3.300")===0||!gt("10.3"))&&nTalk.browser.firefox||nTalk.browser.mac?false:hasFlash,version:version.join(".")};function gt(ver){var cv=version,v=(ver||"0.0.0").split(".").slice(0,3);return cv[0]>v[0]||cv[0]==v[0]&&cv[1]>v[1]||cv[0]==v[0]&&cv[1]==v[1]&&cv[2]>v[2]}}();nTalk.Event=function(){var addEvent,removeEvent,evtHash=[];if(window.addEventListener){addEvent=function(elem,type,handler,useCapture){if(type=="mouseenter")elem.addEventListener("mouseover",mouseEnter(handler),useCapture);else if(type=="mouseleave")elem.addEventListener("mouseout",mouseEnter(handler),useCapture);else elem.addEventListener(type,handler,useCapture)};removeEvent=function(elem,type,handler,useCapture){elem.removeEventListener(type,handler,useCapture)}}else{addEvent=function(elem,type,handler){var key="{FNKEY::obj_"+ieGetUniqueID(elem)+"::evt_"+type+"::fn_"+handler+"}",f=evtHash[key];if(typeof f!="undefined")return;f=function(_evt){handler.call(elem,_evt)};evtHash[key]=f;elem.attachEvent("on"+type,f);window.attachEvent("onunload",function(){try{elem.detachEvent("on"+type,f)}catch(e){}});key=null};removeEvent=function(elem,type,handler){var key="{FNKEY::obj_"+ieGetUniqueID(elem)+"::evt_"+type+"::fn_"+handler+"}",f=evtHash[key];if(typeof f!="undefined"){elem.detachEvent("on"+type,f);delete evtHash[key]}key=null}}function ieGetUniqueID(elem){return elem===window?"theWindow":elem===document?"theDocument":elem.uniqueID;
}function mouseEnter(_pFn){return function(_evt){var relTarget=_evt.relatedTarget;if(this==relTarget||isAChildOf(this,relTarget)){return}_pFn.call(this,_evt)}}function isAChildOf(_parent,_child){if(_parent==_child){return false}while(_child&&_child!=_parent){_child=_child.parentNode}return _child==_parent}function fixEvent(event){if(event&&event.target)return event;event=event||window.event;event.pageX=event.clientX+nTalk(window).scrollLeft();event.pageY=event.clientY+nTalk(window).scrollTop();event.target=event.srcElement;event.stopPropagation=stopPropagation;event.preventDefault=preventDefault;switch(event.type){case"mouseout":event.relatedTarget=event.toElement;break;case"mouseover":event.relatedTarget=event.fromElement;break}return event}function stopPropagation(){this.cancelBubble=true}function preventDefault(){this.returnValue=false}function fireEvent(elem,type){if(nTalk.browser.msie)try{elem.fireEvent("on"+type)}catch(e){return false}else{var htmlEvent=document.createEvent("HTMLEvents");htmlEvent.initEvent(type,true,true);try{if(elem)elem.dispatchEvent(htmlEvent)}catch(e){}}return true}return{__evtHash:evtHash,addEvent:addEvent,removeEvent:removeEvent,fixEvent:fixEvent,fireEvent:fireEvent}}();nTalk.JSON=function(){var toJSONString,parseJSON,gap,indent,rep,cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,reg=/[\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function quote(string){reg.lastIndex=0;return reg.test(string)?'"'+string.replace(reg,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,partial,mind=gap,value=holder[key];if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){k=rep[i];if(typeof k==="string"){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(value.hasOwnProperty(k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}toJSONString=function(value,replacer){if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.toString")}return str("",{"":value})};parseJSON=function(text,reviver){var j;function walk(holder,key){var v,value=holder[key];if(value&&typeof value==="object"){for(var k in value){if(value.hasOwnProperty(k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text).replace(/\r|\n/gi,"");if(text)try{text=nTalk.hexToDec(text)}catch(e){}cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.toJSON")};return{toJSONString:toJSONString,parseJSON:parseJSON}}();nTalk.HASH=nTalk.Class.create();nTalk.HASH.prototype={hashTable:null,hashIndex:null,initialize:function(){this.hashTable={};this.hashIndex=[]},add:function(key,value){if(typeof key===core_strUndefined)return false;if(!this.contains(key)){this.hashTable[key]=typeof value!==core_strUndefined?value:null;this.hashIndex.push(key);return true}else{return false}},remove:function(key){var next=this.next(key),i=this.index(key);delete this.hashTable[key];if(i!==false)this.hashIndex.splice(i,1);return this.hashTable[next]},first:function(){for(var k in this.hashTable){if(this.hashTable.hasOwnProperty(k))return this.hashTable[k]}},last:function(){var lastData=null;for(var k in this.hashTable){if(this.hashTable.hasOwnProperty(k)){lastData=this.hashTable[k]}}return lastData},previous:function(key){var preKey=null;for(var k in this.hashTable){if(!this.hashTable.hasOwnProperty(k))continue;if(k==key)return preKey;preKey=k}return preKey},next:function(key){var firstKey=null,getNext=false;for(var k in this.hashTable){if(!this.hashTable.hasOwnProperty(k))continue;if(!firstKey)firstKey=k;if(k==key){getNext=true;continue}if(getNext)return k}return firstKey},count:function(){var i=0;for(var k in this.hashTable){if(this.hashTable.hasOwnProperty(k))i++}return i},items:function(key,value){if(value){this.hashTable[key]=value;return this.hashTable[key]}else{return this.hashTable[key]}},index:function(key){for(var i=0;i<this.hashIndex.length;i++){if(this.hashIndex[i]==key)return i}return false},contains:function(key){return typeof this.hashTable[key]!="undefined"},clear:function(){for(var k in this.hashTable){if(this.hashTable.hasOwnProperty(k)){delete this.hashTable[k]}}this.hashIndex=[]},each:function(Fn){for(var k in this.hashTable){if(k&&this.hashTable.hasOwnProperty(k)){Fn.call(self,k,this.hashTable[k])}}}};nTalk.POST=nTalk.Class.create();nTalk.POST.prototype={iframeName:"",iframeElement:null,formName:"",formElement:null,hiddenElement:null,target:"",CON_TARGET:["_blank","_self","_parent","_top"],_stopCall:false,onComplete:null,onFailure:null,_loaded:false,initialize:function(url,DATA,callback,target){var data=nTalk.merge({},DATA),randomChar=nTalk.randomChar(16);if(nTalk.isArray(callback)){this.onComplete=callback[0]||emptyFunc;this.onFailure=callback[1]||emptyFunc}else{this.onComplete=callback||emptyFunc;this.onFailure=emptyFunc}this.target=target||"POST_IFRAME_"+randomChar;if(nTalk(".nTalk_post_hiddenElement").length>0){this.hiddenElement=nTalk("#nTalk_post_hiddenElement")}else{this.hiddenElement=nTalk({tag:"div",id:"nTalk_post_hiddenElement",style:"left:-10px;top:-10px;visibility:hidden;display:none;width:1px;height:1px;"}).appendTo(true)}if(nTalk.inArray(this.target,this.CON_TARGET)<0){this.iframeName=this.target;this.iframeElement=this.createIFrame(this.iframeName,"about:blank")}this.formName="POST_FORM_"+randomChar;this.formElement=this.form(url,data);try{this.formElement.submit()}catch(e){}},stopCall:function(){this._stopCall=true},createIFrame:function(iFName,uri){var self=this,iFrameElement,fnLoad=function(event){var element=this,readyState=element.readyState;if(!/^(?:loaded|complete|undefined)$/.test(readyState)||self._loaded)return;nTalk(element).removeEvent("readystatechange",fnLoad);nTalk(element).removeEvent("load",fnLoad);nTalk(element).removeEvent("error",fnError);self._loaded=true;if(!self._stopCall){self.onComplete.call(self,event,iFName)}window.frames[iFName]=window[iFName]=null;setTimeout(function(){nTalk(element).remove();nTalk(self.formElement).remove()},800)},fnError=function(event){var element=this;nTalk(element).removeEvent("readystatechange",fnLoad);nTalk(element).removeEvent("load",fnLoad);nTalk(element).removeEvent("error",fnError);if(!self._stopCall){self.onFailure.call(self,event,iFName)}window.frames[iFName]=window[iFName]=null;setTimeout(function(){nTalk(element).remove();nTalk(self.formElement).remove()},50)};if(window[iFName]){return window[iFName]}if(window.frames[iFName]){return window.frames[iFName]}iFrameElement=nTalk({tag:"IFRAME",name:iFName,id:iFName,src:uri,style:"left:-10px;top:-10px;visibility:hidden;width:1px;height:1px;"}).appendTo(this.hiddenElement);if(!nTalk.browser.safari){iFrameElement.css("position","absolute")}iFrameElement.bind("readystatechange",fnLoad).bind("load",fnLoad).bind("error",fnError);window[iFName]=iFrameElement.get(0);return window[iFName]},form:function(url,data){var formElement;formElement=nTalk({tag:"FORM",name:this.formName,"accept-charset":"utf-8",enctype:"application/x-www-form-urlencoded",method:"POST",style:"display:none;",target:this.target,action:url}).appendTo(this.hiddenElement);if(nTalk.isArray(data)){for(var i=0;i<data.length;i++){for(var name in data[i]){if(!data[i].hasOwnProperty(name))continue;this.input(name+"[]",data[i][name],formElement)}}}else{for(var y in data){if(!data.hasOwnProperty(y))continue;if(nTalk.isArray(data[y])){for(var j=0;j<data[y].length;j++){this.input(y+"[]",data[y][j],formElement)}}else{this.input(y,data[y],formElement)}}}return formElement.get(0)},input:function(name,value,parent){return nTalk({tag:"INPUT",type:"hidden",name:name,value:encodeURIComponent(/number|string/.test(typeof value)?value:nTalk.JSON.toJSONString(value))}).appendTo(parent)}};nTalk.extend({inArray:function(value,array){if(array.length==core_strUndefined){for(var name in array){if(!array.hasOwnProperty(name))continue;if(array[name]==value)return name}}else{for(var i=0,len=array.length;i<len;i++){if(array[i]==value)return i}}return-1},toURI:function(args,clearNull,separator){var t=[],sp=separator===undefined?"&":separator,add=function(k,v){var h=sp=="&"?k+"=":"",type=typeof args[name];switch(type){case"object":return v?h+encodeURIComponent(nTalk.JSON.toJSONString(v)):clearNull?"":h;case"function":case"undefined":return"";case"boolean":case"number":return h+v;default:return v?h+encodeURIComponent(v.replace(/\+/gi,"%2B")):clearNull?"":h}};if(nTalk.isPlainObject(args)){for(var name in args){if(!args.hasOwnProperty(name))continue;var kv=add(name,args[name]);if(kv)t.push(kv)}}else{return""}return t.join(sp).replace(/%20/g,"+")},uriToJSON:function(str){var target={},arr=str.toString().split("&");for(var arg,i=0;i<arr.length;i++){arg=arr[i].split("=");if(arg.length<2)continue;try{target[arg[0]]=decodeURIComponent(arg[1]||"")}catch(e){target[arg[0]]=arg[1]}}return target},whereGetTo:function(to,form,formkeys,tokeys){return nTalk.merge(to,this.whereGet(form,formkeys,tokeys))},whereGet:function(form,formkeys,tokeys,callback){var target={};if(formkeys&&nTalk.isArray(formkeys)){for(var i=0,l=formkeys.length;i<l;i++){if(tokeys&&tokeys[i]&&tokeys[i]!==formkeys[i])target[tokeys[i]]=!nTalk.isDefined(form[formkeys[i]])?"":form[formkeys[i]];else target[formkeys[i]]=!nTalk.isDefined(form[formkeys[i]])?"":form[formkeys[i]]}}else{target=form}if(!nTalk.isFunction(callback))return target;for(var k in target){if(!target.hasOwnProperty(k))continue;callback.call(this,target[k])}},enLength:function(str){str=str||"";try{return str.toString().replace(/[^\x00-\xFF]/g,"**").length}catch(e){nTalk.Log(e,3)}},enCut:function(str,len,ext){var l=nTalk.enLength(str);len=len||0;if(l<len){return""+(str||"")}for(var r=0,i=0;i<str.length;i++){r+=str.charCodeAt(i)>255?2:1;if(r==len||ext&&r==len-2){return str.substring(0,i+1)+(ext?"..":"")}else if(r>len||ext&&r>len-2){return str.substring(0,i)+(ext?"..":"")}}return str||""},camelize:function(word){return word.replace("-ms-","ms-").replace(rCamelCase,function(match,letter){return(letter+"").toUpperCase()})},clearHtml:function(html){html=html||"";return html.replace(clearHtmlExp,"")},protocolFilter:function(data,protocol){protocol=nTalk.flashserver.usehttps==1?"https:":protocol||nTalk.protocol;if(protocol=="file:"){protocol="http:"}if(nTalk.isObject(data)){for(var k in data){if(data.hasOwnProperty(k)){data[k]=this.protocolFilter(data[k],protocol)}}return data}else if(nTalk.isArray(data)){for(var i=0;i<data.length;i++){data[i]=this.protocolFilter(data[i],protocol)}return data}else if(nTalk.isNumeric(data)||nTalk.isBoolean(data)||nTalk.isFunction(data)){return data}else if(typeof data!=="undefined"){return!data?data:data.toString().replace(/^https?:/gi,protocol).replace(/^rtmps?:/gi,protocol=="https:"?"rtmps:":"rtmp:").replace(/^wss?:/gi,protocol=="https:"?"wss:":"ws:")}},decToHex:function(source){var res=[];for(var i=0;i<source.length;i++){if(/[\u4e00-\u9fa5]/i.test(source.charAt(i))){res[i]="\\u"+("00"+source.charCodeAt(i).toString(16)).slice(-4)}else{res[i]=source.charAt(i)}}return res.join("")},hexToDec:function(source){if(!source)return"";var reg=/\\u([0-9a-zA-Z]{2,4})|&#(\d+);/gi;var arrs=source.match(reg),strOutScript=source;if(!arrs){return strOutScript}else{for(var i=0;i<=arrs.length;i++){if(!arrs[i])continue;var strHex,strChar,isError=false;strHex=arrs[i].replace("\\u","");for(var j=0;j<strHex.length;j++){if("0123456789abcdef".indexOf(strHex.charAt(j))==-1){isError=true}}if(!isError){strChar=String.fromCharCode(parseInt(strHex,16));strOutScript=strOutScript.replace(arrs[i],strChar)}}}return strOutScript}});nTalk.extend({Element:function(tag,options){var elem,html,attr="";tag=tag.toLocaleUpperCase();if(nTalk.inArray(tag,["IFRAME","FORM","INPUT","SELECT","TEXTAREA"])>-1){try{if(tag=="FORM"){attr=(options.method?' method="'+options.method+'"':"")+(options.enctype?' enctype="'+options.enctype+'"':"")}html="<"+tag+' name="'+(options.name||nTalk.randomChar(16))+'"'+attr+"></"+tag+">";elem=document.createElement(html);delete options.name}catch(e){elem=document.createElement(tag)}}else{elem=tag==="comment"?document.createComment(options.text||""):document.createElement(tag)}if(options){nTalk.each(options,function(name,value){try{switch(name){case"css":case"style":elem.style.cssText=value;break;case"innerHTML":case"html":elem.innerHTML=value;break;case"className":case"class":elem.className=value;break;case"text":elem.textContent=value;break;default:elem.setAttribute(name,value);break}}catch(e){}})}return elem},insert:function(rootElement,html,where){var range,frag;rootElement=rootElement||document.body;where=where?where.toLowerCase():"afterbegin";if(rootElement.insertAdjacentHTML){switch(where.toLowerCase()){case"beforebegin":rootElement.insertAdjacentHTML("BeforeBegin",html);return rootElement.previousSibling;case"afterbegin":rootElement.insertAdjacentHTML("AfterBegin",html);return rootElement.firstChild;case"afterend":rootElement.insertAdjacentHTML("AfterEnd",html);return rootElement.nextSibling;default:rootElement.insertAdjacentHTML("BeforeEnd",html);return rootElement.lastChild}}range=rootElement.ownerDocument.createRange();switch(where){case"beforebegin":range.setStartBefore(rootElement);frag=range.createContextualFragment(html);rootElement.parentNode.insertBefore(frag,rootElement);return rootElement.previousSibling;case"afterbegin":if(rootElement.firstChild){range.setStartBefore(rootElement.firstChild);frag=range.createContextualFragment(html);rootElement.insertBefore(frag,rootElement.firstChild)}else{rootElement.innerHTML=html}return rootElement.firstChild;case"beforeend":if(rootElement.lastChild){range.setStartAfter(rootElement.lastChild);frag=range.createContextualFragment(html);rootElement.appendChild(frag)}else{rootElement.innerHTML=html}return rootElement.lastChild;case"afterend":range.setStartAfter(rootElement);frag=range.createContextualFragment(html);rootElement.parentNode.insertBefore(frag,rootElement.nextSibling);return rootElement.nextSibling}throw'Illegal insertion point -> "'+where+'"'},flashHtml:function(movieName,src,data,attr){attr=nTalk.extend({width:1,height:1,style:"",wmode:"opaque"},attr);if(nTalk.browser.oldmsie){var ljf=src.indexOf("?")>-1?"&":"?";src+=ljf+"rnd="+Math.floor(Math.random()*1e3)}return nTalk.browser.msie&&nTalk.browser.ieversion<11?['<object id="',movieName,'" name="',movieName,'" width="',attr.width,'" height="',attr.height,'" style="',attr.style,'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="https://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,28">','<param name="wmode" value="',attr.wmode,'" />','<param name="movie" value="',src,'" />','<param name="allowscriptaccess" value="always" />','<param name="flashvars" value="',nTalk.toURI(data,true),'" />',"</object>"].join(""):nTalk.browser.msie&&nTalk.browser.ieversion>=11?['<object id="',movieName,'"  name="',movieName,'" data="',src,'" width="',attr.width,'" height="',attr.height,'" style="',attr.style,'" type="application/x-shockwave-flash">','<param name="wmode" value="',attr.wmode,'"/>','<param name="movie" value="',src,'"/>','<param name="quality" value="high"/>','<param name="allowscriptaccess" value="always"/>','<param name="flashvars" value="',nTalk.toURI(data,true),'"/>',"</object>"].join(""):['<embed id="',movieName,'" name="',movieName,'" src="'+src+'" width="',attr.width,'" height="',attr.height,'" style="',attr.style,'" flashvars="',nTalk.toURI(data,true),'" wmode="',attr.wmode,'" allowscriptaccess="always" pluginspage="https://www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash" >',"</embed>"].join("")},_vendorPropName:function(style,name){if(name in style){return name}var cssPrefixes=["Webkit","O","Moz","ms"],capName=name.charAt(0).toUpperCase()+name.slice(1),origName=name,i=cssPrefixes.length;while(i--){name=cssPrefixes[i]+capName;if(name in style){return name}}return origName},css:function(elem,name,value){var opacity,origName,opacityExp=/\s*alpha\(opacity=([^)]*)\)\s*/gi;if(!elem){return false}if(value===undefined){origName=nTalk.camelize(name);if(document.defaultView&&document.defaultView.getComputedStyle){value=document.defaultView.getComputedStyle(elem,null).getPropertyValue(name);return value==="auto"||value===""?0:value}else{name=nTalk.cssProps[origName]||nTalk._vendorPropName(elem.style,origName);value=name==="opacity"?/opacity=([^)]*)/.test(elem.currentStyle.filter)?.01*parseFloat(RegExp.$1)+"":1:elem.style[name]||(elem.currentStyle?elem.currentStyle[name]:null);if(name==="backgroundPosition"&&nTalk.browser.msie&&nTalk.browser.ieversion<=8){value=elem.style[name+"X"]||(elem.currentStyle?elem.currentStyle[name+"X"]:null);value=value+" "+elem.style[name+"Y"]||(elem.currentStyle?elem.currentStyle[name+"Y"]:null)}return value==="auto"?0:value}}else{if(document.documentElement.style.opacity!==undefined){try{elem.style[nTalk.camelize(name)]=value}catch(e0){return false}return true}else{if(!elem.currentStyle||!elem.currentStyle.hasLayout){elem.style.zoom=1}if(name==="opacity"){try{elem.style.filter=value==1?"none":(elem.currentStyle||elem.style).filter.replace(opacityExp,"")+" alpha(opacity="+value*100+")"}catch(e1){}elem.style.zoom=1}else try{elem.style[nTalk.camelize(name)]=value}catch(e0){return false}return true}}},attr:function(el,name,value){if(!el)return;if(typeof value!="undefined"){if(value==="")el.removeAttribute(name);else el.setAttribute(name,value);return value}else{return el.getAttribute?el.getAttribute(name):el[name]||""}},addClass:function(elem,classname){if(!elem)return false;if(this.indexOfClass(elem,classname)){return false}else{var srcClass=elem.className.split(/\s+/).join(" ");elem.className=(srcClass?srcClass+" ":"")+classname;return true}},removeClass:function(elem,classname){if(!elem||!elem.className){return false}else{elem.className=elem.className.replace(new RegExp("(^|\\s+)"+classname+"(\\s+|$)","i")," ");return true}},indexOfClass:function(elem,classname){if(!elem||!elem.className){return false}else{return new RegExp("(^|\\b)"+classname+"(\\s|$)","gi").test(elem.className)}},contains:function(parent,elem){if(elem){while(elem=elem.parentNode){if(elem===parent){return true}}}return false}});nTalk.position=nTalk.Class.create();nTalk.position.prototype={defaultOptions:{left:null,top:null,width:null,height:null,right:null,bottom:null,fixed:true,resize:false},timer:0,repwidth:"",repheight:"",inited:false,direction:"left",initialize:function(element,options){var offset;nTalk.extend(this,this.defaultOptions,options);this.element=element.talkVersion?element:nTalk(element);if(!this.width){this.width=this.element.width()}else if(this.width=="auto"){this.repwidth="auto";this.width=this.element.width()}if(!this.height){this.height=this.element.height()}else if(this.height=="auto"){this.repheight="auto";this.height=this.element.height()}this.offset=nTalk(window).offset();this.quirks=nTalk.browser.msie6||nTalk.browser.Quirks&&nTalk.browser.oldmsie;if(this.left===null){this.direction="right"}if(this.left===null&&this.right===null){offset=this.element.offset();this.left=offset.left;this.top=offset.top}this.right=this.right===null?nTalk(window).width()-this.left-this.width:this.right;this.bottom=this.bottom===null?nTalk(window).height()-this.top-this.height:this.bottom;this.left=this.left===null?nTalk(window).width()-this.right-this.width:this.left;this.top=this.top===null?nTalk(window).height()-this.bottom-this.height:this.top;if(this.fixed){this.fixedPosition({left:this.left,top:this.top,right:this.right,bottom:this.bottom})}else{this.animationPosition()}},fixedPosition:function(options){var self=this,offset,scrollTop;if(this.quirks){offset=nTalk(window).offset();scrollTop=nTalk(window).scrollTop();this.element.css({position:"absolute",width:this.repwidth?this.repwidth:this.width+"px",height:this.repheight?this.repheight:this.height+"px",left:options.left+offset.left+"px",top:options.top+offset.top+"px"});var leftExpression=["expression(eval(Math.max((document.documentElement.scrollLeft || document.body.scrollLeft), (document.documentElement.scrollLeft || document.body.scrollLeft) + "+options.left+")))","expression(eval(Math.max((document.documentElement.scrollLeft || document.body.scrollLeft), (document.documentElement.scrollLeft || document.body.scrollLeft) + (document.documentElement.clientWidth  || document.body.clientWidth ) - this.offsetWidth  - "+options.right+")))"];var topExpression=["expression(eval(Math.max((document.documentElement.scrollTop  || document.body.scrollTop ), (document.documentElement.scrollTop  || document.body.scrollTop ) + "+options.top+")))","expression(eval(Math.max((document.documentElement.scrollTop  || document.body.scrollTop ), (document.documentElement.scrollTop  || document.body.scrollTop ) + (document.documentElement.clientHeight || document.body.clientHeight) - this.offsetHeight - "+options.bottom+")))"];if(nTalk.isFunction(this.element.get(0).style.getExpression)){if(this.direction=="left"){this.element.Expression("left",leftExpression[0]);this.element.Expression("top",topExpression[0])}else{this.element.Expression("left",leftExpression[1]);this.element.Expression("top",topExpression[1])}}else{nTalk(window).scrollTop(scrollTop+1);if(this.direction=="left"){this.element.replaceIEcssText({left:leftExpression[0],top:topExpression[0]})}else{this.element.replaceIEcssText({left:leftExpression[1],top:topExpression[1]})}nTalk(window).scrollTop(scrollTop)}}else{offset={position:"fixed",width:this.repwidth?this.repwidth:this.width+"px",height:this.repheight?this.repheight:this.height+"px"};if(this.direction=="left"){offset.left=options.left+"px";offset.top=options.top+"px"}else{offset.right=options.right+"px";offset.bottom=options.bottom+"px"}this.element.css(offset)}if(this.resize&&!this.inited){nTalk.Event.addEvent(window,"resize",function(event){self.resizeFixed(event)})}this.inited=true},resizeFixed:function(){var style=[];if(this.direction=="left"){style.left=Math.max(0,Math.min(this.left,nTalk(window).width()-this.width));style.top=Math.max(0,Math.min(this.top,nTalk(window).height()-this.height));style.right=nTalk(window).width()-style.left-this.width;style.bottom=nTalk(window).height()-style.top-this.height}else{style.right=Math.min(this.right,nTalk(window).width()-this.width);style.bottom=Math.min(this.bottom,nTalk(window).height()-this.height);style.left=nTalk(window).width()-style.right-this.width;style.top=nTalk(window).height()-style.bottom-this.height;if(style.left<0||style.top<0){style.left=Math.max(0,style.left);style.top=Math.max(0,style.top);style.right=nTalk(window).width()-style.left-this.width;style.bottom=nTalk(window).height()-style.top-this.height}}this.fixedPosition(style)},clearExpression:function(){if(this.quirks){var offset=nTalk(window).offset();this.element.Expression("left","");this.element.Expression("top","");this.element.css({left:this.left+offset.left+"px",top:this.top+offset.top+"px"})}},animationPosition:function(){}};nTalk.extend({myString:function(text){str=new String(text||"");str.trim=function(){return this.replace(/(^\s*)|(\s*$)/g,"")};str.linkFilter=function(style){return this.toString().replace(/((\w+):\/\/)?([\w-]+\.)?([\w-]+\.)?([\w-]+\.)([a-zA-Z\-_\.]+)([^$\s,\"\u4E00-\u9FA5]*)?/gi,function(a,b,c,d,e,f,g,h){var blankURL=(b||"http://")+(d||"")+(e||"")+(f||"")+(g||"")+(h||"");return'<a href="'+blankURL.replace(/(^\s+)|(\s+$)/gi,"")+'" target="_blank" style="'+(style||"")+'">'+(b||"")+(d||"")+e+f+g+(h||"")+"</a>"})};str.linkFilter1=function(cssText){var yuanshi=this.toString();if(yuanshi.indexOf("rightTag=true")>-1){return yuanshi}return this.toString().replace(/((\w+):\/\/)?([\w-]+\.)?([\w-]+\.)?([\w-]+\.)([a-zA-Z\-_\.]+)([^$\s,\uFF0C\u3002\"\u4E00-\u9FA5]*)?/gi,function(a,b,c,d,e,f,g,h){var blankURL=((b||"http://")+(d||"")+(e||"")+(f||"")+(g||"")+(h||"")).replace(/(^\s+)|(\s+$)/gi,"");var linkClass=""+nTalk.randomChar(16);return['<div style="',nTalk.STYLE_BODY,'"><a href="',blankURL,'" target="_blank" style="',cssText||"",'">',b||"",d||"",e,f,g,h||"",'</a></div><div class="ntalk-link-contains ',linkClass,'" data-source="',blankURL,'" style="',cssText,'"></div>'].join("")})};str.sprintf=function(){var len=arguments.length,r=this;if(len<1||!RegExp)return r.toString();for(var a=0;a<len;a++){r=r.replace(new RegExp("%"+(a+1),"g"),(arguments[a]+"").replace(/%\d/g,"").toString())}return r};return str},cssNumber:{columnCount:true,fillOpacity:true,fontWeight:true,lineHeight:true,opacity:true,zIndex:true,zoom:true},cssProps:{"float":"cssFloat"},unit:function(name,value){if(this.cssNumber[name]){return""}var unit=(value+"").replace(cssValueExp,"");return unit===""?"px":unit},valHooks:{option:{get:function(elem){return elem.value||elem.text}},select:{get:function(elem){var value,i,max,option,index=elem.selectedIndex,values=[],options=elem.options,one=elem.type==="select-one";if(index<0)return null;i=one?index:0;max=one?index+1:options.length;for(;i<max;i++){option=options[i];if(option.selected&&option.getAttribute("disabled")===null&&(!option.parentNode.disabled&&option.parentNode.tagName.toUpperCase()!=="OPTGROUP")){value=nTalk(option).val();if(one)return value;values.push(value)}}if(one&&!values.length&&options.length){return nTalk(options[index]).val()}return values},set:function(elem,value){var values=nTalk.isArray(value)?value:[value];nTalk(elem).find("option").each(function(){this.selected=nTalk.inArray(nTalk(this).val(),values)>=0});if(!values.length){elem.selectedIndex=-1}return values}}}});nTalk.each(["radio","checkbox"],function(i,key){nTalk.valHooks[key]={get:function(elem){return elem.getAttribute("value")===null?"on":elem.value}}});nTalk.each(["radio","checkbox"],function(i,key){nTalk.valHooks[key]=nTalk.extend(nTalk.valHooks[key],{set:function(elem,value){elem.checked=nTalk.inArray(nTalk(elem).val(),value)>=0;return elem.checked}})});nTalk.fn.extend({bind:function(event,fn){return nTalk.access(this,function(element,event,fn){nTalk.Event.addEvent(element,event,fn)},event,fn,1)},addEvent:function(event,fn){return this.bind(event,fn)},click:function(fn){return this.bind("click",fn)},hover:function(fnOver,fnOut){return nTalk.access(this,function(element,fnOver,fnOut){nTalk.Event.addEvent(element,"mouseover",fnOver);nTalk.Event.addEvent(element,"mouseout",fnOut);return nTalk(element)},fnOver,fnOut||emptyFunc)},removeEvent:function(event,fn){return nTalk.access(this,function(element,event,fn){if(fn===undefined)element.onclick=null;else nTalk.Event.removeEvent(element,event,fn)},event,fn,1)},fire:function(event){return nTalk.access(this,function(element,event,o){nTalk.Event.fireEvent(element,event)},event,"",1)},insert:function(html,where){return nTalk(nTalk.insert(this[0],html,where))},html:function(html,clearNull){if(html!==undefined)return nTalk.each(this,function(i,element){element.innerHTML=html});else{if(nTalk.isBoolean(clearNull)&&clearNull){return(this.length?this.get(0).innerHTML:"").replace(/(^\s+)|(\s+$)/gi,"")}else{return this.length?this.get(0).innerHTML:""}}},append:function(content){return nTalk.each(this,function(i,element){nTalk.insert(element,content,"beforeend")})},appendTo:function(selector,before){var parent,body=document.body||nTalk("body")[0]||document.documentElement;if(typeof selector=="boolean"){before=selector;selector=null}if(!selector||typeof selector=="string"){parent=nTalk(selector||body)[0]}else{if(selector.talkVersion){parent=selector.length?selector[0]:nTalk(body)[0]}else{parent=selector}}return nTalk.each(this,function(i,element){var tagName=parent.tagName.toLocaleUpperCase();if(before&&before.talkVersion&&before.length){return parent.insertBefore(element,before.get(0))}else if(before&&before.nodeType==1){return parent.insertBefore(element,before)}else if(before===true){return parent.insertBefore(element,parent.firstChild)}else if(readyComplete||tagName!="BODY"){try{return parent.appendChild(element)}catch(e){}}else{return nTalk.insert(parent,element.outerHTML,"beforeend")}})},replace:function(node){nTalk.each(this,function(i,element){if(element.replaceNode){element.replaceNode(node)}else{try{element.parentNode.appendChild(node);element.parentNode.removeChild(element)}catch(e){}}});return nTalk(node)},find:function(selector){var child=this.constructor.selector.query(selector,this);return this.pushStack(child)},parent:function(level){var parent=this.get(0);level=level||1;if(!parent||!parent.parentNode||!this.length){return null}while(level>0&&parent.parentNode&&parent.parentNode.nodeType!==11){parent=parent.parentNode;level--}return parent?nTalk(parent):null},child:function(){return this.find("*")},remove:function(){return nTalk.each(this,function(i,element){var removeComplete=false;for(var methodName in element){if(element.tagName.toUpperCase()=="IFRAME")continue;try{if(typeof element[methodName]==="function"){element[methodName]=null}}catch(e){nTalk.Log("remove("+element.tagName+"):"+e.message,3)}}if(element.parentNode){try{element.parentNode.removeChild(element);removeComplete=true}catch(e){}}if(!removeComplete){var tElement=document.createElement("DIV");try{tElement.appendChild(element);tElement.innerHTML="";if(tElement.parentNode)tElement.parentNode.removeChild(tElement)}catch(e1){}}})},css:function(name,value){return nTalk.access(this,function(elem,name,value){return value!==undefined?nTalk.css(elem,name,value):nTalk.css(elem,name)},name,value,arguments.length>1)},cssText:function(value){return nTalk.access(this,function(elem,name,value){return value!==undefined?elem.style.cssText=value:elem.style.cssText},"",value,arguments.length>1)},attr:function(name,value){return nTalk.access(this,function(elem,name,value){return value!==undefined?nTalk.attr(elem,name,value):nTalk.attr(elem,name)},name,value,arguments.length>1)},display:function(block){return nTalk.each(this,function(i,element){nTalk.css(element,"display",block?"block":"none")})},replaceIEcssText:function(name,value){return nTalk.access(this,function(elem,name,value){value=value||"";var cssText=";"+elem.style.cssText,pattern=new RegExp(";\\s*"+name+":\\s*(.*?);","ig"),content=";"+name+":"+value+";",exisit=pattern.test(cssText);if(exisit){elem.style.cssText=cssText.replace(pattern,content)}else{elem.style.cssText=cssText+content}},name,value,arguments.length>1)},Expression:function(name,value){return nTalk.access(this,function(elem,name,value){if(!("getExpression"in elem.style)){return}if(value===undefined)return elem.style.getExpression(name);else if(value==="")return elem.style.removeExpression(name);else return elem.style.setExpression(name,value)},name,value,arguments.length>1)},curClass:function(){return this.length?this.get(0).className:""},addClass:function(value){
return nTalk.each(this,function(i,element){nTalk.addClass(element,value)})},removeClass:function(value){return nTalk.each(this,function(i,element){nTalk.removeClass(element,value)})},indexOfClass:function(class1){return nTalk.indexOfClass(this[0],class1)},replaceClass:function(class1,class2){return nTalk.each(this,function(i,element){nTalk.addClass(element,class1);nTalk.removeClass(element,class2)})},val:function(value){if(!this.length)return"";var hooks,ret,radio,elem=this[0];if(!arguments.length){hooks=nTalk.valHooks[elem.nodeName.toLowerCase()];if(hooks&&"get"in hooks&&(ret=hooks.get(elem,"value"))!==undefined){return ret}hooks=nTalk.valHooks[elem.type];if(hooks&&"get"in hooks){radio=this[0].type=="radio";for(var values=[],i=0;i<this.length;i++){if((ret=hooks.get(this[i],"value"))!==undefined&&this[i].checked){if(radio)return ret;else values.push(ret)}}return radio?"":values}ret=this[0].value;return typeof ret==="string"?ret:ret===null?"":ret}else{return nTalk.each(this,function(i,elem){if(value===null){value=""}hooks=nTalk.valHooks[elem.type]||nTalk.valHooks[elem.nodeName.toLowerCase()];if(!hooks||!("set"in hooks)||hooks.set(this,value,"value")===undefined){elem.value=value}})}},width:function(value){var curElem;if(this.length>0){curElem=this[0]}else{return 0}if(nTalk.isWindow(curElem)){return nTalk.browser.Quirks&&!nTalk.browser.msie?document.documentElement.clientWidth:document.documentElement.clientWidth||document.body.clientWidth||window.innerWidth}else{return value===undefined?curElem.offsetWidth:curElem.offsetWidth=value}},height:function(value){var curElem;if(this.length){curElem=this[0]}else{return 0}if(nTalk.isWindow(curElem)){return nTalk.browser.Quirks&&!nTalk.browser.msie?window.innerHeight:document.documentElement.clientHeight||document.body.clientHeight||window.innerHeight}else{return value===undefined?curElem.offsetHeight:curElem.offsetHeight=value}},scrollHeight:function(value){var curElem;if(this.length){curElem=this[0]}else{return 0}if(nTalk.isWindow(curElem)){return window.innerHeight||document.documentElement.scrollHeight||document.body.scrollHeight}else{try{return value===undefined?curElem.scrollHeight:curElem.scrollHeight=value}catch(e){return 0}}},scrollLeft:function(value){var curElem;if(this.length){curElem=this[0]}else{return 0}if(nTalk.isWindow(curElem)){if(value===undefined){try{var sLeft=document.documentElement.scrollLeft||window.pageXOffset;return Math.max(sLeft,document.body?document.body.scrollLeft:0)||0}catch(e){return 0}}else{document.documentElement.scrollLeft=value;document.body.scrollLeft=value}}else{return value===undefined?curElem.scrollLeft:curElem.scrollLeft=value}},scrollTop:function(value){var curElem;if(this.length){curElem=this[0]}else{return 0}if(nTalk.isWindow(curElem)){if(value===undefined){return document.documentElement.scrollTop||window.pageYOffset||document.body.scrollTop}else{document.documentElement.scrollTop=value;if(document.documentElement.scrollTop!=value){document.body.scrollTop=value}}}else{return value===undefined?curElem.scrollTop:curElem.scrollTop=value}},offset:function(options){if(arguments.length){return options===undefined?this:this.each(function(i,elem){nTalk.offset.setOffset(elem,options,i)})}var docElem,elem=this[0],box={top:0,left:0},doc=elem&&elem.ownerDocument;if(nTalk.isWindow(elem)){return{top:nTalk(elem).scrollTop(),left:nTalk(elem).scrollLeft()}}if(!doc){return box}docElem=doc.documentElement;if(!nTalk.contains(docElem,elem)){return box}if(typeof elem.getBoundingClientRect!==core_strUndefined){box=elem.getBoundingClientRect()}return{top:box.top+nTalk(window).scrollTop()-docElem.clientTop,left:box.left+nTalk(window).scrollLeft()-docElem.clientLeft}},fixed:function(options){return nTalk.each(this,function(i,elem){new nTalk.position(elem,options)})}});nTalk.offset={setOffset:function(elem,options){var curCSSTop,curOffset,curCSSLeft,position=nTalk.css(elem,"position"),curElem=nTalk(elem),props={};if(position==="static"){elem.style.position="relative"}curOffset=curElem.offset();curCSSTop=nTalk.css(elem,"top");curCSSLeft=nTalk.css(elem,"left");if(options.top!==null){props.top=options.top-curOffset.top+(curCSSTop||0)}if(options.left!==null){props.left=options.left-curOffset.left+(curCSSLeft||0)}curElem.css(props)}};nTalk.cache={data:null,init:function(){nTalk.cache.data=nTalk.extend({},nTalk.cache.deserialize(nTalk.cookie.get(nTalk.CON_CACHE_COOKIE)))},get:function(key,Immediate){if(Immediate===true){nTalk.cache.data=nTalk.merge(nTalk.cache.data,nTalk.cache.deserialize(nTalk.cookie.get(nTalk.CON_CACHE_COOKIE)))}return this.formatData(key)},set:function(key,value){this.formatData(key,value);return nTalk.cookie.set(nTalk.CON_CACHE_COOKIE,nTalk.cache.serialize(nTalk.cache.data),0)},serialize:function(data){var self=this,result=[];if(nTalk.isArray(data)){for(var i=0;i<data.length;i++){result.push(this.serialize(data[i]))}return"["+result.join("|")+"]"}else if(nTalk.isObject(data)){nTalk.each(data,function(k,value){result.push(k+":"+self.serialize(value))});return result.length?"{"+result.join(",")+"}":"{}"}else{return data}},deserialize:function(data){if(!data)return{};var json,strJson=/"/.test(data)?data:data.replace(/(\{|\[)/g,'$1"').replace(/(}|])/g,'"$1').replace(/(:|,)/g,'"$1"');try{json=nTalk.JSON.parseJSON(strJson)}catch(e){return null}for(var k in json){if(!json.hasOwnProperty(k))continue;json[k]=nTalk.isNumeric(json[k])?+json[k]:json[k]}return json},formatData:function(key,value){var strDate=key.split("."),copy=nTalk.cache.data,g;while(g=strDate.shift()){if(strDate.length>0){if(!copy[g]){copy[g]={}}copy=copy[g]}else{if(value===undefined)return copy[g]||null;else if(nTalk.isArray(value)){var arrTo=[];if(copy[g])arrTo=arrTo.concat(copy[g]);copy[g]=arrTo.concat(value)}else{copy[g]=value;return nTalk.cache.data}}}}};nTalk.promptwindow=function(){var isFocus=false,isPrompting=false,cacheTime=nTalk.getTime(),timerID=null,promptMsg=null,promptMsg2=null,originTitle=document.title,counter=0,autoStop=true,promptTitle="%1%2 - %3";if(window.addEvent){nTalk(document).bind("focusin",handleFocus);nTalk(document).bind("focusout",handleBlur)}nTalk(window).bind("focus",handleFocus);nTalk(window).bind("blur",handleBlur);function handleFocus(){isFocus=true;var curTime=nTalk.getTime();if(curTime-cacheTime<100){return}cacheTime=nTalk.getTime();if(autoStop){stopPrompt()}if(nTalk.isFunction(nTalk.promptwindow.callbackFocus)){nTalk.promptwindow.callbackFocus()}}function handleBlur(){isFocus=false;if(nTalk.isFunction(nTalk.promptwindow.callbackBlur)){nTalk.promptwindow.callbackBlur()}}function startPrompt(destnick,flashNews,aStop){if(isPrompting||isFocus)return;if(flashNews&&flashNews.length>0){promptMsg=nTalk.myString(promptTitle).sprintf(flashNews,"",originTitle);promptMsg2="";for(var i=0,l=Math.ceil(nTalk.enLength(flashNews)/2);i<l;i++){promptMsg2+=""}promptMsg2=nTalk.myString(promptTitle).sprintf(promptMsg2,destnick,originTitle)}autoStop=aStop||autoStop;timerID=setInterval(changeWindowTitle,800);isPrompting=true;return isPrompting}function changeWindowTitle(){counter++;document.title=counter%2===0?promptMsg2:promptMsg;try{if(top!=self){top.document.title=counter%2===0?promptMsg2:promptMsg}}catch(e){}}function stopPrompt(){if(!isPrompting)return;clearInterval(timerID);timerID=null;counter=0;setTimeout(function(){document.title=originTitle},500);isPrompting=false;if(window.top!=window.self){try{window.top.document.title=originTitle}catch(e){}}}return{callbackFocus:emptyFunc,callbackBlur:emptyFunc,originTitle:originTitle,startPrompt:startPrompt,stopPrompt:stopPrompt}}();var createXHR=function(){try{return new window.XMLHttpRequest}catch(e){try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(e1){return false}}};var xmlrequest=function(){var xhr=createXHR();if(!xhr){return xhr}if("withCredentials"in xhr){return xhr}if(window.XDomainRequest===undefined){return xhr}xhr=new XDomainRequest;xhr.readyState=0;xhr.status=100;xhr.onreadystatechange=emptyFunc;xhr.onload=function(){xhr.readyState=4;xhr.status=200;var xmlDoc=new ActiveXObject("Microsoft.XMLDOM");xmlDoc.async="false";xmlDoc.loadXML(xhr.responseText);xhr.responseXML=xmlDoc;xhr.response=xhr.responseText;xhr.onreadystatechange()};xhr.ontimeout=xhr.oerror=function(){xhr.readyState=4;xhr.status=500;xhr.onreadystatechange()};return xhr};var tepmxhr,hasSetRequestHeader,hasOverrideMimeType;try{tepmxhr=xmlrequest();hasSetRequestHeader=tepmxhr.setRequestHeader||false;hasOverrideMimeType=tepmxhr.overrideMimeType||false;tepmxhr=null}catch(e){}nTalk.doAjaxRequest=function(options){var dataType=options.dataType||"text";var success=options.success||emptyFunc;var error=options.error||emptyFunc;var xhr=xmlrequest();if(!xhr){error("no xhr");return null}var callback=function(){var json;if(xhr.readyState===4){var status=xhr.status||0;if(status===200){if(dataType==="json"){try{json=nTalk.JSON.parse(xhr.responseText);success(json,xhr)}catch(e){error(xhr.responseText,xhr,"response to json exception")}return}else{success(xhr.responseText,xhr);return}}else{if(dataType==="json"){try{json=nTalk.JSON.parse(xhr.responseText);error(json,xhr)}catch(e){error(xhr.responseText,xhr,"response to json exception")}return}else{success(xhr.responseText,xhr,"Server exception")}}}if(xhr.readyState===0){success(xhr.responseText,xhr,"Server exception")}};xhr.onreadystatechange=callback;if(options.responseType){if(typeof xhr.responseType!=="undefined"){xhr.responseType=options.responseType}else{error("",xhr,"Browser does not support setting response type");return null}}if(options.mimeType){if(hasOverrideMimeType){xhr.overrideMimeType(options.mimeType)}else{error("",xhr,"Browser does not support setting mimeType");return null}}var headers=options.headers||{};if(!options.crossDomain&&!headers["X-Requested-With"]){headers["X-Requested-With"]="XMLHttpRequest"}for(var key in headers){if(hasSetRequestHeader){xhr.setRequestHeader(key,headers[key])}else{error("",xhr,"Browser does not support setting header");return null}}var type=options.type||"GET";xhr.open(type,options.url);var data=options.data||null;xhr.send(data);return xhr};if(window.nTalk)return;window.nTalk=window.NTKF=nTalk;nTalk.initializeCore();(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){var FilterCSS=require("cssfilter").FilterCSS;var getDefaultCSSWhiteList=require("cssfilter").getDefaultWhiteList;var _=require("./util");function getDefaultWhiteList(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","loop","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],sup:[],strong:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","loop","preload","src","height","width"]}}var defaultCSSFilter=new FilterCSS;function onTag(tag,html,options){}function onIgnoreTag(tag,html,options){}function onTagAttr(tag,name,value){}function onIgnoreTagAttr(tag,name,value){}function escapeHtml(html){return html.replace(REGEXP_LT,"&lt;").replace(REGEXP_GT,"&gt;")}function safeAttrValue(tag,name,value,cssFilter){value=friendlyAttrValue(value);if(name==="href"||name==="src"){value=_.trim(value);if(value==="#")return"#";if(!(value.substr(0,7)==="http://"||value.substr(0,8)==="https://"||value.substr(0,7)==="mailto:"||value[0]==="#"||value[0]==="/")){return""}}else if(name==="background"){REGEXP_DEFAULT_ON_TAG_ATTR_4.lastIndex=0;if(REGEXP_DEFAULT_ON_TAG_ATTR_4.test(value)){return""}}else if(name==="style"){REGEXP_DEFAULT_ON_TAG_ATTR_7.lastIndex=0;if(REGEXP_DEFAULT_ON_TAG_ATTR_7.test(value)){return""}REGEXP_DEFAULT_ON_TAG_ATTR_8.lastIndex=0;if(REGEXP_DEFAULT_ON_TAG_ATTR_8.test(value)){REGEXP_DEFAULT_ON_TAG_ATTR_4.lastIndex=0;if(REGEXP_DEFAULT_ON_TAG_ATTR_4.test(value)){return""}}if(cssFilter!==false){cssFilter=cssFilter||defaultCSSFilter;value=cssFilter.process(value)}}value=escapeAttrValue(value);return value}var REGEXP_LT=/</g;var REGEXP_GT=/>/g;var REGEXP_QUOTE=/"/g;var REGEXP_QUOTE_2=/&quot;/g;var REGEXP_ATTR_VALUE_1=/&#([a-zA-Z0-9]*);?/gim;var REGEXP_ATTR_VALUE_COLON=/&colon;?/gim;var REGEXP_ATTR_VALUE_NEWLINE=/&newline;?/gim;var REGEXP_DEFAULT_ON_TAG_ATTR_3=/\/\*|\*\//gm;var REGEXP_DEFAULT_ON_TAG_ATTR_4=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a)\:/gi;var REGEXP_DEFAULT_ON_TAG_ATTR_5=/^[\s"'`]*(d\s*a\s*t\s*a\s*)\:/gi;var REGEXP_DEFAULT_ON_TAG_ATTR_6=/^[\s"'`]*(d\s*a\s*t\s*a\s*)\:\s*image\//gi;var REGEXP_DEFAULT_ON_TAG_ATTR_7=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi;var REGEXP_DEFAULT_ON_TAG_ATTR_8=/u\s*r\s*l\s*\(.*/gi;function escapeQuote(str){return str.replace(REGEXP_QUOTE,"&quot;")}function unescapeQuote(str){return str.replace(REGEXP_QUOTE_2,'"')}function escapeHtmlEntities(str){return str.replace(REGEXP_ATTR_VALUE_1,function replaceUnicode(str,code){return code[0]==="x"||code[0]==="X"?String.fromCharCode(parseInt(code.substr(1),16)):String.fromCharCode(parseInt(code,10))})}function escapeDangerHtml5Entities(str){return str.replace(REGEXP_ATTR_VALUE_COLON,":").replace(REGEXP_ATTR_VALUE_NEWLINE," ")}function clearNonPrintableCharacter(str){var str2="";for(var i=0,len=str.length;i<len;i++){str2+=str.charCodeAt(i)<32?" ":str.charAt(i)}return _.trim(str2)}function friendlyAttrValue(str){str=unescapeQuote(str);str=escapeHtmlEntities(str);str=escapeDangerHtml5Entities(str);str=clearNonPrintableCharacter(str);return str}function escapeAttrValue(str){str=escapeQuote(str);str=escapeHtml(str);return str}function onIgnoreTagStripAll(){return""}function StripTagBody(tags,next){if(typeof next!=="function"){next=function(){}}var isRemoveAllTag=!Array.isArray(tags);function isRemoveTag(tag){if(isRemoveAllTag)return true;return _.indexOf(tags,tag)!==-1}var removeList=[];var posStart=false;return{onIgnoreTag:function(tag,html,options){if(isRemoveTag(tag)){if(options.isClosing){var ret="[/removed]";var end=options.position+ret.length;removeList.push([posStart!==false?posStart:options.position,end]);posStart=false;return ret}else{if(!posStart){posStart=options.position}return"[removed]"}}else{return next(tag,html,options)}},remove:function(html){var rethtml="";var lastPos=0;_.forEach(removeList,function(pos){rethtml+=html.slice(lastPos,pos[0]);lastPos=pos[1]});rethtml+=html.slice(lastPos);return rethtml}}}function stripCommentTag(html){return html.replace(STRIP_COMMENT_TAG_REGEXP,"")}var STRIP_COMMENT_TAG_REGEXP=/<!--[\s\S]*?-->/g;function stripBlankChar(html){var chars=html.split("");chars=chars.filter(function(char){var c=char.charCodeAt(0);if(c===127)return false;if(c<=31){if(c===10||c===13)return true;return false}return true});return chars.join("")}exports.whiteList=getDefaultWhiteList();exports.getDefaultWhiteList=getDefaultWhiteList;exports.onTag=onTag;exports.onIgnoreTag=onIgnoreTag;exports.onTagAttr=onTagAttr;exports.onIgnoreTagAttr=onIgnoreTagAttr;exports.safeAttrValue=safeAttrValue;exports.escapeHtml=escapeHtml;exports.escapeQuote=escapeQuote;exports.unescapeQuote=unescapeQuote;exports.escapeHtmlEntities=escapeHtmlEntities;exports.escapeDangerHtml5Entities=escapeDangerHtml5Entities;exports.clearNonPrintableCharacter=clearNonPrintableCharacter;exports.friendlyAttrValue=friendlyAttrValue;exports.escapeAttrValue=escapeAttrValue;exports.onIgnoreTagStripAll=onIgnoreTagStripAll;exports.StripTagBody=StripTagBody;exports.stripCommentTag=stripCommentTag;exports.stripBlankChar=stripBlankChar;exports.cssFilter=defaultCSSFilter;exports.getDefaultCSSWhiteList=getDefaultCSSWhiteList},{"./util":4,cssfilter:8}],2:[function(require,module,exports){var DEFAULT=require("./default");var parser=require("./parser");var FilterXSS=require("./xss");function filterXSS(html,options){var xss=new FilterXSS(options);return xss.process(html)}exports=module.exports=filterXSS;exports.FilterXSS=FilterXSS;for(var i in DEFAULT)exports[i]=DEFAULT[i];for(var i in parser)exports[i]=parser[i];if(typeof nTalk!=="undefined"){nTalk.extend({filterXSS:module.exports})}},{"./default":1,"./parser":3,"./xss":5}],3:[function(require,module,exports){var _=require("./util");function getTagName(html){var i=html.indexOf(" ");if(i===-1){var tagName=html.slice(1,-1)}else{var tagName=html.slice(1,i+1)}tagName=_.trim(tagName).toLowerCase();if(tagName.slice(0,1)==="/")tagName=tagName.slice(1);if(tagName.slice(-1)==="/")tagName=tagName.slice(0,-1);return tagName}function isClosing(html){return html.slice(0,2)==="</"}function parseTag(html,onTag,escapeHtml){"user strict";var rethtml="";var lastPos=0;var tagStart=false;var quoteStart=false;var currentPos=0;var len=html.length;var currentHtml="";var currentTagName="";for(currentPos=0;currentPos<len;currentPos++){var c=html.charAt(currentPos);if(tagStart===false){if(c==="<"){tagStart=currentPos;continue}}else{if(quoteStart===false){if(c==="<"){rethtml+=escapeHtml(html.slice(lastPos,currentPos));tagStart=currentPos;lastPos=currentPos;continue}if(c===">"){rethtml+=escapeHtml(html.slice(lastPos,tagStart));currentHtml=html.slice(tagStart,currentPos+1);currentTagName=getTagName(currentHtml);rethtml+=onTag(tagStart,rethtml.length,currentTagName,currentHtml,isClosing(currentHtml));lastPos=currentPos+1;tagStart=false;continue}if((c==='"'||c==="'")&&html.charAt(currentPos-1)==="="){quoteStart=c;continue}}else{if(c===quoteStart){quoteStart=false;continue}}}}if(lastPos<html.length){rethtml+=escapeHtml(html.substr(lastPos))}return rethtml}var REGEXP_ATTR_NAME=/[^a-zA-Z0-9_:\.\-]/gim;function parseAttr(html,onAttr){"user strict";var lastPos=0;var retAttrs=[];var tmpName=false;var len=html.length;function addAttr(name,value){name=_.trim(name);name=name.replace(REGEXP_ATTR_NAME,"").toLowerCase();if(name.length<1)return;var ret=onAttr(name,value||"");if(ret)retAttrs.push(ret)}for(var i=0;i<len;i++){var c=html.charAt(i);var v,j;if(tmpName===false&&c==="="){tmpName=html.slice(lastPos,i);lastPos=i+1;continue}if(tmpName!==false){if(i===lastPos&&(c==='"'||c==="'")&&html.charAt(i-1)==="="){j=html.indexOf(c,i+1);if(j===-1){break}else{v=_.trim(html.slice(lastPos+1,j));addAttr(tmpName,v);tmpName=false;i=j;lastPos=i+1;continue}}}if(c===" "){if(tmpName===false){j=findNextEqual(html,i);if(j===-1){v=_.trim(html.slice(lastPos,i));addAttr(v);tmpName=false;lastPos=i+1;continue}else{i=j-1;continue}}else{j=findBeforeEqual(html,i-1);if(j===-1){v=_.trim(html.slice(lastPos,i));v=stripQuoteWrap(v);addAttr(tmpName,v);tmpName=false;lastPos=i+1;continue}else{continue}}}}if(lastPos<html.length){if(tmpName===false){addAttr(html.slice(lastPos))}else{addAttr(tmpName,stripQuoteWrap(_.trim(html.slice(lastPos))))}}return _.trim(retAttrs.join(" "))}function findNextEqual(str,i){for(;i<str.length;i++){var c=str[i];if(c===" ")continue;if(c==="=")return i;return-1}}function findBeforeEqual(str,i){for(;i>0;i--){var c=str[i];if(c===" ")continue;if(c==="=")return i;return-1}}function isQuoteWrapString(text){if(text[0]==='"'&&text[text.length-1]==='"'||text[0]==="'"&&text[text.length-1]==="'"){return true}else{return false}}function stripQuoteWrap(text){if(isQuoteWrapString(text)){return text.substr(1,text.length-2)}else{return text}}exports.parseTag=parseTag;exports.parseAttr=parseAttr},{"./util":4}],4:[function(require,module,exports){module.exports={indexOf:function(arr,item){var i,j;if(Array.prototype.indexOf){return arr.indexOf(item)}for(i=0,j=arr.length;i<j;i++){if(arr[i]===item){return i}}return-1},forEach:function(arr,fn,scope){var i,j;if(Array.prototype.forEach){return arr.forEach(fn,scope)}for(i=0,j=arr.length;i<j;i++){fn.call(scope,arr[i],i,arr)}},trim:function(str){if(String.prototype.trim){return str.trim()}return str.replace(/(^\s*)|(\s*$)/g,"")}}},{}],5:[function(require,module,exports){var FilterCSS=require("cssfilter").FilterCSS;var DEFAULT=require("./default");var parser=require("./parser");var parseTag=parser.parseTag;var parseAttr=parser.parseAttr;var _=require("./util");function isNull(obj){return obj===undefined||obj===null}function getAttrs(html){var i=html.indexOf(" ");if(i===-1){return{html:"",closing:html[html.length-2]==="/"}}html=_.trim(html.slice(i+1,-1));var isClosing=html[html.length-1]==="/";if(isClosing)html=_.trim(html.slice(0,-1));return{html:html,closing:isClosing}}function shallowCopyObject(obj){var ret={};for(var i in obj){ret[i]=obj[i]}return ret}function FilterXSS(options){options=shallowCopyObject(options||{});if(options.stripIgnoreTag){if(options.onIgnoreTag){console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time')}options.onIgnoreTag=DEFAULT.onIgnoreTagStripAll}options.whiteList=options.whiteList||DEFAULT.whiteList;options.onTag=options.onTag||DEFAULT.onTag;options.onTagAttr=options.onTagAttr||DEFAULT.onTagAttr;options.onIgnoreTag=options.onIgnoreTag||DEFAULT.onIgnoreTag;options.onIgnoreTagAttr=options.onIgnoreTagAttr||DEFAULT.onIgnoreTagAttr;options.safeAttrValue=options.safeAttrValue||DEFAULT.safeAttrValue;options.escapeHtml=options.escapeHtml||DEFAULT.escapeHtml;this.options=options;if(options.css===false){this.cssFilter=false}else{options.css=options.css||{};this.cssFilter=new FilterCSS(options.css)}}FilterXSS.prototype.process=function(html){html=html||"";html=html.toString();if(!html)return"";var me=this;var options=me.options;var whiteList=options.whiteList;var onTag=options.onTag;var onIgnoreTag=options.onIgnoreTag;var onTagAttr=options.onTagAttr;var onIgnoreTagAttr=options.onIgnoreTagAttr;var safeAttrValue=options.safeAttrValue;var escapeHtml=options.escapeHtml;var cssFilter=me.cssFilter;if(options.stripBlankChar){html=DEFAULT.stripBlankChar(html)}if(!options.allowCommentTag){html=DEFAULT.stripCommentTag(html)}var stripIgnoreTagBody=false;if(options.stripIgnoreTagBody){var stripIgnoreTagBody=DEFAULT.StripTagBody(options.stripIgnoreTagBody,onIgnoreTag);onIgnoreTag=stripIgnoreTagBody.onIgnoreTag}var retHtml=parseTag(html,function(sourcePosition,position,tag,html,isClosing){var info={sourcePosition:sourcePosition,position:position,isClosing:isClosing,isWhite:tag in whiteList};var ret=onTag(tag,html,info);if(!isNull(ret))return ret;if(info.isWhite){if(info.isClosing){return"</"+tag+">"}var attrs=getAttrs(html);var whiteAttrList=whiteList[tag];var attrsHtml=parseAttr(attrs.html,function(name,value){var isWhiteAttr=_.indexOf(whiteAttrList,name)!==-1;var ret=onTagAttr(tag,name,value,isWhiteAttr);if(!isNull(ret))return ret;if(isWhiteAttr){value=safeAttrValue(tag,name,value,cssFilter);if(value){return name+'="'+value+'"'}else{return name}}else{var ret=onIgnoreTagAttr(tag,name,value,isWhiteAttr);if(!isNull(ret))return ret;return}});var html="<"+tag;if(attrsHtml)html+=" "+attrsHtml;if(attrs.closing)html+=" /";html+=">";return html}else{var ret=onIgnoreTag(tag,html,info);if(!isNull(ret))return ret;return escapeHtml(html)}},escapeHtml);if(stripIgnoreTagBody){retHtml=stripIgnoreTagBody.remove(retHtml)}return retHtml};module.exports=FilterXSS},{"./default":1,"./parser":3,"./util":4,cssfilter:8}],6:[function(require,module,exports){var DEFAULT=require("./default");var parseStyle=require("./parser");var _=require("./util");function isNull(obj){return obj===undefined||obj===null}function shallowCopyObject(obj){var ret={};for(var i in obj){ret[i]=obj[i]}return ret}function FilterCSS(options){options=shallowCopyObject(options||{});options.whiteList=options.whiteList||DEFAULT.whiteList;options.onAttr=options.onAttr||DEFAULT.onAttr;options.onIgnoreAttr=options.onIgnoreAttr||DEFAULT.onIgnoreAttr;this.options=options}FilterCSS.prototype.process=function(css){css=css||"";css=css.toString();if(!css)return"";var me=this;var options=me.options;var whiteList=options.whiteList;var onAttr=options.onAttr;var onIgnoreAttr=options.onIgnoreAttr;var retCSS=parseStyle(css,function(sourcePosition,position,name,value,source){var check=whiteList[name];var isWhite=false;if(check===true)isWhite=check;else if(typeof check==="function")isWhite=check(value);else if(check instanceof RegExp)isWhite=check.test(value);if(isWhite!==true)isWhite=false;var opts={position:position,sourcePosition:sourcePosition,source:source,isWhite:isWhite};if(isWhite){var ret=onAttr(name,value,opts);if(isNull(ret)){return name+":"+value}else{return ret}}else{var ret=onIgnoreAttr(name,value,opts);if(!isNull(ret)){return ret}}});return retCSS};module.exports=FilterCSS},{"./default":7,"./parser":9,"./util":10}],7:[function(require,module,exports){function getDefaultWhiteList(){var whiteList={};whiteList["align-content"]=false;whiteList["align-items"]=false;whiteList["align-self"]=false;whiteList["alignment-adjust"]=false;whiteList["alignment-baseline"]=false;whiteList["all"]=false;whiteList["anchor-point"]=false;whiteList["animation"]=false;whiteList["animation-delay"]=false;whiteList["animation-direction"]=false;whiteList["animation-duration"]=false;whiteList["animation-fill-mode"]=false;whiteList["animation-iteration-count"]=false;whiteList["animation-name"]=false;whiteList["animation-play-state"]=false;whiteList["animation-timing-function"]=false;whiteList["azimuth"]=false;whiteList["backface-visibility"]=false;whiteList["background"]=true;whiteList["background-attachment"]=true;whiteList["background-clip"]=true;whiteList["background-color"]=true;whiteList["background-image"]=true;whiteList["background-origin"]=true;whiteList["background-position"]=true;whiteList["background-repeat"]=true;whiteList["background-size"]=true;whiteList["baseline-shift"]=false;whiteList["binding"]=false;whiteList["bleed"]=false;whiteList["bookmark-label"]=false;whiteList["bookmark-level"]=false;whiteList["bookmark-state"]=false;whiteList["border"]=true;whiteList["border-bottom"]=true;whiteList["border-bottom-color"]=true;whiteList["border-bottom-left-radius"]=true;whiteList["border-bottom-right-radius"]=true;whiteList["border-bottom-style"]=true;whiteList["border-bottom-width"]=true;whiteList["border-collapse"]=true;whiteList["border-color"]=true;whiteList["border-image"]=true;whiteList["border-image-outset"]=true;whiteList["border-image-repeat"]=true;whiteList["border-image-slice"]=true;whiteList["border-image-source"]=true;whiteList["border-image-width"]=true;whiteList["border-left"]=true;whiteList["border-left-color"]=true;whiteList["border-left-style"]=true;whiteList["border-left-width"]=true;whiteList["border-radius"]=true;whiteList["border-right"]=true;whiteList["border-right-color"]=true;whiteList["border-right-style"]=true;whiteList["border-right-width"]=true;whiteList["border-spacing"]=true;whiteList["border-style"]=true;whiteList["border-top"]=true;whiteList["border-top-color"]=true;whiteList["border-top-left-radius"]=true;whiteList["border-top-right-radius"]=true;whiteList["border-top-style"]=true;whiteList["border-top-width"]=true;whiteList["border-width"]=true;whiteList["bottom"]=false;whiteList["box-decoration-break"]=true;whiteList["box-shadow"]=true;whiteList["box-sizing"]=true;whiteList["box-snap"]=true;whiteList["box-suppress"]=true;whiteList["break-after"]=true;whiteList["break-before"]=true;whiteList["break-inside"]=true;whiteList["caption-side"]=false;whiteList["chains"]=false;whiteList["clear"]=true;whiteList["clip"]=false;whiteList["clip-path"]=false;whiteList["clip-rule"]=false;whiteList["color"]=true;whiteList["color-interpolation-filters"]=true;whiteList["column-count"]=false;whiteList["column-fill"]=false;whiteList["column-gap"]=false;whiteList["column-rule"]=false;whiteList["column-rule-color"]=false;whiteList["column-rule-style"]=false;whiteList["column-rule-width"]=false;whiteList["column-span"]=false;whiteList["column-width"]=false;whiteList["columns"]=false;whiteList["contain"]=false;whiteList["content"]=false;whiteList["counter-increment"]=false;whiteList["counter-reset"]=false;whiteList["counter-set"]=false;whiteList["crop"]=false;whiteList["cue"]=false;whiteList["cue-after"]=false;whiteList["cue-before"]=false;whiteList["cursor"]=false;whiteList["direction"]=false;whiteList["display"]=true;whiteList["display-inside"]=true;whiteList["display-list"]=true;whiteList["display-outside"]=true;whiteList["dominant-baseline"]=false;whiteList["elevation"]=false;whiteList["empty-cells"]=false;whiteList["filter"]=false;whiteList["flex"]=false;whiteList["flex-basis"]=false;whiteList["flex-direction"]=false;whiteList["flex-flow"]=false;whiteList["flex-grow"]=false;whiteList["flex-shrink"]=false;whiteList["flex-wrap"]=false;whiteList["float"]=false;whiteList["float-offset"]=false;whiteList["flood-color"]=false;whiteList["flood-opacity"]=false;whiteList["flow-from"]=false;whiteList["flow-into"]=false;whiteList["font"]=true;whiteList["font-family"]=true;whiteList["font-feature-settings"]=true;whiteList["font-kerning"]=true;whiteList["font-language-override"]=true;whiteList["font-size"]=true;whiteList["font-size-adjust"]=true;whiteList["font-stretch"]=true;whiteList["font-style"]=true;whiteList["font-synthesis"]=true;whiteList["font-variant"]=true;whiteList["font-variant-alternates"]=true;whiteList["font-variant-caps"]=true;whiteList["font-variant-east-asian"]=true;whiteList["font-variant-ligatures"]=true;whiteList["font-variant-numeric"]=true;whiteList["font-variant-position"]=true;whiteList["font-weight"]=true;whiteList["grid"]=false;whiteList["grid-area"]=false;whiteList["grid-auto-columns"]=false;whiteList["grid-auto-flow"]=false;whiteList["grid-auto-rows"]=false;whiteList["grid-column"]=false;whiteList["grid-column-end"]=false;whiteList["grid-column-start"]=false;whiteList["grid-row"]=false;whiteList["grid-row-end"]=false;whiteList["grid-row-start"]=false;whiteList["grid-template"]=false;whiteList["grid-template-areas"]=false;whiteList["grid-template-columns"]=false;whiteList["grid-template-rows"]=false;whiteList["hanging-punctuation"]=false;whiteList["height"]=true;whiteList["hyphens"]=false;whiteList["icon"]=false;whiteList["image-orientation"]=false;whiteList["image-resolution"]=false;whiteList["ime-mode"]=false;whiteList["initial-letters"]=false;whiteList["inline-box-align"]=false;whiteList["justify-content"]=false;whiteList["justify-items"]=false;whiteList["justify-self"]=false;whiteList["left"]=false;whiteList["letter-spacing"]=true;whiteList["lighting-color"]=true;whiteList["line-box-contain"]=false;whiteList["line-break"]=false;whiteList["line-grid"]=false;whiteList["line-height"]=false;whiteList["line-snap"]=false;whiteList["line-stacking"]=false;whiteList["line-stacking-ruby"]=false;whiteList["line-stacking-shift"]=false;whiteList["line-stacking-strategy"]=false;whiteList["list-style"]=true;whiteList["list-style-image"]=true;whiteList["list-style-position"]=true;whiteList["list-style-type"]=true;whiteList["margin"]=true;whiteList["margin-bottom"]=true;whiteList["margin-left"]=true;whiteList["margin-right"]=true;whiteList["margin-top"]=true;whiteList["marker-offset"]=false;whiteList["marker-side"]=false;whiteList["marks"]=false;whiteList["mask"]=false;whiteList["mask-box"]=false;whiteList["mask-box-outset"]=false;whiteList["mask-box-repeat"]=false;whiteList["mask-box-slice"]=false;whiteList["mask-box-source"]=false;whiteList["mask-box-width"]=false;whiteList["mask-clip"]=false;
whiteList["mask-image"]=false;whiteList["mask-origin"]=false;whiteList["mask-position"]=false;whiteList["mask-repeat"]=false;whiteList["mask-size"]=false;whiteList["mask-source-type"]=false;whiteList["mask-type"]=false;whiteList["max-height"]=true;whiteList["max-lines"]=false;whiteList["max-width"]=true;whiteList["min-height"]=true;whiteList["min-width"]=true;whiteList["move-to"]=false;whiteList["nav-down"]=false;whiteList["nav-index"]=false;whiteList["nav-left"]=false;whiteList["nav-right"]=false;whiteList["nav-up"]=false;whiteList["object-fit"]=false;whiteList["object-position"]=false;whiteList["opacity"]=false;whiteList["order"]=false;whiteList["orphans"]=false;whiteList["outline"]=false;whiteList["outline-color"]=false;whiteList["outline-offset"]=false;whiteList["outline-style"]=false;whiteList["outline-width"]=false;whiteList["overflow"]=false;whiteList["overflow-wrap"]=false;whiteList["overflow-x"]=false;whiteList["overflow-y"]=false;whiteList["padding"]=true;whiteList["padding-bottom"]=true;whiteList["padding-left"]=true;whiteList["padding-right"]=true;whiteList["padding-top"]=true;whiteList["page"]=false;whiteList["page-break-after"]=false;whiteList["page-break-before"]=false;whiteList["page-break-inside"]=false;whiteList["page-policy"]=false;whiteList["pause"]=false;whiteList["pause-after"]=false;whiteList["pause-before"]=false;whiteList["perspective"]=false;whiteList["perspective-origin"]=false;whiteList["pitch"]=false;whiteList["pitch-range"]=false;whiteList["play-during"]=false;whiteList["position"]=false;whiteList["presentation-level"]=false;whiteList["quotes"]=false;whiteList["region-fragment"]=false;whiteList["resize"]=false;whiteList["rest"]=false;whiteList["rest-after"]=false;whiteList["rest-before"]=false;whiteList["richness"]=false;whiteList["right"]=false;whiteList["rotation"]=false;whiteList["rotation-point"]=false;whiteList["ruby-align"]=false;whiteList["ruby-merge"]=false;whiteList["ruby-position"]=false;whiteList["shape-image-threshold"]=false;whiteList["shape-outside"]=false;whiteList["shape-margin"]=false;whiteList["size"]=false;whiteList["speak"]=false;whiteList["speak-as"]=false;whiteList["speak-header"]=false;whiteList["speak-numeral"]=false;whiteList["speak-punctuation"]=false;whiteList["speech-rate"]=false;whiteList["stress"]=false;whiteList["string-set"]=false;whiteList["tab-size"]=false;whiteList["table-layout"]=false;whiteList["text-align"]=true;whiteList["text-align-last"]=true;whiteList["text-combine-upright"]=true;whiteList["text-decoration"]=true;whiteList["text-decoration-color"]=true;whiteList["text-decoration-line"]=true;whiteList["text-decoration-skip"]=true;whiteList["text-decoration-style"]=true;whiteList["text-emphasis"]=true;whiteList["text-emphasis-color"]=true;whiteList["text-emphasis-position"]=true;whiteList["text-emphasis-style"]=true;whiteList["text-height"]=true;whiteList["text-indent"]=true;whiteList["text-justify"]=true;whiteList["text-orientation"]=true;whiteList["text-overflow"]=true;whiteList["text-shadow"]=true;whiteList["text-space-collapse"]=true;whiteList["text-transform"]=true;whiteList["text-underline-position"]=true;whiteList["text-wrap"]=true;whiteList["top"]=false;whiteList["transform"]=false;whiteList["transform-origin"]=false;whiteList["transform-style"]=false;whiteList["transition"]=false;whiteList["transition-delay"]=false;whiteList["transition-duration"]=false;whiteList["transition-property"]=false;whiteList["transition-timing-function"]=false;whiteList["unicode-bidi"]=false;whiteList["vertical-align"]=false;whiteList["visibility"]=false;whiteList["voice-balance"]=false;whiteList["voice-duration"]=false;whiteList["voice-family"]=false;whiteList["voice-pitch"]=false;whiteList["voice-range"]=false;whiteList["voice-rate"]=false;whiteList["voice-stress"]=false;whiteList["voice-volume"]=false;whiteList["volume"]=false;whiteList["white-space"]=false;whiteList["widows"]=false;whiteList["width"]=true;whiteList["will-change"]=false;whiteList["word-break"]=true;whiteList["word-spacing"]=true;whiteList["word-wrap"]=true;whiteList["wrap-flow"]=false;whiteList["wrap-through"]=false;whiteList["writing-mode"]=false;whiteList["z-index"]=false;return whiteList}function onAttr(name,value,options){}function onIgnoreAttr(name,value,options){}exports.whiteList=getDefaultWhiteList();exports.getDefaultWhiteList=getDefaultWhiteList;exports.onAttr=onAttr;exports.onIgnoreAttr=onIgnoreAttr},{}],8:[function(require,module,exports){var DEFAULT=require("./default");var FilterCSS=require("./css");function filterCSS(html,options){var xss=new FilterCSS(options);return xss.process(html)}exports=module.exports=filterCSS;exports.FilterCSS=FilterCSS;for(var i in DEFAULT)exports[i]=DEFAULT[i];if(typeof nTalk!=="undefined"){nTalk.extend({FilterCSS:module.exports})}},{"./css":6,"./default":7}],9:[function(require,module,exports){var _=require("./util");function parseStyle(css,onAttr){css=_.trimRight(css);if(css[css.length-1]!==";")css+=";";var cssLength=css.length;var isParenthesisOpen=false;var lastPos=0;var i=0;var retCSS="";function addNewAttr(){if(!isParenthesisOpen){var source=_.trim(css.slice(lastPos,i));var j=source.indexOf(":");if(j!==-1){var name=_.trim(source.slice(0,j));var value=_.trim(source.slice(j+1));if(name){var ret=onAttr(lastPos,retCSS.length,name,value,source);if(ret)retCSS+=ret+"; "}}}lastPos=i+1}for(;i<cssLength;i++){var c=css[i];if(c==="/"&&css[i+1]==="*"){var j=css.indexOf("*/",i+2);if(j===-1)break;i=j+1;lastPos=i+1;isParenthesisOpen=false}else if(c==="("){isParenthesisOpen=true}else if(c===")"){isParenthesisOpen=false}else if(c===";"){if(isParenthesisOpen){}else{addNewAttr()}}else if(c==="\n"){addNewAttr()}}return _.trim(retCSS)}module.exports=parseStyle},{"./util":10}],10:[function(require,module,exports){module.exports={indexOf:function(arr,item){var i,j;if(Array.prototype.indexOf){return arr.indexOf(item)}for(i=0,j=arr.length;i<j;i++){if(arr[i]===item){return i}}return-1},forEach:function(arr,fn,scope){var i,j;if(Array.prototype.forEach){return arr.forEach(fn,scope)}for(i=0,j=arr.length;i<j;i++){fn.call(scope,arr[i],i,arr)}},trim:function(str){if(String.prototype.trim){return str.trim()}return str.replace(/(^\s*)|(\s*$)/g,"")},trimRight:function(str){if(String.prototype.trimRight){return str.trimRight()}return str.replace(/(\s*$)/g,"")}}},{}]},{},[2])})(window);
/* @file flashserver
 * @date 2017.10.19 15:59:24
 */
(function($){
	$.flashserver = {
		'trailserver':'http://trailjx.jxwmanage.com/trail/trail',
		'presenceserver':'rtmp://im.in.xnt.com:8080/flashIM;rtmps://im.in.xnt.com:443/flashIM',
		'presencegoserver':'http://imjx.jxwmanage.com/flashIM/wdkstatus',
		'crmcenter':'http://recordjx.jxwmanage.com/mcenters/',
		'mcenter':'http://recordjx.jxwmanage.com/mcenters/',
		'coopserver':'',
		'roboturl':'',
		't2dstatus':'http://t2djx.jxwmanage.com/t2d/t2dstatus',
		'chatview_in':'',
		'chatview_out':'',
		'chatview_wap':'',
		'queryurl':'http://bspider.ntalker.com/spider/',
		'tchatmqttserver':'tcp://mqttjx.jxwmanage.com:8088/tchat1;ws://tchatjx.jxwmanage.com:80/tchat1;wss://tchatjx.jxwmanage.com:443/tchat1',
		'eduimmqttserver':'',
		'robotserver':'',
		'kpiserver':'http://kpijx.jxwmanage.com/',
		'isnoim':2,
		'notrail':0,
		'preload':2000,
		'sessioncarry':'1',
		'enable_entrance':'0',
		'enable_invite':'1',
		'close_tchat_flash':'1',
		'close_im_flash':'0',
		'robot':'0',
		'connect_type':'comet',
		'history_version':'1',
		'entranceConfig':{
		},
		'tchatConnectType':'1',
		'layout':'0',
		'reversechat':'0',
		'usehttps':'0',
		'settingserver':'http://settingjx.jxwmanage.com',
		'apiserver':'http://apijx.jxwmanage.com/',
		'siteid':'jx_1000'
	};
	$.sourceURI = $.baseURI + "siteid/respack_nt6.91/";
})(nTalk);

/* @file trail.js
 * @date 2017.10.17 18:52:26 
 */
!function(e,t){e.trail||(e.trail={_trailServer:{kf_9988:"http://trailsvc.ntalker.com/trailsvc/count/trail.php?"},islogin:!1,called:!1,etype:"pv",edata:"",useSdkData:!1,getRegionTimer:null,start:function(t,l,i,r){var a,o,n=this,s=e.referrer&&e.referrer.indexOf(e.domain)>-1;this.called&&!l||(e.Log("nTalk.trail.start()",1),this.etype=l?"update":this.etype,this.useSdkData=i,t||""===e.global.trailid||!s?this.islogin=1:this.islogin=0,a=this.formartData(),!e.isEmptyObject(e.global.ntalkerparam)&&e.global.ntalkerparam&&(o=e.extend({},{ntalkerparam:e.global.ntalkerparam})),o=e.extend(o,{ref:document.referrer}),e.each(a,function(t,l){n.request(n.formatURI()+e.toURI(l),o,function(t){e.Log(t,1),null!=this.getRegionTimer&&r&&"function"==typeof r&&r()},t)}),this.getRegionTimer=setTimeout(function(){r&&"function"==typeof r&&r(),clearTimeout(n.getRegionTimer),n.getRegionTimer=null},200),this.called=!0)},request:function(t,l,i,r){if(l){if(e.Log("nTalk.trail.request():etype:"+this.etype+";POST request URI:"+t),e.browser.android&&e.browser.uc&&(l.uc=1,window.XMLHttpRequest&&window.FormData)){var a=new FormData;for(var o in l)a.append(o,l[o]);var n=new XMLHttpRequest;return n.open("POST",t,!0),void n.send(a)}new e.POST(t,l,function(e,t){i.call(nTalk,"nTalk.trail: iframe["+t+"] post complete.",1)},"POST_IFRAME_"+r)}else e.Log("nTalk.trail.request():etype:"+this.etype+";POST request URI:"+t),e.require(t+"#rnd",function(){i.call(nTalk,"nTalk.trail: script get complete.",1)})},formatURI:function(){return this._trailServer[e.global.siteid]?e.protocolFilter(this._trailServer[e.global.siteid]):e.protocolFilter(e.server.trailserver+"/userinfo.php?")},formartData:function(){var t,l=[],i={action:"save",url:e.url,siteid:e.global.siteid,uid:e.user.id,uname:e.user.name,device:this.useSdkData?"App":e.browser.mobile?"WAP":"PC",isvip:e.global.isvip,userlevel:e.global.userlevel,cid:e.global.pcid,sid:e.global.trailid,log:this.islogin,pageid:e.base.pageid,etype:this.etype,edata:this.edata};return e.global.pagetype&&(e.url.indexOf("#")==-1?i.url+="#ntalker-pagetype="+e.global.pagetype:e.url.indexOf("?")==-1?i.url=e.enCut(e.url.replace(/#/i,"?ntalker-pagetype="+e.global.pagetype+"#"),255):i.url=e.enCut(e.url.replace(/#/i,"&ntalker-pagetype="+e.global.pagetype+"#"),255)),1==this.islogin&&(e.cache.set("tid",e.global.trailid),i=e.merge(i,{lan:e.language,scr:screen.width+"*"+screen.height,cookie:e.cookie.enable()?1:0,flash:e.flash.version})),e.Log("nTalk.trail: "+(this.islogin?"LOGIN":"LINK")+" trailid:"+e.global.trailid+", uid:"+e.user.id+", pcid:"+e.global.pcid,this.islogin?1:0),e.global.orderid.length?e.each(e.global.orderid,function(r,a){t=r>e.global.orderprice.length-1?"":e.global.orderprice[r],l.push(e.merge({},i,{orderid:a,orderprice:t,sellerid:e.global.sellerid[r]||"",ttl:e.global.title}))}):l.push(e.merge({},i,{sellerid:e.global.sellerid.length?e.global.sellerid[0]:"",ttl:e.global.title})),l}})}(nTalk);
/* @file nt2.js
 * @date 2017.10.17 18:52:26 
 */
!function(t,e){function i(){}return t.animate?void t.Log("nt2.js loaded"):(t.animate=function(){var t=document.documentElement.style;return t.webkitTransition!==e||t.MozTransition!==e||t.OTransition!==e||t.msTransition!==e||t.transition!==e}()?function(){var i=document.documentElement.style,n=i.webkitTransition!==e?"Webkit":i.MozTransition!==e?"Moz":i.OTransition!==e?"O":i.msTransition!==e?"ms":"",s=n+"Transition";return function(e,i,n,o){var a=[],r=[],h=[],l=[],c=e.style;return n=n||300,t.each(i,function(i,n){r[i]=t.camelize(i),t.isObject(n)?(n.to=n.to||0,a[i]=t.cssNumber[i]?n.to:parseInt(n.to,10),h[i]=t.unit(i,n.to),t.isDefined(n.from)&&t.css(e,r[i],parseInt(n.from,10)+h[i])):(a[i]=t.cssNumber[i]?parseInt(n,10):n,h[i]=t.unit(i,n),t.css(e,r[i],a[i])),l.push(i)}),setTimeout(function(){c[s]="all "+n+"ms",t.each(l,function(t,e){c[r[e]]=a[e]+h[e]})},15),setTimeout(function(){c[s]="",o&&o.call(e)},n),e}}():function(e,i,n,s){var o,a,r,h=0,l=0,c=0,d=30,u=[],p=[],m=[],g=[],f=[];for(n=n||300,t.each(i,function(i,n){m.push(t.camelize(i)),t.isObject(n)?(a=n.to,t.isDefined(n.from)?p.push(t.cssNumber[i]?n.from:parseInt(n.from,10)):p.push(t.cssNumber[i]?t(e).css(i):parseInt(t(e).css(i),10)),t.css(e,m[l],p[l]+t.unit(i,a))):(a=n,p.push(t(e).css(i))),u.push(t.cssNumber[i]?a:isNaN(parseInt(a,10))?"":parseInt(a,10)),g.push(t.unit(i,a)),l++,c++}),o=0;o<d;o++)for(f[o]=[],l=0;l<c;l++)f[o][m[l]]=t.cssNumber[m[l]]||t.isNumeric(parseInt(p[l]))?p[l]+(u[l]-p[l])/d*o+("opacity"===m[l]?"":g[l]):"";for(var v=function(){for(l=0;l<c;l++)t.css(e,m[l],f[h][m[l]]);h++};l<d;l++)r=setTimeout(v,n/d*l);return setTimeout(function(){for(l=0;l<c;l++)t.css(e,m[l],u[l]+g[l]);s&&s.call(e)},n),e},t.extend({listenerFunctions:[],listenerMessage:function(e){function i(e){t.each(t.listenerFunctions,function(i,n){n.apply(t,[e.data])})}t.listenerFunctions.push(e),window.addEventListener&&this.__listenerMessage!==!0&&(t.Event.addEvent(window,"message",i),t.removelistenerMessage=function(){t.Event.removeEvent(window,"message",i),t.listenerFunctions=[]},this.__listenerMessage=!0)},postMessage:function(t,e,i){if(t.postMessage){i=i||"*";try{t.postMessage(e,i)}catch(n){}}}}),t.Window=t.Class.create(),t.Window.prototype={defaultOptions:{dropHeight:30,width:520,height:410,left:100,top:100,minWidth:520,minHeight:410,resize:!1,drag:!1,fixed:!1,zIndex:1e6,rightNode:!0,onChanage:i,onClose:i,onMinimize:i,onMaximize:i,onMaxResize:i},_tmpMove:null,_tmpStop:null,containter:null,header:null,body:null,chatBody:null,rightElement:null,buttonResize:null,buttonClose:null,buttonMax:null,buttonMin:null,_x:0,_y:0,_isdrag:null,_Style:null,parent:null,initialize:function(e,i){t.extend(this,this.defaultOptions,e),this.parent=i||null,this.quirks=t.browser.msie6||t.browser.Quirks&&t.browser.oldmsie,this.right=t(window).width()-this.left-this.width,this.bottom=t(window).height()-this.top-this.height,t.Log("$.Window:: left:"+this.left+", top:"+this.top),this._create(),this._bind()},close:function(e){this.cancelBubble(e),this.onClose.toString().indexOf("anonymous")<=-1?this.onClose():this.containter.hide(function(){t(this).remove()})},change:function(t){t&&this.onChanage.call(this,{width:this.width,height:this.height}),this._isdrag||(this.chatBody.css({height:this.height-this.dropHeight+"px"}),this.rightNode&&this.rightElement.css("height",this.height-this.dropHeight+"px"))},maxresize:function(){this.onMaxResize()},minimize:function(t,e){e!==!0&&this.cancelBubble(t),this.containter.css({height:"0px",width:"0px"}),e!==!0&&this.onMinimize()},maximize:function(t,e){this.containter.css({height:this.height+"px",width:this.width+"px"}),e!==!0&&this.onMaximize()},cancelBubble:function(e){this.containter.css("z-index",this.zIndex),t.Event.fixEvent(e).stopPropagation()},changeAttr:function(e,i){this.quirks&&this.clearExpression(),t.extend(this,{width:e,height:i,left:Math.max(0,t(window).width()-this.right-e),top:Math.max(0,t(window).height()-this.bottom-i)}),this.containter.css({width:this.width+"px",height:this.height+"px",left:this.left+"px",top:this.top+"px"}),this.quirks&&this.fixedPosition(),this.change(!0)},start:function(e,i){i||this.cancelBubble(e),this._Style=i?{x:"left",y:"top"}:{x:"width",y:"height"},this.right=t(window).width()-this.left-this.width,this.bottom=t(window).height()-this.top-this.height,this.quirks&&!i&&this.clearExpression(),e=t.Event.fixEvent(e),this.containter.css(i?{"z-index":++this.zIndex}:{"z-index":++this.zIndex}),this._isdrag=i,this._x=i?e.clientX-this.containter.get(0).offsetLeft||0:this.containter.get(0).offsetLeft||0,this._y=i?e.clientY-this.containter.get(0).offsetTop||0:this.containter.get(0).offsetTop||0,t.browser.msie?this.containter.bind("losecapture",this._tmpStop).get(0).setCapture():(t.Event.fixEvent(e).preventDefault(),t(window).bind("blur",this._tmpStop)),t(document).bind("mousemove",this._tmpMove),t(document).bind("mouseup",this._tmpStop)},move:function(e){window.getSelection?window.getSelection().removeAllRanges():document.selection.empty(),e=t.Event.fixEvent(e);var i=e.clientX-this._x,n=e.clientY-this._y,s=t(window).offset();this._isdrag?(this.quirks?(this[this._Style.x]=Math.min(Math.max(i,s.left),s.left+t(window).width()-this.width)-s.left,this[this._Style.y]=Math.min(Math.max(n,s.top),s.top+t(window).height()-this.height)-s.top):(this[this._Style.x]=Math.min(Math.max(i,0),t(window).width()-this.width),this[this._Style.y]=Math.min(Math.max(n,0),t(window).height()-this.height)),this.containter.css(this._Style.x,(this.quirks?s.left:0)+Math.max(0,this[this._Style.x])+"px"),this.containter.css(this._Style.y,(this.quirks?s.top:0)+Math.max(0,this[this._Style.y])+"px")):(this.quirks?(this[this._Style.x]=Math.min(Math.max(i+(this.quirks?s.left:0),this.minWidth),t(window).width()-this.left),this[this._Style.y]=Math.min(Math.max(n+(this.quirks?s.top:0),this.minHeight),t(window).height()-this.top)):(this[this._Style.x]=Math.min(Math.max(i,this.minWidth),t(window).width()-this.left),this[this._Style.y]=Math.min(Math.max(n,this.minHeight),t(window).height()-this.top)),this.containter.css(this._Style.x,this[this._Style.x]+"px"),this.containter.css(this._Style.y,this[this._Style.y]+"px")),this.right=t(window).width()-this.left-this.width,this.bottom=t(window).height()-this.top-this.height,this.change(!0)},stop:function(){this.quirks&&this.fixedPosition(),this.containter.css({"z-index":--this.zIndex}),t(document).removeEvent("mousemove",this._tmpMove),t(document).removeEvent("mouseup",this._tmpStop),t.browser.msie?this.containter.removeEvent("losecapture",this._tmpStop).get(0).releaseCapture():t(window).removeEvent("blur",this._tmpStop)},fixedPosition:function(){if(this.quirks){var e=t(window).scrollTop();t(window).scrollTop(e+1),this.containter.replaceIEcssText({left:"expression(eval(Math.max((document.documentElement.scrollLeft || document.body.scrollLeft), (document.documentElement.scrollLeft || document.body.scrollLeft) + (document.documentElement.clientWidth  || document.body.clientWidth ) - this.offsetWidth  - "+this.right+")))",top:"expression(eval(Math.max((document.documentElement.scrollTop  || document.body.scrollTop ), (document.documentElement.scrollTop  || document.body.scrollTop ) + (document.documentElement.clientHeight || document.body.clientHeight) - this.offsetHeight - "+this.bottom+")))"}),t(window).scrollTop(e),t(window).scrollLeft(1)}else this.containter.css({left:this.left+"px",top:this.top+"px"})},clearExpression:function(){var e=t(window).offset();this.containter.Expression("left",""),this.containter.Expression("top",""),this.containter.Expression("left",""),this.containter.replaceIEcssText({left:e.left+this.left+"px",top:e.top+this.top+"px"})},_for_resize:function(){this.left=Math.max(0,t(window).width()-this.right-this.width),this.top=Math.max(0,t(window).height()-this.bottom-this.height),this.quirks||this.containter.css({left:this.left+"px",top:this.top+"px"})},_create:function(){return this.containter=t({className:this.className||"ntalk-window-containter",style:t.STYLE_BODY+"box-sizing:content-box;overflow:hidden;"}).appendTo(this.parent,!0).css({position:this.fixed?this.quirks?"absolute":"fixed":"absolute",border:"none",width:this.width+"px",height:this.height+"px",zIndex:this.zIndex}),this.fixedPosition(),this.header=t({className:"ntalk-window-head",style:t.STYLE_BODY+"cursor:move;position:relative;left:0;top:0;"}).appendTo(this.containter).css({width:"100%",height:this.dropHeight+"px"}),this.buttonClose=t({className:"ntalk-button-close",style:t.STYLE_BODY+"width:20px;height:20px;cursor:pointer;position:static;float:right;position:relative;margin:2px 3px 0 0;line-height:20px;vertical-align:middle;background:none;"}).appendTo(this.header),this.buttonMax=t({className:"ntalk-button-maxresize",style:t.STYLE_BODY+"width:20px;height:20px;cursor:pointer;position:static;float:right;position:relative;margin:2px 3px 0 0;line-height:20px;vertical-align:middle;background:none;"}).appendTo(this.header),this.buttonMin=t({className:"ntalk-button-min",style:t.STYLE_BODY+"width:20px;height:20px;cursor:pointer;position:static;float:right;position:relative;margin:2px 3px 0 0;line-height:20px;vertical-align:middle;background:none;"}).appendTo(this.header),this.body=t({className:"ntalk-window-body",style:t.STYLE_BODY+"float:left;width:100%;"}).appendTo(this.containter),this.chatBody=t({className:"ntalk-chat-body",style:t.STYLE_BODY+"width:100%;position:relative;left:0;top:0;"}).appendTo(this.body),this.rightNode&&(this.rightElement=t({className:"ntalk-window-right",style:t.STYLE_BODY+"float:left;display:none;width:100%;"}).appendTo(this.containter)),this.resize&&(this.buttonResize=t({className:"window-resize",style:t.STYLE_BODY+"width:10px;height:10px;cursor:nw-resize;position:absolute;right:1px;bottom:1px;font-size:0;background:none;z-index:99;"}).appendTo(this.containter)),t({style:t.STYLE_BODY+"clear:both;"}).appendTo(this.containter),this.change(),this.containter},_bind:function(){var e=this;this.containter.bind("mousedown",function(t){e.drag&&e.start.call(e,t,!0)}),this.buttonClose.bind("mousedown",function(i){t.Event.fixEvent(i).stopPropagation(),e.close.call(e,i)}),this.buttonMax.bind("mousedown",function(i){t.Event.fixEvent(i).stopPropagation(),e.maxresize.call(e,i)}),this.buttonMin.bind("mousedown",function(i){t.Event.fixEvent(i).stopPropagation(),e.minimize.call(e,i)}),this.chatBody.bind("mousedown",function(t){e.cancelBubble.call(e,t)}),this.rightNode&&this.rightElement.bind("mousedown",function(t){e.cancelBubble.call(e,t)}),this.resize&&this.buttonResize.bind("mousedown",function(t){e.start.call(e,t,!1)}),this.fixed&&t(window).bind("resize",function(){e._for_resize()}),this._tmpStop=function(t){e.stop.call(e,t)},this._tmpMove=function(t){e.move.call(e,t)}}},t.Queue=t.Class.create(),t.Queue.prototype={list:null,length:0,initialize:function(){this.list=[],this.length=this.list.length},isEmpty:function(){return 0===this.list.length},enQueue:function(t){return this.list.push(t),this.length=this.list.length,this.list[this.length-1]},deQueue:function(){var t;return this.isEmpty()?null:(t=this.list.shift(),this.length=this.list.length,t)},queueFront:function(){return this.isEmpty()?null:this.list[0]}},t.pageManage=t.Class.create(),t.pageManage.prototype={identid:"",keyid:"",data:null,interID:null,options:null,debug:!1,inter:.8,count:0,chanageCall:!0,CON_MANAGE_PAGE_LIST:"IM_EXIST_PAGEARR",pageStore:null,initialize:function(e,n){var s,o,a=this,r=3;this.debug&&t.Log("pageManage.initialize():"),this.options=t.extend(this.options,{onChanage:i,onInterval:i,pageNum:3,timeout:2.5,inter:.8},e),this.keyid=t.CON_MANAGE_COOKIE+(n?"_"+n.toUpperCase():""),this.identid=this._2shortTime(0,8,13),t.browser.chrome&&(this.options.timeout=5),this.options.timeout*=10,this.options.inter*=1e3,this.inter=this.options.inter,this.pageStore=t.store;try{for(;r--&&(s=this.pageStore.get(this.CON_MANAGE_PAGE_LIST)||"",""===s););if(o=this._get().m,s=""===s||0===o.length?[]:s.split(","),s.length!=o.length&&s.length<=this.options.pageNum){s=[];for(var h=0;h<o.length;h++)for(var l in o[h])s.push(l)}s.push(this.identid),this.pageStore.set(this.CON_MANAGE_PAGE_LIST,s.join(","))}catch(c){}var d=t.getTime();this.interID=setInterval(function(){setTimeout(function(){now=t.getTime();var e=now-d;a._update(e),a.options.onInterval(a.options.timeout,a.data.m),d=t.getTime()},0)},this.options.inter),t.Event.addEvent(window,"unload",function(){a._remove(),setTimeout(function(){},500)})},getIsLastPage:function(){return this.data.m.length},_get:function(){var e=t.cookie.get(this.keyid)||"{}";return t.extend({m:[]},t.JSON.parseJSON(e))},_save:function(){var e=t.JSON.toJSONString(this.data);return t.cookie.set(this.keyid,e,0),e},_remove:function(){var t=this._getIndex();this.data.m.splice(t,1),this._save();var e=this.pageStore.get(this.CON_MANAGE_PAGE_LIST);if(e&&""!==e){for(var i=e.split(","),n=0;n<i.length;n++)if(i[n]==this.identid){i.splice(n,1);break}e=i.join(","),""!==e?this.pageStore.set(this.CON_MANAGE_PAGE_LIST,e):this.pageStore.whereClear(this.CON_MANAGE_PAGE_LIST)}},_update:function(e){this.data=this._get(),this._clear(e);var i="update",n=this._getIndex();if(this.data.t=t.formatDate(),!this.data.m[n]){if(!(this.data.m.length<this.options.pageNum))return;i="add",this.data.m[n]={}}this.data.m[n][this.identid]=this._2shortTime(),this._save(),this.debug&&t.Log(this.identid+",pageCount:"+this.data.m.length+","+i+" data:"+t.JSON.toJSONString(this.data.m)),"add"!=i&&this.chanageCall===!0||this.count==this.data.m.length||(this.options.onChanage.call(this,this.data.m.length,this.data.m),this.count=this.data.m.length),this.chanageCall=!1},_clear:function(t){var e=this._2shortTime();if(this.data.m.length)for(var i,n=0;n<this.data.m.length;n++)if(this.data.m[n])for(var s in this.data.m[n])if("function"!=typeof this.data.m[n][s]&&(i=e-this.data.m[n][s],Math.abs(i)>this.options.timeout+t/100)){this.data.m.splice(n,1),this.chanageCall=!0;var o=this.pageStore.get(this.CON_MANAGE_PAGE_LIST);if(!o||""===o)return;for(var a=o.split(","),r=0;r<a.length;r++)if(a[r]==s){a.splice(r,1);break}o=a.join(","),""!==o?this.pageStore.set(this.CON_MANAGE_PAGE_LIST,o):this.pageStore.whereClear(this.CON_MANAGE_PAGE_LIST)}},_getIndex:function(){if(!this.data||!this.data.m.length)return 0;for(var e=0;e<this.data.m.length;e++)if(this.data.m[e])for(var i in this.data.m[e])if(this.data.m[e]&&!t.isFunction(this.data.m[e][i])&&i===this.identid)return e;return e},_2shortTime:function(e,i,n){var s=(e?e:t.getTime()).toString();return i=i||5,n=n||11,s.substring(i,n)}},t.store=function(){var n,s="__cometd__",o={disabled:!1},a=function(){var e=null;try{e=window.localStorage}catch(i){return t.Log("localStorage:"+i.message,3),!1}if(e){var n="test";try{return null!==localStorage.getItem(n)&&localStorage.removeItem(n),localStorage.setItem(n,n),localStorage.getItem(n)==n&&(localStorage.removeItem(n),!0)}catch(i){return t.Log("The browser localStorage is unavailable. "+i.message,3),!1}}},r=t.browser.msie;if(o.toJSONString=function(e){return null===e?"":t.JSON.toJSONString(e)},o.parseJSON=function(i){if("object"==typeof i)return i||e;try{return t.JSON.parseJSON(i)}catch(n){return i||e}},a())n=window.localStorage,o.set=function(i,s){if(!s||s===e||null===s)return o.remove(i);try{"function"==typeof n.setItem?n.setItem(i,o.toJSONString(s)):n[i]=o.toJSONString(s)}catch(a){if("QUOTA_EXCEEDED_ERR"==a.name.toUpperCase()){o.remove(i);try{n.setItem(i,o.toJSONString(s))}catch(r){t.Log("store.set:"+r.message,3)}}}return s},o.get=function(t){return o.parseJSON(n.getItem(t))},o.remove=function(e){try{n.removeItem(e)}catch(i){t.Log("store.remove:"+i.message,3)}},o.clear=function(){try{n.clear()}catch(e){t.Log("store.clear:"+e.message,3)}},o.getAll=function(){for(var t={},e=0;e<n.length;++e){var i=n.key(e);t[i]=o.get(i)}return t};else if(r){var h,l,c=new RegExp("[!\"#$%&'()*+,/\\\\:;<=>?@[\\]^`{|}~]","g"),d=function(t){return function(){var e,i=Array.prototype.slice.call(arguments,0);i.unshift(n);try{h.appendChild(n)}catch(s){h.insertBefore(n,h.firstChild)}n.addBehavior&&n.addBehavior("#default#userData");for(var a=20;a>0;){a--;try{n.load("nTK-LS");break}catch(s){}}return e=t.apply(o,i),h.removeChild(n),e}},u=function(t){return t.replace(c,"___")};try{l=new ActiveXObject("htmlfile"),l.open(),l.write('<script type="text/javascript">document.w=window;</script><iframe src="/favicon.ico"></iframe>'),l.close(),h=l.w.frames[0].document,n=h.createElement("div")}catch(p){n=document.createElement("div"),h=document.body||document.getElementsByTagName("head")[0]||document.documentElement}o.set=d(function(t,i,n){if(i=u(i),!n||n===e||null===n)return o.remove(i);t.setAttribute(i,o.toJSONString(n));try{t.save("nTK-LS")}catch(s){}return n}),o.get=d(function(t,e){return e=u(e),o.parseJSON(t.getAttribute(e))}),o.remove=d(function(t,e){e=u(e),t.removeAttribute(e),t.save("nTK-LS")}),o.clear=d(function(t){var e;try{e=t.XMLDocument.documentElement.attributes}catch(i){return}t.load("nTK-LS");for(var n=0,s=e.length;n<s;n++){var o=e[n];t.removeAttribute(o.name)}t.save("nTK-LS")}),o.getAll=d(function(t){var e;try{e=t.XMLDocument.documentElement.attributes}catch(i){return}for(var n={},s=0,a=e.length;s<a;++s){var r=e[s],h=u(r.name);n[r.name]=o.parseJSON(t.getAttribute(h))}return n})}else o.set=function(){t.Log("The browser localStorage is unavailable.",3)},o.get=i,o.remove=i,o.clear=i,o.getAll=i;try{o.set(s,s),o.get(s)!=s&&(o.disabled=!0),o.remove(s)}catch(p){o.disabled=!0}return o.whereClear=function(e){var i=this,n=this.getAll();t.each(n,function(t){t.indexOf(e)>-1&&i.remove(t)})},o.enabled=!o.disabled,o}(),t.comet=t.Class.create(),t.comet.prototype={name:"public.comet",version:"2014.05.17",connType:"login",options:null,fix:"",id:"",count:0,sendIntervalID:null,_ipExpr:/^https?:\/\/\d+\.\d+\.\d+\.\d+(:\d+)?\/(.*?)$/gi,_cacheElement:{},_connectTimeID:{},defaultOption:{muDomain:1,timeout:20,onCallback:i,onComplete:i,onAbnormal:i,onTimeout:i},changePort:!1,initialize:function(e,i){var n=this;this.uri=e,this.fix=t.randomChar(),this.uri||t.Log("comet uri is null",3),this.callMethod=window,this.callbackName="callback_"+this.fix,this.callMethod[this.callbackName]=function(){n._connectCallback.call(n,n.id,arguments)},this.options=t.extend({},this.defaultOption,i),this.initConnectionPooling()},initMessageQueue:function(){this.messageQueue||(this.messageQueue=new t.Queue,this.messageQueue.addMessage=function(t){for(var e=0;e<this.length;e++)if(this.list[e].msgid==t.msgid&&this.list[e].index==t.index)return!1;return this.enQueue(t),!0},this.messageQueue.nextMessage=function(t,e){if(this.isEmpty())return null;if(!t)return this.queueFront();for(var i=0;i<this.length;i++)if(this.list[i].msgid==t&&this.list[i].body.sendpacket==e)return this.list[i+1]},this.messageQueue.removeMessage=function(t,e){for(var i,n=0;n<this.length;n++)this.list[n].msgid!=t||this.list[n].index!=e&&e!=-1||(i=n);this.list.splice(n,1),this.length=this.list.length})},initConnectionPooling:function(){if(!this.connectionPooling){this._ipExpr.test(this.uri)&&(this.options.muDomain=1),this.connectionPooling=new t.Queue,this.connectionPooling.get=function(){for(var t,e,i,n=0;n<this.list.length;n++)this.list[n].lock===!1&&(!e||e.rTimesample>this.list[n].rTimesample)&&(e=this.list[n]),(!i||this.list[n].sTimesample<i.sTimesample)&&(i=this.list[n]);return t=e||i,this.recover(t.uri,!0),t},this.connectionPooling.getConnect=function(){var t=this.get();return{uri:t.uri,url:t.uri+(/\?$/gi.test(t.uri)?"&":"?")}},this.connectionPooling.recover=function(e,i,n,s){for(var o=0;o<this.list.length;o++)if(this.list[o].uri==e)return this.list[o].lock=i,i?(this.list[o].sTimesample=n||t.getTime(),this.list[o].rTimesample=0):this.list[o].rTimesample=s||t.getTime(),!0;return!1};for(var e=0;e<=this.options.muDomain;e++){var i=!0,n=!1,s=80;this.uri.indexOf("https://")>-1&&(i=!1,s=443);var o=this.uri.replace(/(https?:)(\/)+/gi,"");o.indexOf(":")>-1&&o.indexOf(":")<o.indexOf("/")&&(n=!0,s=parseInt(o.substring(o.indexOf(":")+1,o.indexOf("/")))),1===e&&this.changePort&&(n?this.uri=(i?"http://":"https://")+o.replace(":"+s,":"+ ++s):this.uri=(i?"http://":"https://")+o.replace("/",":"+ ++s+"/")),this.connectionPooling.enQueue({uri:this.uri.toString(),lock:!1,sTimesample:0,rTimesample:0})}}},connect:function(e,i){var n,s,o=this.count++;this.connType="login",this.id=this.fix+"_"+o,e[i||"callbackname"]=this.callbackName,this.connectOptions=t.extend(e,{ts:t.getTime()}),n=this.connectionPooling.getConnect(),s=n.url+t.toURI(this.connectOptions),this._cacheElement[this.id]=this._createConnect(s,this.id,o,n)},kalive:function(e,i){var n,s,o=this.count++;this.connType="kalive",this.id=this.fix+"_"+o,e[i||"callbackname"]=this.callbackName,this.kaliveOptions=t.extend(this.kaliveOptions,e,{ts:t.getTime()}),n=this.connectionPooling.getConnect(),s=n.url+t.toURI(this.kaliveOptions),this._cacheElement[this.id]=this._createConnect(s,this.id,o,n)},disconnectServer:function(e,i){var n=this.connectionPooling.getConnect();return this.flashGoServer=n.url+t.toURI(i===!1?e:t.extend(e,{ts:t.getTime()})),this.flashGoServer},disconnect:function(){t.require(this.flashGoServer,function(e){t(e.error?e.target:e).remove()}),window[this.callbackName]=i},reconnect:function(){this.connect(this.connectOptions)},send:function(e,i){var n=this,s=this.connectionPooling.getConnect(),o=this.mdyServerAddr(s.url)+t.toURI(e);return t.require(o+"#rnd",function(e){n.connectionPooling.recover(s.uri,!1),i&&i.call(n,e.error),t(e.error?e.target:e).remove()}),!0},mdyServerAddr:function(t){return t.replace(/\/flashgo/i,"/httpgo")},post:function(e,i){var n=this,s=this.connectionPooling.getConnect();new t.POST(this.mdyServerAddr(s.url),e,function(){n.connectionPooling.recover(s.uri,!1),i&&i.call(n,!0)})},_createConnect:function(e,i,n,s){var o,a,r=this,h=document.head||nTalk("head")[0]||document.documentElement;return o=t({className:i,tag:"script",type:"text/javascript",async:"async",src:e,charset:"utf-8"}).appendTo(h),a=o.get(0).readyState?"onreadystatechange":"onload",o.get(0)[a]=o.get(0).onerror=function(e){var n=/^(loaded|complete|undefined)$/,a=o.get(0).readyState;e=t.Event.fixEvent(e),n.test(a)&&(r.connectionPooling.recover(s.uri,!1),"error"!==e.type?setTimeout(function(){r._connectComplete(e,i),o.remove()},t.browser.msie?800:50):(r._connectAbnormal(e,i),o.remove()))},this._connectTimeID[i]=setTimeout(function(){o.first().remove(),r._connectTimeout("timeout",i)},1e3*+this.options.timeout+1e4),o.get(0)},_connectCallback:function(e,i){i=Array.prototype.slice.call(i),t("."+e).remove(),this._cacheElement[e]?(this._stopCallComplete(e,"callback"),this.options.onCallback.apply(self,[!0,i])):this.options.onCallback.apply(self,[!1,i])},_connectComplete:function(t,e){var i=Array.prototype.slice.call(arguments);this._cacheElement[e]&&(this._stopCallComplete(e,"complete"),this.options.onComplete.apply(self,[this.connType].concat(i)))},_connectAbnormal:function(t,e){var i=Array.prototype.slice.call(arguments);this._cacheElement[e]&&(this._stopCallComplete(e,"abnormal"),this.options.onAbnormal.apply(self,[this.connType].concat(i)))},_connectTimeout:function(t,e){var i=Array.prototype.slice.call(arguments);this._cacheElement[e]&&(this._stopCallComplete(e,"timeout"),this.options.onTimeout.apply(self,[this.connType].concat(i)))},_stopCallComplete:function(e){var n=this._cacheElement[e];n?n.onload=n.onreadystatechange=n.onerror=i:t.Log("stop error id:"+e,3),delete this._cacheElement[e],clearTimeout(this._connectTimeID[e]),delete this._connectTimeID[e]},_createScriptPCID:function(e){return"guest"+[e?"TEMP"+t.randomChar(4):t.randomChar(8),t.randomChar(4),t.randomChar(4),t.randomChar(4),t.randomChar(12)].join("-")}},t.mqttws=t.Class.create(),t.mqttws.prototype={name:"public.mqttws",version:"2015.04.10",connect:null,subscriptions:[],messages:[],connected:!1,recCount:0,waitTime:500,_wsKeepaliveId:null,_options:{url:null,siteid:null,pcid:null,onCallback:null,loginMsg:null,timeout:3,keepAliveInterval:90},initialize:function(e){var i=this;this.options=t.extend({},i._options,e),this.options.pcid=(this.options.siteid+"_"+this.options.pcid.substring(5)).substring(0,23),t.require({mqtt:"mosquitto.js?siteid="+t.extParmas.siteid},function(e){i.connect=new t.Mosquitto,i.connect.onmessage=function(e,n,s,o){var a=t.JSON.parseJSON(n);i.options.onCallback.apply(this,[!0,[a.method].concat(a.params)])},i.connect.ondisconnect=function(t){null!==this._wsKeepaliveId&&(clearInterval(this._wsKeepaliveId),this._wsKeepaliveId=null)},i.connect.onconnect=function(t){0===t?(i.connect.subscribe("foo",0),i.connect.publish("foo",i.options.loginMsg,0,0)):i.reconnect()},i.connect.onreconnect=function(){i.reconnect()},i.connect.connect(i.options.url,i.options.keepAliveInterval,i.options.pcid)})},reconnect:function(){var t=this;++this.recCount<3?this._waitTime=500:this._waitTime=1e3*+"034567890".charAt(Math.ceil(5*Math.random())),setTimeout(function(){t.connect.connect(t.options.url,t.options.keepAliveInterval,t.options.pcid)},this._waitTime)},disconnect:function(){this.connect.closeFlag=!0,this.connect.disconnect()},kalive:function(t){var e=this;this._wsKeepaliveId||(this._wsKeepaliveId=setInterval(function(){e.connect.publish("foo",t,0,!1)},1e3*this.options.keepAliveInterval))}},t.extend({htmlToElement:function(e){var i,n;if(t.browser.msie)try{i=new ActiveXObject("MSXml.DOMDocument"),i.loadXML(e),n=i.childNodes}catch(s){i=document.createElement("DIV"),i.innerHTML=e,n=i.childNodes}else i=document.createElement("DIV"),i.innerHTML=e,n=i.childNodes;return n},elementToObject:function(e){var i,n,s={};if(n=t.isArray(e)||e.talkVersion?e[0]:e,s[n.tagName.toLowerCase()]=n.innerHTML||n.text,n.attributes)for(var o=0;o<n.attributes.length;o++)i=n.attributes[o].name,i&&(s[i]=n.attributes[o].value);else s.msg=n.textContent;return s},jsonToxml:function(e){var i,n=this,s="";return"object"!=typeof e?e:(t.each(e,function(o,a){if("string"==typeof a&&"text"==o)s=a;else if(t.isArray(e))s+=n.jsonToxml(a);else{if(s+="<"+o,"object"==typeof a.attributes){for(var r in a.attributes)a.attributes.hasOwnProperty(r)&&(s+=" "+r+'="'+a.attributes[r]+'"');delete a.attributes}i=n.jsonToxml(a),s+=a&&i?">"+i+"</"+o+">":"></"+o+">"}}),s)},utils:{options:{},handleLinks:function(e,i,n){this.options=t.extend({},this.options,i),e=e||"";var s;s=n?this.linkPatternsP4:this.linkPatterns;for(var o=0;o<s.length;o++)e=e.replace(s[o][0],s[o][1]);return e},linkPatternsP4:[[/\[link\s+images=[\'\"]+([^\[\]\'\"]+)[\'\"]+\s*[^\[\]]*\]([^\[\]]+)\[\/link\]/gi,'<img width="324" height="146"  onload="globalChatHandle.scrollHistoryToBottom()" src="$1">'],[/\[link\s+submit=[\'\"]+([^\[\]\'\"]+)[\'\"]+\s*[^\[\]]*\]([^\[\]]+)\[\/link\]/gi,'<a class="specil" onclick="NTKF.chatManage.get().send(this.nextSibling.innerHTML, null, this.innerHTML);return false;" href="#">$2</a><span style="display:none;">$1</span>'],[/\[link\s+submit=([^\s\[\]\'\"]+)\s*[^\[\]]*\]([^\[\]]+)\[\/link\]/gi,'<a class="specil" onclick="NTKF.chatManage.get().send(this.nextSibling.innerHTML, null, this.innerHTML);return false;" href="#">$2</a><span style="display:none;">$1</span>'],[/\[link\](.*?)\[\/link\]/gi,'<a class="specil" onclick="NTKF.chatManage.get().send(this.innerHTML);return false;" >$1</a>'],[/<a class="specil" id="submitLink".*?>.*?<\/a>/gi,function(t){return t.replace(/(http|ftp|https)/gi,"$1_")}],[/\[link\s+url=[\'\"]+([^\[\]\'\"]+)[\'\"]+\s*[^\[\]]*\]([^\[\]]+)\[\/link\]/gi,'<a href="$1" target="_blank">$2</a>'],[/\[link\s+url=[\'\"]+([^\[\]\'\"]+)[\'\"]+\s*[^\[\]]*\]([^\[\]]+)\[\/link\]/gi,'<a href="$1" target="_blank">$2</a>'],[/\[link\s+url=([^\s\[\]\'\"]+)\s*[^\[\]]*\]([^\[\]]+)\[\/link\]/gi,'<a href="$1" target="_blank">$2</a>'],[/\[link\s+p4=[\'\"]+([^\[\]\'\"]+)[\'\"]+\s+title=[\'\"]+([^\[\]\'\"]+)[\'\"]+\s*[^\[\]]*\]([^\[\]]+)\[\/link\]/gi,"<a href=\"#\" onclick=\"$client.Activity.openP4('$1','$2');return false;\" >$3</a>"],[/\[link\s+p4=([^\s\[\]\'\"]+)\s+title=([^\s\[\]\'\"]+)\s*[^\[\]]*\]([^\[\]]+)\[\/link\]/gi,"<a href=\"#\" onclick=\"$client.Activity.openP4('$1','$2');return false;\" >$3</a>"],[/\[link\s+p4=[\'\"]+([^\[\]\'\"]+)[\'\"]+\s*[^\[\]]*\]([^\[\]]+)\[\/link\]/gi,"<a href=\"#\" onclick=\"$client.Activity.openP4('$1','$2');return false;\" >$2</a>"],[/\[link\s+p4=([^\s\[\]\'\"]+)\s*[^\[\]]*\]([^\[\]]+)\[\/link\]/gi,"<a href=\"#\" onclick=\"$client.Activity.openP4('$1','$2');return false;\" >$2</a>"],[/(^|[^"'=])((http|https|ftp):\/\/([\w-]+\.)+[\w-]+([\w-.\/?=;!*%$]*)?([\w-&=;!*%$]*)?)/gi,'$1<a href="$2" target="_new">$2</a>'],[/(http|ftp|https)_/gi,"$1"]],linkPatterns:[[/\[link\s+reconnect=([^\s\[\]'"]+)\s*[^\[\]]*]([^\[\]]+)\[\/\s*link]/gi,'<a style="'+t.STYLE_BODY+'display:inline-block;color:#005ffb;text-decoration:none;" href="javascript:void(0);" onclick="nTalk.chatManage.get(\'$1\').reconnect(this);return false;" >$2</a>'],[/\[link\s+message=([^\s\[\]'"]+)\s*[^\[\]]\s*source=([^\s\[\]'"]+)\s*[^\[\]]*]([^\[\]]+)\[\/\s*link]/gi,'<a style="'+t.STYLE_BODY+"display:inline-block;color:#005ffb;text-decoration:none;font-size:"+(t.browser.mobile?14:12)+'px;" href="javascript:void(0);" onclick="nTalk.chatManage.get(\'$1\').switchUI(\'message\', $2);return false;" >$3</a>'],[/\[link\s+cancel=([^\s\[\]'"]+)\s+action=([^\s\[\]'"]+)\s*[^\[\]]*]([^\[\]]+)\[\/\s*link]/gi,'<a style="'+t.STYLE_BODY+'display:inline-block;color:#005ffb;text-decoration:none;" href="javascript:void(0);" onclick="nTalk.chatManage.get(\'$1\').cancelUpload(\'$2\');return false;" >$3</a>'],[/\[link\s+resend=([^\s\[\]'"]+)\s+msgid=([^\s\[\]'"]+)\s*[^\[\]]*]([^\[\]]+)\[\/\s*link]/gi,'<a style="'+t.STYLE_BODY+'display:inline-block;color:#005ffb;text-decoration:none;" href="javascript:void(0);" onclick="nTalk.chatManage.get(\'$1\').resend(\'$2\', this);return false;" >$3</a>'],[/\[link\s*manual=([^\s\[\]'"]+)](.*?)\[\/link]/gi,'<a style="'+t.STYLE_BODY+'display:inline-block;color:#005ffb;text-decoration:none;" href="javascript:void(0);" onclick="nTalk.chatManage.get(\'$1\').switchServerType(true);return false;" >$2</a>'],[/\[link\s*artificial=([^\s\[\]'"]+)](.*?)\[\/link]/gi,'<a style="'+t.STYLE_BODY+'display:inline-block;color:#005ffb;text-decoration:none;" href="javascript:void(0);" onclick="nTalk.chatManage.get(\'$1\').switchServerType(true);return false;" >$2</a>'],[/\[link\s*robot](.*?)\[\/link]/gi,'<a style="'+t.STYLE_BODY+'display:inline-block;color:#005ffb;text-decoration:none;" href="javascript:void(0);" onclick="nTalk.chatManage.get().switchServerType(false, 2);return false;" >$1</a>'],[/\[link\s*robotindex=([^\s\[\]'"]+)\s*\](.*?)\[\/link]/gi,'<a style="'+t.STYLE_BODY+'display:inline-block;color:#005ffb;text-decoration:none;" href="javascript:void(0);" onclick="nTalk.chatManage.get(\'{$settingid}\').send(\'$1\');return false;">$2</a>'],[/\[link\s*rightTag=true\s*url="(.*?)"\s*close=(.*?)\s*title="(.*?)"\s*\](.*?)\[\/link\]/gi,'<span style="'+t.STYLE_BODY+'display:inline-block;color:#005ffb;text-decoration:none;cursor:pointer;" rightTag="true" src="$1" closeBtn="$2" title="$3">$4</span>'],[/\[xnlink](.*?)\[\/xnlink]/gi,'<span class="robotQuestion" style="'+t.STYLE_BODY+'display:inline-block;color:#005ffb;text-decoration:none;cursor:pointer;" href="javascript:void(0);" >$1</span>'],[/\[link\s*href=(.*?)](.*?)\[\/link]/gi,'<a style="'+t.STYLE_BODY+'display:inline-block;color:#005ffb;text-decoration:none;cursor:pointer;" href="$1">$2</a>'],[/\[link\s*(.*?)?](.*?)\[\/link]/gi,'<a style="'+t.STYLE_BODY+'display:inline-block;color:#005ffb;text-decoration:none;cursor:pointer;" href="javascript:void(0);"'+(t.browser.iOS?' href="$1" target="_blank"':" onclick=\"window.open('$1')\"")+">$2</a>"],[/\{\$(\w+)}/gi,function(e,i){return t.utils.options[i]||""}]]},toHSL:function(e){return t.isHex(e)?t.rgb2HSL(t.hex2RGB(e)):t.isRGB(e)?t.rgb2HSL(e):e},isHex:function(t){return"string"==typeof t&&/^#?([0-9a-f]{3}|[0-9a-f]{6})$/gi.test(t)},isRGB:function(e){return t.isObject(e)&&t.isDefined(e.r)&&t.isDefined(e.g)&&t.isDefined(e.b)},isHSL:function(e){return t.isObject(e)&&t.isDefined(e.h)&&t.isDefined(e.s)&&t.isDefined(e.l)},hex2RGB:function(t){var e=t.toString().replace("#",""),i=e.split(""),n={};
return n=3==e.length?{r:parseInt(i[0]+i[0],16),g:parseInt(i[1]+i[1],16),b:parseInt(i[2]+i[2],16)}:6==e.length?{r:parseInt(i[0]+i[1],16),g:parseInt(i[2]+i[3],16),b:parseInt(i[4]+i[5],16)}:{r:0,g:0,b:0}},rgb2HSL:function(t){var e,i,n,s,o,a,r,h,l,c={};return e=t.r/255,i=t.g/255,n=t.b/255,r=Math.min(e,i,n),h=Math.max(e,i,n),l=h-r,c.l=(h+r)/2,0===l?(c.h=0,c.s=0):(c.l<.5?c.s=l/(h+r):c.s=l/(2-h-r),s=((h-e)/6+l/2)/l,o=((h-i)/6+l/2)/l,a=((h-n)/6+l/2)/l,e==h?c.h=a-o:i==h?c.h=1/3-a+s:n==h&&(c.h=2/3-s+o),c.h<0&&(c.h+=1),c.h>1&&(c.h-=1)),c}}),t.fn.extend({animate:function(e,i,n){return t.each(this,function(s,o){t.animate(o,e,i,n)})},show:function(e,i){return t.isFunction(e)&&(i=e,e=500),this.animate({visibility:"visible",opacity:{from:0,to:1}},e||500,i)},hide:function(e,i){return t.isFunction(e)&&(i=e,e=500),this.animate({opacity:{to:0}},e||500,i)},gradient:function(e,i,n){var s,o;return e?t.each(this,function(a,r){if(t.browser.oldmsie&&(s=/top|bottom/.test(e)?0:1,/right|bottom/.test(e)&&(o=i,i=n,n=o)),t.browser.webkit){switch(e){case"top":s="0% 100%,0% 0%";break;case"right":s="0% 0%,100% 0%";break;case"bottom":s="0% 0%,0% 100%";break;case"left":s="100% 0%,0% 0%"}t(r).css("background-image",e?"-webkit-gradient(linear,"+s+",color-stop(1, "+i+"),color-stop(0, "+n+"))":"none")}else if(t.browser.gecko)t(r).css("background-image",e?"-moz-linear-gradient("+e+", "+i+", "+n+")":"none");else if(t.browser.oldmsie){var h=/progid:DXImageTransform\.Microsoft\.gradient\((.*?)\)\s*/gi;r.style.filter=r.currentStyle.filter.replace(h,"")+(e?" progid:DXImageTransform.Microsoft.gradient(GradientType="+s+",startColorstr='"+i+"', endColorstr='"+n+"')":"")}else t.browser.msie?t(r).css("background-image",e?"-ms-linear-gradient("+e+", "+i+", "+n+")":"none"):t(r).css("background-image",e?"linear-gradient("+e+", "+i+", "+n+")":"none")}):t.each(this,function(e,i){t.browser.oldmsie?t(i).css("filter","none"):t(i).css("background-image","none")})}}),t.extend({base64:{_strKey:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var i,n,s,o,a,r,h,l=t.base64,c="",d=0;for(e=l._utf8_encode(e||"");d<e.length;)i=e.charCodeAt(d++),n=e.charCodeAt(d++),s=e.charCodeAt(d++),o=i>>2,a=(3&i)<<4|n>>4,r=(15&n)<<2|s>>6,h=63&s,isNaN(n)?r=h=64:isNaN(s)&&(h=64),c=c+l._strKey.charAt(o)+l._strKey.charAt(a)+l._strKey.charAt(r)+l._strKey.charAt(h);return c},decode:function(e){var i,n,s,o,a,r,h,l=t.base64,c="",d=0;for(e=(e||"").replace(/[^A-Za-z0-9\+\/=]/g,"");d<e.length;)o=l._strKey.indexOf(e.charAt(d++)),a=l._strKey.indexOf(e.charAt(d++)),r=l._strKey.indexOf(e.charAt(d++)),h=l._strKey.indexOf(e.charAt(d++)),i=o<<2|a>>4,n=(15&a)<<4|r>>2,s=(3&r)<<6|h,c+=String.fromCharCode(i),64!=r&&(c+=String.fromCharCode(n)),64!=h&&(c+=String.fromCharCode(s));return c=l._utf8_decode(c)},_utf8_encode:function(t){t=t.replace(/\r\n/g,"\n");for(var e="",i=0;i<t.length;i++){var n=t.charCodeAt(i);n<128?e+=String.fromCharCode(n):n>127&&n<2048?(e+=String.fromCharCode(n>>6|192),e+=String.fromCharCode(63&n|128)):(e+=String.fromCharCode(n>>12|224),e+=String.fromCharCode(n>>6&63|128),e+=String.fromCharCode(63&n|128))}return e},_utf8_decode:function(t){for(var e,i,n,s="",o=0;o<t.length;)e=t.charCodeAt(o),e<128?(s+=String.fromCharCode(e),o++):e>191&&e<224?(i=t.charCodeAt(o+1),s+=String.fromCharCode((31&e)<<6|63&i),o+=2):(i=t.charCodeAt(o+1),n=t.charCodeAt(o+2),s+=String.fromCharCode((15&e)<<12|(63&i)<<6|63&n),o+=3);return s}},FORM:{createInput:function(e,i,n){for(var s,o,a,r,h=[],l=t.browser.mobile,c=t.extend({id:"",rowspan:0,style:""},i),d='<span class="ntkf-text-red" style="'+t.STYLE_BODY+'padding:2px 5px 2px 0;color:#f00;">'+(n||"")+"</span>",u=0;u<e.length;u++){switch(s=t.extend({titlewidth:"80px",inputwidth:"auto",input:{width:"90%",height:"auto"}},e[u]),r=l?s.title:s.title+(s.title.length==t.enLength(s.title)?":":""),/zh_cn|zh_tw/.test(t.lang.language)&&t.enLength(s.title)>16||s.multipart||/radio|checkbox/.test(s.type)&&s.options.length>2?(s.multipart=!0,h.push(l?'<tr style="'+t.STYLE_BODY+'"><td style="'+t.STYLE_BODY+'width:100%;"><div class="nt-mobile-form-title" style="'+t.STYLE_BODY+'width:100%; line-height:14px; font-size:14px; font-weight:bold; text-align:center; color:#333333; margin: 15px 0px 20px 0px">'+r+"</div>":['<tr style="',t.STYLE_BODY,'">','<td style="',t.STYLE_BODY,'vertical-align:top;line-height:28px;color:#333;" colspan="2">','<div style="',t.STYLE_BODY,'margin:5px 10px 5px 10px;color:#5a5a5a;">',r,s.required===!0?d:"","</div>","</td>","</tr>",'<tr style="'+t.STYLE_BODY+'"><td style="',t.STYLE_BODY,'padding:0 5px 0 0;text-align:right;vertical-align:top;line-height:28px;color:#333;"></td>','<td style="'+t.STYLE_BODY+"line-height:28px;width:"+s.inputwidth+';">'].join(""))):h.push('<tr style="'+t.STYLE_BODY+'">'+(l?"":'<td style="'+t.STYLE_BODY+"padding:0 5px 0 0;text-align:right;vertical-align:top;line-height:28px;color:#333;width:"+s.titlewidth+';"><div style="'+t.STYLE_BODY+'margin:4px 0 0 0;text-align:right;color:#5a5a5a;">'+(s.required===!0?d:"")+r+"</div></td>")+'<td style="'+t.STYLE_BODY+"line-height:28px;width:"+(l?"100%":s.inputwidth)+';">'),s.type){case"select":h.push('<select data-index="'+u+'" name="'+s.name+'" style="'+t.STYLE_BODY+"border:1px solid #ccc;height:24px;color:#333;margin:0 0 4px;line-height:20px;width:"+(l?"99%":s.input.width)+';">'),h.push('<option value="" style="'+t.STYLE_BODY+'color:#ccc;">'+s.defaultText+"</option>");for(var p=0;p<s.options.length;p++)o=s.options[p],o="string"==typeof o?{text:o,value:o}:o,h.push('<option value="'+o.value+'" style="'+t.STYLE_BODY+'color:#333;">'+o.text+"</option>");h.push("</select>");break;case"radio":h.push('<ul style="'+t.STYLE_BODY+'list-style:none;">');for(var m,g=0;g<s.options.length;g++)o=s.options[g],o="string"==typeof o?{text:o,value:o}:o,m=s.name+"_"+g,a=s.defaultText==o.value?" checked":"",h.push('<li class="form-item" style="'+t.STYLE_BODY+'list-style:none;padding:0 2px 0 0;color:#000;float:left;"><input type="radio" name="'+s.name+'"id="'+m+'" value="'+o.value+'" _custom_text="'+o.text+'" style="'+t.STYLE_BODY+'color:#333;outline:none;-webkit-appearance:radio"'+a+' /><label for="'+m+'" style="'+t.STYLE_BODY+'display:inline;color:#000;">'+o.text+"</label></li>");h.push('<li style="'+t.STYLE_BODY+'list-style:none;clear:both;width:0;height:0;"></li>'),h.push("</ul>");break;case"checkbox":h.push('<ul style="'+t.STYLE_BODY+'list-style:none;">');for(var f,v=0;v<s.options.length;v++)o=s.options[v],o="string"==typeof o?{text:o,value:o}:o,f=s.name+"_"+v,a=s.defaultText==o.value?" checked":"",h.push('<li class="form-item" style="'+t.STYLE_BODY+'list-style:none;padding:0 2px 0 0;float:left;"><input type="checkbox" name="'+s.name+'" id="'+f+'" value="'+o.value+'" _custom_text="'+o.text+'" style="'+t.STYLE_BODY+'color:#333;"'+a+' /><label for="'+f+'" style="'+t.STYLE_BODY+'display:inline;color:#000;">'+o.text+"</label></li>");h.push('<li style="'+t.STYLE_BODY+'list-style:none;clear:both;width:0;height:0;"></li>'),h.push("</ul>");break;case"textarea":h.push('<textarea data-index="'+u+'" name="'+s.name+'" style="'+t.STYLE_BODY+"border:1px solid #ccc;color:#ccc;width:"+(l?"99%":s.input.width)+";height:"+s.input.height+';"'+(t.browser.html5?' placeholder="'+s.defaultText+'">':">"+s.defaultText)+"</textarea>");break;default:h.push('<input data-index="'+u+'" type="text" name="'+s.name+'"'+(t.browser.html5?' placeholder="'+s.defaultText+'" value=""':' value="'+s.defaultText+'"')+' maxlength="32" style="'+t.STYLE_BODY+"border:1px solid #ccc;height:24px;width:"+(l?"99%":s.input.width)+';margin:0 0 4px;color:#ccc;"'),"phone"==s.verification&&h.push(" onblur=\"this.value=this.value.replace(/[^0-9-]+/, '');\" onkeyup=\"var keyCode=(event || window.event).keyCode; if( !/16|17|35|36|37|38|39|40/i.test(keyCode) ){this.value=this.value.replace(/[^0-9-]+/, '');}\""),h.push(" />")}s.messageid&&(h.push('<div style="'+t.STYLE_BODY+'display:none;color:#EF7208;" class="form-info '+s.messageid+'">'),h.push('<div style="'+t.STYLE_BODY+"margin:2px;width:15px;height:15px;float:left;background:transparent url("+t.sourceURI+'/images/chaticon.png) no-repeat -160px -39px;"></div>'),h.push('<div style="'+t.STYLE_BODY+'color:#EF7208;float:left;" class="chat-view-info"></div>'),h.push('<div style="'+t.STYLE_BODY+'clear:both;width:0;height:0;"></div>'),h.push("</div>")),h.push("</td>"),c.style&&0===u&&h.push('<td style="'+t.STYLE_BODY+c.style+'" id="'+c.id+'" rowspan="'+c.rowspan+'"></td></tr>')}return h.join("")},bindFormEvent:function(e,i){var n=function(){var i=t(this).css({color:"#333","border-color":t.browser.mobile?"#0079fe":"#666"}),n=i.attr("data-index")||0,s=e[n].defaultText;s==i.val()&&i.val("")},s=function(){var i=t(this).css("border-color","#ccc"),n=i.attr("data-index")||0,s=e[n].defaultText;""===i.val()&&i.val(s),""!==i.val()&&i.val()!=s||i.css("color","#ccc")};t(i).find("input[type=text]").bind("focus",n).bind("blur",s),t(i).find("textarea").bind("focus",n).bind("blur",s)},verificationForm:function(e,i,n,s){for(var o,a,r,h,l,c=[],d=!1,u=new RegExp("\\d{6,}","i"),p=new RegExp("^[a-zA-Z0-9\\._-]+@[a-zA-Z0-9_-]+(\\.[a-zA-Z0-9_-]+)+$","i"),m=this,g=function(e,i){i.checked&&(l={value:t(i).val()||"",text:t(i).attr("_custom_text")})},f=function(){t(this).display()},v=0;v<e.length;v++){switch(e[v].type){case"checkbox":l=[],o=t(n).find("input[name="+e[v].name+"]"),a=t(n).find("input[name="+e[v].name+"][checked]");for(var x=0;x<a.length;x++)l.push({value:a.get(x).value,text:t(a.get(x)).attr("_custom_text")});break;case"radio":l={value:"",text:""},o=t(n).find("input[name="+e[v].name+"]"),t(n).find("input[name="+e[v].name+"][checked]").each(g);break;case"select":o=t(n).find("select[name="+e[v].name+"]"),l=t("option[selected]",o).val()||"",l=e[v].defaultText&&l==e[v].defaultText?"":l;break;case"textarea":o=t(n).find("textarea[name="+e[v].name+"]"),e[v].defaultText&&e[v].defaultText==o.val()?(l="",o.val("")):l=o.val().replace(/(\")|(\')|((^\s*)|(\s*$))/g,"");break;default:o=t(n).find("input[name="+e[v].name+"]"),e[v].defaultText&&e[v].defaultText==o.val()?(l="",o.val("")):l=o.val().replace(/(^\s*)|(\s*$)/g,"")}r="string"==typeof l?""===l||!l.length:t.isArray(l)?0===l.length:""===l.value,h=!(!e[v].messageid||!e[v].message);var w=t(n).find("."+e[v].messageid),b=t(n).find("."+e[v].messageid+" .chat-view-info");e[v].required&&r?(m.showError(h,e[v].message[0],b,w,o,e[v].type),d=!0):("phone"!=e[v].verification||r||u.test(l))&&("email"!=e[v].verification||r||p.test(l))?e[v].min&&!r&&t.enLength(l)<e[v].min?(m.showError(h,e[v].message[1],b,w,o),d=!0):e[v].max&&!r&&t.enLength(l)>e[v].max?(m.showError(h,e[v].message[2],b,w,o),d=!0):(h?w.hide(f):/radio|checkbox/.test(e[v].type)?o.parent().css("color","#333"):o.css("border-color","#DBD8D1"),r||c.push({name:e[v].name,title:e[v].title,value:l})):(m.showError(h,e[v].message[1],b,w,o),d=!0)}return d?void("function"==typeof s&&s()):(t.Log("form submit complete, failCallback is null",3),void("function"==typeof i?i(c):t.Log("form submit complete, callback is null",3)))},showError:function(e,i,n,s,o,a){var r=this;if(e&&i)if(t.browser.mobile){this.messageErrorToast&&(this.messageErrorToast.remove(),this.messageErrorToast=null,this.messageErrorTimeout&&clearTimeout(this.messageErrorTimeout));var h=i.length>10?300:250;this.messageErrorToast=new t.Toast('<div id="#message_error" style="position: relative;width: '+(h-50)+'px; height:30px; line-height: 30px;z-index:100; color: #FFF; top: 30px; left: 25px; text-align:center;font-weight:bold">'+i+"</div>",{width:h,height:90}),this.messageErrorTimeout=setTimeout(function(){r.messageErrorToast.remove(),r.messageErrorToast=null,o.get(0).focus()},2e3)}else n.html(i),s.display(1).show(),o.get(0).focus();else/radio|checkbox/.test(a)?o.parent().css("color","#f00"):o.css("border-color","#f00").get(0).focus()}}}),t.Transfer=t.Class.create(),t.Transfer.prototype={name:"Transfer",button:null,element:null,form:null,iframe:null,proxy:null,options:null,debug:!0,fkey:"",initialize:function(e,n){this.button=n;var s=t.randomChar(16);if(this.options=t.extend({onError:i,onChange:i,callback:i,name:s,curName:"",compSize:512e3,params:{},target:"iframe-transfer-"+s},e),!this.options.server)return void t.Log("server is null",3);this.proxy=t({tag:"IFRAME",name:"proxy-"+s,src:this.options.server.substring(0,this.options.server.lastIndexOf("/"))+"/proxy.html?t="+t.getTime(),style:t.STYLE_NBODY+"width:0px;height:0px;display:none;"}).appendTo(t(this.button)).get(0).contentWindow;var o=this,a=Math.max(20,this.button.width(),parseFloat(this.button.css("width"))),r=Math.max(20,this.button.height(),parseFloat(this.button.css("height"))),h=t.STYLE_BODY+"width:"+a+"px;height:"+r+"px;overflow:hidden;";this.completed=function(t){var e=/^(?:loaded|complete|undefined)$/,i=this.readyState;e.test(i)&&(o.iframe.removeEvent("readystatechange",o.completed).removeEvent("load",o.completed),o.transferComplete(t,o.fkey))},this.form=t({tag:"FORM",action:"",method:"POST",target:this.options.target,enctype:"multipart/form-data",style:h}).appendTo(this.button,!0),this.iframe=t({tag:"IFRAME",name:this.options.target,src:"about:blank",style:h+"width:0;height:0;display:none;"}).appendTo(this.button,!0),this.element=t({tag:"INPUT",type:"file",name:this.options.name,accept:this.options.accept||"*",style:h,title:this.button.attr("title")||""}).appendTo(this.form,!0).css("opacity",0),this.element.click(function(){""!==this.value&&o.form.get(0).reset(),o.iframe.bind("readystatechange",o.completed).bind("load",o.completed),o.fkey=t.randomChar(16)}).bind("change",function(t){var e={};this.files?(e.name=this.files[0].name,e.size=this.files[0].size):(e.name=this.value.substring(this.value.lastIndexOf("\\")+1),e.size=""),e.name&&(o.options.onChange(e),o.fileChange(t,this.files||this.value))})},transferComplete:function(e,i){var n=this;i&&(this.debug&&t.Log("$.upload.transferComplete(event, "+i+")"),t.jsonp(this.options.server+"?"+t.toURI(t.extend({getaction:1,fkey:i},this.options.params))+"#rnd",function(e){n.debug&&t.Log("get transfer file info:"+t.JSON.toJSONString(e),1),e.name=n.options.curName||n.options.name||"",n.options.callback(e)}))},fileChange:function(e,i){var n=this;this.isMobileCompTransf(i,function(s){s?t.browser.oldAndroid?t.require("jpeg_encoder_basic.js?siteid="+n.options.params.siteid,function(t){n.mobileCompTransf(e,i)}):t.browser.oldIOS?t.require("megapix-image.js?siteid="+n.options.params.siteid,function(t){n.mobileCompTransf(e,i)}):n.mobileCompTransf(e,i):n.commonTransf(e,i)})},isMobileCompTransf:function(e,i){if(t.browser.mobile&&(window.URL||window.webkitURL)&&document.createElement("canvas"))if(e[0].name.toLowerCase().indexOf("jpg")>-1)i(!0);else if(window.FileReader&&window.DataView){var n=new FileReader;n.onload=function(t){var e=new DataView(t.target.result);i(255==e.getUint8(0)&&216==e.getUint8(1))},n.readAsArrayBuffer(e[0])}else i(!1);else i(!1)},commonTransf:function(e,i){var n,s,o="uploadfile"==this.options.params.action;try{n=o?this.proxy.fileOptions.fileMaxSize:this.proxy.fileOptions.imageMaxSize,s=o?this.proxy.fileOptions.fileExt:this.proxy.fileOptions.imageExt}catch(a){n=null,s=null}if("string"==typeof i)this.debug&&t.Log("Name: "+i,2);else for(var r,h=0;h<i.length;h++){var l,c=i[h];if(l=c.name.indexOf(".")>-1?c.name.match(/\.[^\.]+$/)[0].replace(".","").toLowerCase():"",this.options.maxSize&&c.size>this.options.maxSize||n&&c.size>n)return void this.options.onError({type:9,name:c.name,size:c.size,etype:"SIZE",maxSize:this.options.maxSize||n});if("*"!=this.options.accept&&this.options.accept||s){if(this.options.accept&&this.options.accept.indexOf("/*")>-1){if(r=new RegExp(this.options.accept.replace(/\//,"\\/"),"gi"),!r.test(c.type))return t.Log("accept:"+this.options.accept+", type:"+c.type,2),void this.options.onError({type:9,name:c.name,size:c.size,etype:"TYPE"})}else{if(this.options.accept&&this.options.accept.indexOf(c.type)<=-1)return t.Log("accept:"+this.options.accept+", type:"+c.type,2),void this.options.onError({type:9,name:c.name,size:c.size,etype:"TYPE"});if(s&&s.indexOf(l)>-1)continue;if(s&&s.indexOf(l)==-1)return void this.options.onError({type:9,name:c.name,size:c.size,ext:s,etype:"TYPE"})}this.options.curName=c.name,this.debug&&t.Log("Name: "+this.options.curName)}}this.debug&&t.Log("$.upload.fileChange()"),this.form.attr("action",this.options.server+"?"+t.toURI(t.extend({fkey:this.fkey,rnd:t.getTime()},this.options.params))),t.browser.mobile&&this.options.callback({status:"startUpload",oldfile:i[0].name}),this.form.get(0).submit()},mobileCompTransf:function(e,i){var n=this;this.options.callback({status:"startCompress",oldfile:i[0].name}),this.fkey=t.getTime();new t.ImageOrientation(i[0],function(e,s){new t.CompressImg(i[0],{orientation:s},function(e,s){new t.POST(n.options.server+"?action=uploadimage",t.extend({base64:s,fname:t.getTime()+".png",fkey:n.fkey,rnd:t.getTime()},n.options.params),function(t){n.transferComplete(t,n.fkey)}),n.options.callback({status:"startUpload",oldfile:i[0].name,compress:!0})})})},base64Transf:function(e){var i=this;this.fkey=t.getTime(),new t.POST(this.options.server+"?action=uploadimage",t.extend({base64:e,fname:t.getTime()+".png",fkey:this.fkey,rnd:t.getTime()},this.options.params),function(t){i.transferComplete(t,i.fkey)})}},t.CompressImg=t.Class.create(),t.CompressImg.prototype={ctx:null,canvas:null,url:null,image:null,blob:null,compBlob:null,dataurl:null,resize:{width:null,height:null},options:{width:null,height:null,quality:.7},initialize:function(e,i,n){var s=this;this.url=window.URL||window.webkitURL,this.canvas=document.createElement("canvas"),this.blob="string"==typeof e?e:this.url.createObjectURL(e),this.options=t.extend(i,this.options),this.image=new Image,this.image.onerror=function(){t.Log("")},this.image.onload=function(e){s.getCompImage(),n(e,s.dataurl);var i=t.browser.oldIOS?1e4:0;setTimeout(function(){for(var t in s)s.hasOwnProperty(t)&&(s[t]=null)},i)},this.image.crossOrigin="*",this.image.src=s.blob},drawOldIOSCanvas:function(){var t=new MegaPixImage(this.image);"5678".indexOf(this.options.orientation)>-1?t.render(this.canvas,{width:this.canvas.height,height:this.canvas.width,orientation:this.options.orientation}):t.render(this.canvas,{width:this.canvas.width,height:this.canvas.height,orientation:this.options.orientation})},drawCanvas:function(){var t=this;switch(t.options.orientation){case 3:this.ctx.rotate(180*Math.PI/180),this.ctx.drawImage(this.image,-this.resize.width,-this.resize.height,this.resize.width,this.resize.height);break;case 6:this.ctx.rotate(90*Math.PI/180),this.ctx.drawImage(this.image,0,-this.resize.width,this.resize.height,this.resize.width);break;case 8:this.ctx.rotate(270*Math.PI/180),this.ctx.drawImage(this.image,-this.resize.height,0,this.resize.height,this.resize.width);break;case 2:this.ctx.translate(resize.width,0),this.ctx.scale(-1,1),this.ctx.drawImage(this.image,0,0,this.resize.width,this.resize.height);break;case 4:this.ctx.translate(resize.width,0),this.ctx.scale(-1,1),this.ctx.rotate(180*Math.PI/180),this.ctx.drawImage(this.image,-this.resize.width,-this.resize.height,this.resize.width,this.resize.height);break;case 5:this.ctx.translate(resize.width,0),this.ctx.scale(-1,1),this.ctx.rotate(90*Math.PI/180),this.ctx.drawImage(this.image,0,-this.resize.width,this.resize.height,this.resize.width);break;case 7:this.ctx.translate(resize.width,0),this.ctx.scale(-1,1),this.ctx.rotate(270*Math.PI/180),this.ctx.drawImage(this.image,-this.resize.height,0,this.resize.height,this.resize.width);break;default:this.ctx.drawImage(this.image,0,0,this.resize.width,this.resize.height)}},getCompImage:function(){var e=this;if(this.ctx=this.canvas.getContext("2d"),this.resize=this._getResize(),this.canvas.width=this.resize.width,this.canvas.height=this.resize.height,this.ctx.fillStyle="#fff",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),t.browser.oldIOS?this.drawOldIOSCanvas():this.drawCanvas(),t.browser.oldAndroid){var i=new JPEGEncoder,n=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height);this.dataurl=i.encode(n,100*this.options.quality)}else this.dataurl=this.canvas.toDataURL("image/jpeg",this.options.quality);this.url.revokeObjectURL(e.blob)},_getResize:function(){var t=this,e=this.image,i=this.options.width,n=this.options.height,s={width:e.width,height:e.height};"5678".indexOf(t.options.orientation)>-1&&(s.width=e.height,s.height=e.width);var o=s.width/s.height;for(i&&n?o>=i/n?s.width>i&&(s.width=i,s.height=Math.ceil(i/o)):s.height>n&&(s.height=n,s.width=Math.ceil(n*o)):i?i<s.width&&(s.width=i,s.height=Math.ceil(i/o)):n&&n<s.height&&(s.width=Math.ceil(n*o),s.height=n);s.width>=3264||s.height>=2448;)s.width*=.8,s.height*=.8;return s}},t.ImageOrientation=t.Class.create(),t.ImageOrientation.prototype={initialize:function(e,i){if(!window.FileReader||!window.DataView)return 1;var n=this,s=new FileReader;s.onload=function(e){i(t.Event.fixEvent(e),n._readImageOrientation(e.target.result))},s.readAsArrayBuffer(e)},_readImageOrientation:function(t){var e=new DataView(t);if(255!=e.getUint8(0)||216!=e.getUint8(1))return 1;for(var i,n=2,s=t.byteLength;n<s;){if(255!=e.getUint8(n))return 1;if(i=e.getUint8(n+1),225==i)return this._getOrientationFromExif(e,n+4,e.getUint16(n+2)-2);n+=2+e.getUint16(n+2)}},_getOrientationFromExif:function(t,e){if("Exif"!=this._getStringFromDB(t,e,4))return 1;var i,n=e+6;if(18761==t.getUint16(n))i=!1;else{if(19789!=t.getUint16(n))return 1;i=!0}if(42!=t.getUint16(n+2,!i))return 1;var s=t.getUint32(n+4,!i);return s<8?1:this._getOrientationFromTag(t,n,n+s,i)},_getOrientationFromTag:function(t,e,i,n){var s,o,a,r=t.getUint16(i,!n);for(a=0;a<r;a++)if(s=i+12*a+2,o=t.getUint16(s,!n),274==o)return this._getOrientationValue(t,s,e,i,n);return 1},_getOrientationValue:function(t,e,i,n,s){var o,a,r,h=t.getUint16(e+2,!s),l=t.getUint32(e+4,!s),c=t.getUint32(e+8,!s)+i;switch(h){case 3:if(1==l)return t.getUint16(e+8,!s);for(o=l>2?c:e+8,a=[],r=0;r<l;r++)a[r]=t.getUint16(o+2*r,!s);return a}},_getStringFromDB:function(t,e,i){var s="";for(n=e;n<e+i;n++)s+=String.fromCharCode(t.getUint8(n));return s}},t.DialogChat=new t.Class.create,t.DialogChat.prototype={contains:null,background:null,iframe:null,display:!1,selector:"",def:{close:!1,parent:window,margin:10,border:0,style:{height:"auto"},resizeFunc:null},options:null,_funcResize:i,initialize:function(e,i){var n=this;this.options=t.extend({},this.def,i),this.id=t.randomChar(),this.selector=".dialog-container-"+this.id,this._create(),this._style(this.options.style),this.display=!0,this.options.close&&(e+='<div class="dialog-button-close" style="'+t.STYLE_NBODY+'font-size:14px;position:absolute;right:10px;top:10px;width:20px;height:20px;line-height:20px;text-align:center;cursor:pointer;">x</div>'),this.container.html(e),setTimeout(function(){n.container.css({top:Math.max(0,(t(n.options.parent).height()-Math.max(n.container.height(),200))/2)+"px"})},5),this._funcResize=function(){n.resize()},this.options.parent==window&&t(window).addEvent("resize",this._funcResize),this.container.find(".dialog-button-close").click(function(){n.close()})},close:function(){var e=this;this.options.parent==window&&t(window).removeEvent("resize",this._funcResize),t(this.selector).hide(function(){t(".dialog-iframe-"+e.id+",.dialog-background-"+e.id).remove(),t(e.selector).remove(),e.display=!1})},resize:function(e,i){e=e||t(this.options.parent).width(),i=i||t(this.options.parent).height(),t(".dialog-iframe-"+this.id+",.dialog-background-"+this.id).css({width:e+"px",height:i+"px"});var n="auto"===this.options.style.height?"auto":i-2*this.options.margin-2*this.options.border;this.container.css({width:e-2*this.options.margin-2*this.options.border+"px",height:"auto"==n?"auto":n+"px","max-width":e+"px","max-height":i-40+"px"}),this.container.css("top",Math.max(0,(i-Math.max("auto"==n?this.container.height():n,200))/2)+"px"),this.options.resizeFunc&&this.options.resizeFunc.call()},_create:function(){var e=this.options.parent==window?document.body:this.options.parent,i=this.options.parent==window?"fixed":"absolute";this.iframe=t({tag:"IFRAME",className:"dialog-iframe-"+this.id,style:t.STYLE_NBODY+"position:"+i+";display:none;left:0;top:0;margin:0;padding:0;border:0;width:100%;z-index:8888;"}).appendTo(e),this.background=t({tag:"div",className:"dialog-background-"+this.id,style:t.STYLE_NBODY+"position:"+i+";left:0;top:0;margin:0;padding:0;border:0;width:100%;background-color:#000;z-index:8888;"}).appendTo(e);var n=t.browser.mobile?9e3:2147483647;this.container=t({tag:"div",className:"dialog-container-"+this.id,style:t.STYLE_BODY+"position:"+i+";left:0;top:0;margin:0;min-height:"+(this.options.minHeight?this.options.minHeight:200)+"px;border-radius:0px;z-index:"+n+";background:#fff;overflow-x:hidden;overflow-y:auto;"}).appendTo(e),this.background.bind("touchstart",function(e){var i=t.Event.fixEvent(e);i.stopPropagation(),i.preventDefault()}).bind("touchend",function(e){var i=t.Event.fixEvent(e);i.stopPropagation(),i.preventDefault()})},_style:function(e){var i=t(this.options.parent).width(),n=t(this.options.parent).height();t(".dialog-iframe-"+this.id+",.dialog-background-"+this.id).css({width:i+"px",height:t(this.options.parent).height()+"px"}),this.background.css({opacity:.6});var s=(this.options.margin+"").split(" ");1==s.length&&s.push(this.options.margin),this.container.css(e).css({left:s[0]+"px",top:s[1]+"px",width:i-2*s[0]-2*this.options.border+"px",height:"auto"===this.options.style.height?"auto":n-2*s[1]-2*this.options.border+"px"})}},t.Toast=new t.Class.create,t.Toast.prototype={id:null,container:null,toast:null,options:{},initialize:function(e,i){var n=this;this.id=t.randomChar(),this.options=t.extend(this.options,i),this.toastOpacity=t({tag:"div",className:"toast-opacity-"+this.id,style:t.STYLE_BODY+"position:relative;z-index:9000;width:"+this.options.width+"px;height:"+this.options.height+"px;margin-left:"+(t(window).width()-this.options.width)/2+"px;margin-top:"+(t(window).scrollTop()+(t(window).height()-this.options.height-100)/2)+"px;background-color:#000;opacity:0.5;border-radius:5px;font-size:16px;color:white;text-align:center;line-height:"+this.options.height+"px"}),this.toast=t({tag:"div",className:"toast-"+this.id,style:t.STYLE_BODY+"position:relative;z-index:10000;width:"+this.options.width+"px;height:"+this.options.height+"px;margin-left:"+(t(window).width()-this.options.width)/2+"px;margin-top:"+-this.options.height+"px;background-color:none;border-radius:5px;font-size:16px;color:white;text-align:center;line-height:"+this.options.height+"px"}),this.toast.html(e),this._create(),this._funcResize=function(){n.resize()},this._funRemove=function(){n.remove()},t(window).addEvent("resize",this._funcResize)},_create:function(){this.toastOpacity.appendTo(document.body),this.toast.appendTo(document.body)},change:function(e){t(".toast-"+this.id).html(e)},resize:function(){var e=t(window).width(),i=t(window).height(),n=(e-this.options.width)/2>0?(e-this.options.width)/2:0,s=(i-this.options.height-100)/2>0?t(window).scrollTop()+(i-this.options.height-100)/2:t(window).scrollTop();t(".toast-opacity-"+this.id).css({"margin-left":n+"px","margin-top":s+"px","max-width":e+"px","max-height":i+"px"}),t(".toast-"+this.id).css({"margin-left":n+"px","margin-top":-this.options.height+"px","max-width":e+"px","max-height":i+"px"})},remove:function(){t(".toast-opacity-"+this.id).remove(),t(".toast-"+this.id).remove()}},t.GifTimer=t.Class.create(),t.GifTimer.prototype={id:null,inter:null,timeout:null,options:{inTimeFunc:null,outTimeFunc:null,doTime:null,allTime:null},initialize:function(e){var i=this;this.options=t.extend(this.options,e),this.inter=setInterval(function(){i.options.inTimeFunc.call(i)},this.options.doTime),this.timeout=setTimeout(function(){clearInterval(i.inter),i.options.outTimeFunc.call(i)},this.options.allTime)},remove:function(){t.Log("giftimer remove"),clearInterval(this.inter),clearTimeout(this.timeout),this.inter=null,this.timeout=null}},t.Music=t.Class.create(),t.Music.prototype={msgid:null,url:null,type:null,duration:null,audioFlag:!0,musicEl:null,viewCallback:null,eventCallback:null,container:null,debugStr:"[nTalk Music]: ",initialize:function(t,e,i,n,s,o,a){this.msgid=t,this.url=e,this.type=i,this.duration=n,this.viewCallback=s,this.eventCallback=o,this.container=a,this.audioFlag=this.canPlayAudioMP3(),this.audioFlag?this.createAudioPlayer():this.createSwfPlayer(),this.viewCallback.call(this,"init"),this.eventCallback.call(this,"init")},createAudioPlayer:function(){var e=this;this.musicEl=document.createElement("audio"),this.musicEl.src=this.url,this.musicEl.type=this.type,this.musicEl.stop=function(){this.pause(),this.currentTime=0},t.Event.addEvent(this.musicEl,"ended",function(){t.Log(e.debugStr+" trigger ended stop mp3"),e.viewCallback.call(e,"stop")}),this.musicEl.getPaused=function(){return this.paused}},createSwfPlayer:function(){var e=this,i="ntalker_swf_mp3Player_container_"+this.msgid,n="ntalker_swf_mp3player_"+this.msgid,s=t.sourceURI+"fs/music.swf",o=t.flashHtml(n,s,"id="+n);this.musicEl=document.createElement("div"),this.musicEl.innerHTML+=o,this.musicEl.id=i,this.container.append(this.musicEl.outerHTML);var a=t.browser.msie&&t.browser.ieversion<=7?window[n]:document[n];setTimeout(function(){a.emit("load",e.url),a.emit("stop"),e.musicEl.play=function(){a.emit("play")},e.musicEl.stop=function(){a.emit("stop")},e.musicEl.getPaused=function(){return 0===a.getPaused()}},1e3)},emit:function(){this.musicEl.getPaused()?this.play():this.stop()},play:function(){t.Log(this.debugStr+"play mp3"),this.musicEl.play(),this.viewCallback.call(this,"play")},stop:function(){t.Log(this.debugStr+"stop mp3"),this.musicEl.stop(),this.viewCallback.call(this,"stop")},canPlayAudioMP3:function(){try{var t=document.createElement("audio");return!(!t.canPlayType||!t.canPlayType("audio/mpeg;").replace(/no/,""))}catch(e){return!1}}},t.paste=t.Class.create(),void(t.paste.prototype={data:null,callback:null,debugStr:"[nTalk pasteDate]: ",initialize:function(t,e){this.data=t.clipboardData||window.clipboardData,this.callback=e},getImgBase64Str:function(){var e=this,i=this.data;if(!i)return null;if("function"==typeof webInfoChanged)this.callback(i.getData("image/x-vnd.adobe.air.bitmap").toDataURL());else if(t.browser.chrome||t.browser.opera){var n,s,o=i.items;if(o){n=o[0],s=i.types||[];for(var a=0,r=s.length;a<r;a++)if("Files"===s[a]){n=o[a];break}if(n&&"file"===n.kind&&n.type.match(/^image\//i)){var h=n.getAsFile(),l=new FileReader;l.onload=function(t){e.callback(t.target.result)},l.readAsDataURL(h)}else this.callback()}}else this.callback()}}))}(nTalk);
/* @file base.js
 * @date 2017.10.17 18:52:26 
 */
!function(e,t){var a=["kf_9933","kf_9949","kf_9954"],i="nt-flash-div",o="ntkf_flash_ntid",n=2,l={trailserver:"",presenceserver:"",presencegoserver:"",crmcenter:"",mcenter:"",coopserver:"",roboturl:"",t2dstatus:"",isnoim:0,notrail:0,preload:2e3,sessioncarry:"1",enable_entrance:"0",enable_invite:"0",close_tchat_flash:"1",close_im_flash:"0",robot:"0",siteid:""},r=function(){},s=/[a-z]{2}\_\d+/gi;if(e.baseURI&&!e.base){if(e.extend({CON_LOAD_MODE_NID:1,CON_CUSTOMER_ID:0,CON_GROUP_ID:1,CON_VISITOR_ID:2,CON_SHORT_ID:3,mobileOpenInChat:parseInt(e.flashserver.reversechat,10),downtserver:CON_SERVER.flashserver}),e.base={_startBase:!1,_identityIDReady:!1,_connectTimeID:null,chatLoading:!1,clearChatCache:!1,timeOut:2e3,entityList:{"<":"&lt;",">":"&gt;"},fieldList:["shortid","uid","uname","isvip","userlevel","itemid","itemparam","erpparam","exparams"],CON_LOCAL_FIX:"NOWAIT_",call_trail_status:!1,userIdFix:"",_reload_trail:!1,identityInfoJson:{},useSdkData:!1,_get_page_data:null,config:null,_islogin:!0,start:function(){var t=this;return e.server?(e.Log("nTalk.base.start()",1),e.cookie.enable()||e.Log("Does not support cookies!",3),e.global.pageinchat=!0,e.global.statictis=n,e.source=e.url,this._identityIDReady=!1,void(this._startBase||(this.pageid=e.getTime(),this._startBase=!0,this._loadFlashServer(),e.isEmptyObject(CON_RULE)?(this.getPageData(),this._loadIdentityID(function(a,i){e.Log("PCID:"+i,1),t.startOtherMode(a,i)})):this.startData(function(){this._loadIdentityID(function(a,i){e.Log("PCID:"+i,1),t.startOtherMode(a,i)})})))):void e.Log("Loaded $server mode failed",3)},chanageUserID:function(){return"undefined"!=typeof NTKF_PARAM&&(!(!NTKF_PARAM.uid||!this.toLongID(NTKF_PARAM.uid)||this.toLongID(NTKF_PARAM.uid)==e.user.id)&&!(e.inArray(e.global.siteid,a)>-1&&e.global.siteid+"_ISME9754_"+NTKF_PARAM.uname==e.user.id))},overloadedData:function(t,a){e.isFunction(t)&&(a=t,t=null),e.Log("nTalk.base.overloadedData()"),e.isEmptyObject(CON_RULE)?(this.getPageData(t),e.user.id=e.global.uid||e.user.id,e.user.name=e.global.uname||"",e.cache.set("uid",e.user.id),e.isFunction(a)&&a(),e.base.startTrail(e.base._islogin,!0)):this.startData(function(){e.user.id=e.global.uid||e.user.id,e.user.name=e.global.uname||"",e.cache.set("uid",e.user.id),e.isFunction(a)&&a(),e.base.startTrail(e.base._islogin,!0)},t)},startData:function(t,a){var i=this;e.Log("nTalk.base.startData()"),e.require({data:"data.js"+e.baseExt},function(o){if(!o)return void e.Log("Loaded $data mode failed",3);var n=e.data.start(CON_RULE);i._get_page_data=e.extend({},n,a),i.getPageData(i._get_page_data),t.call(i)})},_execMode:function(){this._startBase=!0,this._loadFlashServer()},startTrail:function(t,a,i){var o=this;e.require({trail:"trail.js"+e.baseExt},function(n){if(!n)return void e.Log("Loaded $trail mode failed",3);var l=function(){};i&&(l=function(){o.trailGetRegion(i)}),e.trail.start(t,a,o.useSdkData,l)})},startIM:function(){var t={};e.im&&e.im.connect||(t.IM="im.js"+e.baseExt,e.browser.supportMqtt&&e.server.eduimmqttserver&&1==e.server.tchatConnectType?t.MQTT="mqtt31.js"+e.baseExt:e.flash.support&&e.server.eduimmqttserver&&1==e.server.tchatConnectType&&(t.MQTT="flashsock.js"+e.baseExt),t.Connection="mqtt.im.js"+e.baseExt,e.require(t,function(){e.im.start()}))},startLCrm:function(t,a,i){var o=t&&e.isArray(t)?t:[t];e.require({lcrm:"lcrm.js"+e.baseExt},function(t){e.each(o,function(t,o){e.Log("start lcrm mode",1),e.lcrm.start(o,a,i)})})},startChat:function(t,a,i,o,n,l,r,s,d,g){var c;return t=t||"",a=a||"",i=i||"",o=o||"",n=n||"",d=d||"",g=g||"",e.im&&e.im.hideTips(),e.base.chatLoading===!0?void e.Log("loading......",2):(e.Log("$.base.startChat("+e.JSON.toJSONString(arguments)+")",1),e.base.showLoading(),c={lang:(e.extParmas.lan||"zh_cn")+".js"+e.baseExt},e.browser.supportMqtt&&e.server.tchatmqttserver&&1==e.server.tchatConnectType?(c.MQTT="mqtt31.js"+e.baseExt,c.Connection="mqtt.chat.js"+e.baseExt):e.flash.support&&e.server.tchatmqttserver&&1==e.server.tchatConnectType?(c.MQTT="flashsock.js"+e.baseExt,c.Connection="mqtt.chat.js"+e.baseExt):c.TChat="comet.chat.js"+e.baseExt,e.global.themes?(c.chatManage="chat.js"+e.baseExt,c.chatManageView=e.global.themes+"/chat.view.in.js"+e.baseExt,e.themesURI=e.global.themes+"/images/"):e.mobileOpenInChat&&e.browser.mobile?c.chatManage="chat.js"+e.baseExt:c.chatManage="chat.in.js"+e.baseExt,c.Window="nt2.js"+e.baseExt,1==e.server.robot&&(c.Robot="robot.js"+e.baseExt),void e.require(c,function(){return e.base.hiddenLoading(),e.chatManage?(e.Log("load $chatManage mode complete"),void(e.chatManage.open(t,a,i,o,n,l,r,s,d,g)&&(d||e.cache.set("opd",1)))):void e.Log("Load $chatManage mode failed",3)}))},startEntrance:function(){var t=e.server.entranceConfig[e.global.settingid]||"";e.Log("$.base.startEntrance()"),t&&e.server.entranceConfig&&!e.isEmptyObject(e.server.entranceConfig)&&e.require({entrance:t+e.baseExt},function(t){return t?("0"!=e.server.enable_entrance&&e.options.entrance&&e.entrance.start("entrance"),void("0"!=e.server.enable_entrance&&e.options.invite&&e.entrance.start("invite"))):void e.Log("Load $.entrance mode failed",3)})},showLoading:function(){return e.base.chatLoading=!0,e.base.startTime=e.getTime(),this.loadingElement&&this.loadingElement.length?this.loadingElement.display(1):this.loadingElement=e({id:"ntalk-chat-loading",style:e.STYLE_NBODY+"width:100%;height:33px;position:fixed:right:0;bottom:0;z-index:9999;"}).appendTo(!0).fixed({right:0,bottom:0}).html('<div style="'+e.STYLE_BODY+"margin:0 auto;width:99px;height:33px;background:url("+e.imageloading+') no-repeat 0 0;"></div>'),this.loadingElement},hiddenLoading:function(){this.loadingElement.display(),e.base.endTime=e.getTime(),e.base.chatLoading=!1,e.Log("$.base.showLoading-hiddenLoading execute time:"+(e.base.endTime-e.base.startTime)+" ms",1)},toLongID:function(t){t.length>47&&(t=t.substr(0,47));var a=this.checkID(t);return a===e.CON_SHORT_ID?e.global.siteid+"_ISME9754_"+t:a==e.CON_VISITOR_ID?t:""},toShortID:function(t){var a=this.checkID(t);return a===e.CON_SHORT_ID?t:a===e.CON_VISITOR_ID?t.replace(this.userIdFix,""):""},checkID:function(t){return t=t?t.toString():"",!(!t||"0"===t)&&(t.indexOf("_ISME9754_T2D")>-1?e.CON_CUSTOMER_ID:t.indexOf("_ISME9754_GT2D")>-1?e.CON_GROUP_ID:t.indexOf(e.global.siteid+"_ISME9754_")>-1?e.CON_VISITOR_ID:e.CON_SHORT_ID)},trailGetRegion:function(t){var a,i,o;e.global.trailGetRegion=new Object,e.global.trailGetRegion.success=!1,e.global.trailGetRegion.ip="",e.global.trailGetRegion.country="",e.global.trailGetRegion.province="",e.global.trailGetRegion.city="",i="trail_getregion_"+e.randomChar(),a=e.protocolFilter(e.flashserver.trailserver)+"/userinfo.php?action=getregion&",o=e.toURI({siteid:e.global.siteid,userid:t,callback:i}),window[i]=function(t){1==t.success&&(e.global.trailGetRegion.success=!0,e.global.trailGetRegion.ip=t.data.ip,e.global.trailGetRegion.country=t.data.country,e.global.trailGetRegion.province=t.data.province,e.global.trailGetRegion.city=t.data.city)},e.require(a+o)},startOtherMode:function(t,a){var i,o,n=e.cache.get("uid")||"";if(clearTimeout(this._connectTimeID),this._connectTimeID=null,this._identityIDReady=!0,e.Log("cache uid:"+n+", site uid:"+t+", return uid:"+t,1),n?this._islogin=n!=t:this._islogin=!0,e.global.pcid=a,e.user.id=t,e.isDefined(e.global.uname)&&(e.user.name=e.global.uname),e.cache.set("uid",t),e.cookie.set(e.CON_PCID_KEY,a,63072e6),0===e.server.notrail?this.startTrail(this._islogin,!1,t):(e.Log("no load trail"),this.trailGetRegion(t)),e.server.entranceConfig&&("0"!=e.server.enable_entrance||"1"==e.server.enable_invite)){if("2"==e.server.enable_entrance&&e.browser.mobile)return;this.startEntrance()}if(!e.server.isnoim||3==e.server.isnoim||2==e.server.isnoim&&"1"==e.cache.get("opd")?(e.Log("nTalk.base.startIM()::"+e.im,1),this.startIM()):e.Log("no load im, isnoim:"+e.server.isnoim+", opd:"+e.cache.get("opd"),1),1==e.browser.mobile){var l=[".full-html,.full-body{","width: 100% !important;","height: 100% !important;","margin: 0 !important;","overflow: hidden !important;","}",".full-body *{","display: none !important;","}",".full-iframe {","display: block !important;","}",".full-inpage {","width: 100% !important;","height: 100% !important;","margin: 0 !important;","overflow: hidden !important;","background: rgb(243, 243, 247) !important;","}",".full-inpage > *:not(.ntalk-mobile-inpage-background) {","display: none !important;","}"].join("");e.addMobileStyle(l)}if(o={settingid:e.cache.get("carry_sid"),destid:e.cache.get("carry_did")},"0"!=e.server.sessioncarry&&o.settingid&&!e.browser.mobile){if(e.Log("sessioncarry:"+e.JSON.toJSONString(o)),e.cache.set("carry_sid",""),e.cache.set("carry_did",""),o.settingid){if(o.settingid.indexOf("ISME9754")>-1)return;e.browser.mobile||!e.global.pageinchat?(i={single:-1},e.im_openOutPageChat(o.settingid,"",o.destid,i,"")):(i={autoconnect:!0,single:-1},e.im_openInPageChat(o.settingid,"",o.destid,i,""))}}else e.server.preload>0&&!e.global.themes&&this.preloadChat()},preloadChat:function(){var t;e.Log("$.base.preloadChat()",1),setTimeout(function(){e.base.chatLoading!==!0&&(t={lang:(e.extParmas.lan||"zh_cn")+".js"+e.baseExt},e.global.themes?(t.chatManage="chat.js"+e.baseExt,t.chatManageView=e.global.themes+"/chat.view.in.js"+e.baseExt,e.themesURI=e.global.themes+"/images/"):e.mobileOpenInChat&&e.browser.mobile?t.chatManage="chat.js"+e.baseExt:t.chatManage="chat.in.js"+e.baseExt,t.Window="nt2.js"+e.baseExt,e.browser.supportMqtt&&e.server.tchatmqttserver&&1==e.server.tchatConnectType?(t.MQTT="mqtt31.js"+e.baseExt,t.Connection="mqtt.chat.js"+e.baseExt):e.flash.support&&1==e.server.tchatConnectType?(t.MQTT="flashsock.js"+e.baseExt,t.Connection="mqtt.chat.js"+e.baseExt):t.TChat="comet.chat.js"+e.baseExt,1==e.server.robot&&(t.Robot="robot.js"+e.baseExt),e.require(t,function(t,a){a?e.Log("preload $chatManage mode complete"):e.Log("preload $chatManage mode failed",3)}))},e.server.preload)},getPageData:function(t){var i;return e.Log("nTalk.base.getPageData()"),i=e.extend({},"undefined"!=typeof NTKF_PARAM?NTKF_PARAM:{},t),e.whereGetTo(e.global,i,["siteid","sellerid","settingid","uid","uname","exparams","themes","callbacks","backURL","isvip","userlevel","itemid","itemparam","orderid","orderprice","erpparam","ntalkerparam","pagetype","title","lang","iconid"],[null,null,null,"shortid","uname","exparams","themes","callbacks","backURL"]),e.global.siteid=(e.global.siteid+"").replace(/^\s+|\s+$/,""),e.global.settingid=(e.global.settingid+"").replace(/^\s+|\s+$/,""),e.global.siteid=e.global.siteid&&s.test(e.global.siteid)?e.global.siteid:e.extParmas.siteid||"",""!==e.global.siteid&&(e.global.pagetype=e.params.source||"",e.global.sellerid=e.isArray(e.global.sellerid)?e.global.sellerid:e.global.sellerid.toString().indexOf(",")>-1?e.global.sellerid.split(","):e.global.sellerid?[e.global.sellerid]:[],e.global.orderid=e.isArray(e.global.orderid)?e.global.orderid:e.global.orderid.toString().indexOf(",")>-1?e.global.orderid.split(","):e.global.orderid?[e.global.orderid]:[],e.global.orderprice=e.isArray(e.global.orderprice)?e.global.orderprice:e.global.orderprice.toString().indexOf(",")>-1?e.global.orderprice.split(","):e.global.orderprice?[e.global.orderprice]:[],e.inArray(e.global.siteid,a)>-1&&(e.global.shortid=e.global.uname||""),!e.global.itemid&&e.global.ntalkerparam&&(e.isObject(e.global.ntalkerparam)||e.Log("ntalkerparam param abnormal",2),e.global.ntalkerparam.item&&(e.global.itemid=e.global.ntalkerparam.item.id)),/number|string/i.test(typeof e.global.shortid)&&/string/i.test(typeof e.global.uname)||(e.Log("userid or username type error"),e.global.shortid="",e.global.uname=""),e.referrer=e.enCut(e.referrer,255),e.global.settingid=e.global.settingid&&/[a-z]{2}\_\d+\_\d+/gi.test(e.global.settingid)?e.global.settingid:"",e.global.iconid=e.isNumeric(e.global.iconid)?e.global.iconid:0,e.global.title=e.enCut(e.title,255),e.global.shortid=e.global.shortid&&"0"!=e.global.shortid?e.enCut(e.global.shortid,64-e.enLength(e.global.siteid)-10):"",e.global.uname=!e.global.shortid||"0"==e.global.shortid||/^(undefined|null|0)$/gi.test(e.global.uname)?"":e.global.uname?e.enCut(e.global.uname,32):e.enCut(e.global.shortid,32),e.global.uid=this.toLongID(e.global.shortid),e.global.isvip=e.isNumeric(e.global.isvip)?e.global.isvip:e.isNumeric(e.global.userlevel)?e.global.userlevel:0,e.global.userlevel=e.isNumeric(e.global.userlevel)?e.global.userlevel:0,e.inArray(e.global.siteid,a)>-1&&(e.global.shortid=e.global.uname||""),e.global=this.filterJSONChar(e.global,""),this.changeDataFormat(),e.Log("global: "+e.JSON.toJSONString(e.global),1),e.global)},changeDataFormat:function(){var t=e.global.callbacks,a={};if(!e.isArray(t)||0===t.length)return void(e.global.callbacks=a);for(var i=0;i<t.length;i++)!e.isArray(t[i])||t[i].length<2||!e.isFunction(t[i][1])||(a[t[i][0]]=t[i][1]);e.global.callbacks=a},_filterChar:function(t,a){var i,o,n=[];a&&e.each(this.entityList,function(e,a){try{i=new RegExp(e,"gi"),t=t.replace(i,a)}catch(o){}});for(var l=0,r=t.length;l<r;l++)try{o=encodeURIComponent(t.charAt(l)),n.push(t.charAt(l))}catch(s){try{o=encodeURIComponent(t.charAt(l)+t.charAt(l+1)),n.push((n.length?" ":"")+o.replace(/%/gi,"")+(l+2>=r?"":" ")),++l}catch(s){n.push(t.charAt(l))}}return n.join("")},filterJSONChar:function(t,a){var i,o=this;if(e.isObject(t))i={},e.each(t,function(e,t){i[e]=o.filterJSONChar(t,e)});else if(e.isArray(t)){i=[];for(var n=0;n<t.length;n++)i[n]=this.filterJSONChar(t[n],n)}else i="string"==typeof t?this._filterChar(t,e.inArray(a,this.fieldList)!==-1):t;return i},_loadIdentityID:function(t){var a,i,o=this,n="",l=function(t,a){if("undefined"!=typeof ntalker&&ntalker.pushUserInfo&&!identityInfoJson.pcid){i&&clearTimeout(i);var i=setTimeout(ntalker.pushUserInfo({pcid:a,uid:t,shortid:e.global.shortid,uname:e.global.uname}),200)}};if("undefined"!=typeof ntalker)try{e.Log("get sdk pcid"),this.identityInfoJson=e.JSON.parseJSON(ntalker.getIdentityInfo()),this.identityInfoJson&&(n=this.identityInfoJson.pcid,e.global.trailid=this.identityInfoJson.tid,e.global.uid=this.identityInfoJson.uid,e.user.id=this.identityInfoJson.uid,e.global.shortid=this.identityInfoJson.shortid,this.useSdkData=!0)}catch(r){e.Log("get sdk pcid"),ntalker.getIdentityID&&"function"==typeof ntalker.getIdentityID&&(n=ntalker.getIdentityID())}e.Log("ntalker type : "+typeof ntalker),""===n&&(n=e.cookie.get(e.CON_PCID_KEY)),this.useSdkData&&e.global.trailid||(e.global.trailid=e.cache.get("tid")),this.userIdFix=e.global.siteid+"_ISME9754_",e.global.trailid&&!this.useSdkData&&(i=Math.round((e.getTime()-+e.global.trailid.toString().substr(0,13))/36e5),i>=4&&(e.global.trailid="")),(!e.global.trailid||e.url.indexOf("livecrmtest")>-1)&&(e.global.trailid=e.getTime(2),e.base.clearChatCache=!0,e.flashData&&e.flashData.clearAll()),n&&n.length>10?(a=e.global.uid&&e.global.uid.indexOf(e.global.siteid)>-1?e.global.uid:this.userIdFix+n.substr(0,21),e.Log("load PCID:"+n+", uid:"+a),t.call(this,a,n),this.useSdkData||l(a,n)):e.flash.support&&!e.browser.mobile?(this._createNTID({u:e.global.uid,siteid:e.global.siteid,loadnid:e.CON_LOAD_MODE_NID}),n=this._createScriptPCID(!0),e.Log("create flash PCID, tmp pcid:"+n),a=e.global.uid||this.userIdFix+n.substr(0,21),e.global.pcid=n,e.user.id=a,this._connectTimeID=setTimeout(function(){e.global.connect=e.CON_CONNECT_COMET,e.Log("timeout:"+o.timeOut+" no create pcid",2),t.call(o,a,n),l(a,n)},this.timeOut)):e.cookie.enable()?(n=this._createScriptPCID(!1),e.Log("create script PCID"),a=e.global.uid||this.userIdFix+n.substr(0,21),t.call(this,a,n),l(a,n)):e.require({Fingerprint2:"fingerprint2.js"+e.baseExt},function(i){return e.Fingerprint2?(fingerprint2=new e.Fingerprint2,void fingerprint2.get(function(i){n="guest-Fin"+i,a=e.global.uid||o.userIdFix+n.substr(0,21),t(a,n),l(a,n)})):void e.Log("load Fingerprint2 failure")})},_createNTID:function(t){var a=e("#"+i),n=e.flashHtml(o,e.sourceURI+"fs/NTID.swf?"+e.version.ntid,t);a.length||(a=e(document.body).insert('<div id="'+i+'" style="position: absolute; z-index: 9996; top: -200px;"></div>')),a.insert(n)},_createScriptPCID:function(t){return"guest"+[t?"TEMP"+e.randomChar(4):e.randomChar(8),e.randomChar(4),e.randomChar(4),e.randomChar(4),e.getTime().toString(16).toUpperCase().substr(-8)+e.randomChar(4)].join("-")},_loadFlashServer:function(){e.Log("start load flashserver."),e.require({flashserver:e.server.flashserver+"/func/getflashserver.php?"+e.toURI({resulttype:1,siteid:e.global.siteid,callbackname:"nTalk._callFlashServer"})+"#rnd"},function(t){t=e.extend({},l,t),e.server=e.protocolFilter(e.extend(e.server,t))})},fire:function(t,a){return!e.global.callbacks[t]||e.global.callbacks[t].apply(this,a)}},e.extend({_callFlashServer:function(t,a){e.flashserver=t,e.server=e.protocolFilter(e.extend(e.server,e.flashserver)),e.Log("$flashserver loading is complete. resultType:"+a)},fIM_presenceFlashReady:function(t,a){return setTimeout(function(){e.base._identityIDReady?(e.Log("$.fIM_presenceFlashReady()"),e.Event.fireEvent(document,"focus")||e.Event.fireEvent(document,"click"),e.im&&e.im.connect&&e.im.connect.stopSwitchConnect()):(e.Log(">RETURN flash PCID, uid:"+t+", pcid:"+a,1),t&&a&&e.base.startOtherMode(t,a))},0),!0},isJsReady:function(){return!0},_createMobileOpenInPageWindow:function(t){var a=e(".ntalk-mobile-inpage-window");if(a.length)return t||e._showMobileInPageWindow(),{created:!1,element:a};var i=1;return chatElementBack=e({tag:"div",className:"ntalk-mobile-inpage-background",style:"background:rgba(0,0,0,0.3);width:100%;height:100%;position:absolute;left:0;top:0px;-webkit-overflow-scrolling: touch;overflow:hidden;z-index:1000000000000000;display:none;"}).appendTo(!0),a=e({className:"ntalk-mobile-inpage-window","data-status":"visible",style:e.STYLE_BODY+"background:#fff;width:100%;height:100%;position:fixed;left:0;bottom:0px;-webkit-overflow-scrolling: touch;overflow:hidden;z-index:1000000000000000;display:block;"}).appendTo(chatElementBack),a.bind("touchmove",function(t){e.Event.fixEvent(t).stopPropagation()}),(e.browser.micromessenger||e.browser.weibo)&&(i=.9),a.css({width:"100%",height:100*i+"%"}),"hidden"==a.attr("data-status")?a.css("top",100*i+"%"):a.css("bottom","0px"),e(window).bind("resize",function(){var t=1;(e.browser.micromessenger||e.browser.weibo)&&(t=.9),a.css({width:"100%",height:100*t+"%"}),"hidden"==a.attr("data-status")?a.css("height",100*t+"%"):a.css("bottom","0px")}),t||e._showMobileInPageWindow(),chatElementBack.bind("click",function(){e._hideMobileInPageWindow()}),a.bind("click",function(){e.Event.fixEvent(event).stopPropagation()}),{created:!0,element:a}},_createMobileIframeWindow:function(t){var a,i=e(".ntalk-mobile-iframe-window"),o=e("IFRAME[name="+t+"]");return i.length?{created:!1,element:i}:(i=e({className:"ntalk-mobile-iframe-window","data-status":"visible",style:e.STYLE_BODY+"background:#fff;width:100% !important;height:100% !important;position:fixed;left:0;top:0px;-webkit-overflow-scrolling: touch;overflow-y:scroll"}).appendTo(!0),o=e({tag:"IFRAME",name:t,style:e.STYLE_BODY+"width:100% !important;height:100% !important;display:block !important;",src:"about:blank"}).appendTo(".ntalk-mobile-iframe-window"),e(window).bind("resize",function(){e(o).css({width:"100%",height:e(window).height()+"px"}),"hidden"==i.attr("data-status")?i.css("top",e(window).height()+"px"):i.css("top","0px")}),a=o[0].contentWindow,e.listenerMessage(function(t){e.Log("listenerMessage:"+t);var a;try{t=e.JSON.parseJSON(t),a=t.funcName}catch(o){a=t}switch(a){case"showMobileIframeWindow":e._showMobileIframeWindow(i);break;case"hideMobileIframeWindow":e._hideMobileIframeWindow(i,!1);break;case"closeMobileIframeWindow":e._hideMobileIframeWindow(i,!0);break;case"closeMobileIframeWindowCallbacks":e.base.fire("WapClose",[]);case"backMobileIframeWindowCallBacks":e.base.fire("WapBack",[])}if(t&&e.isArray(t)&&t.indexOf("destInfo")>-1&&"function"==typeof im_destUserInfo&&3==t.split(",").length){var n=t.split(",")[1],l=t.split(",")[2];im_destUserInfo({id:n,name:l})}}),{created:!0,element:i})},_showMobileIframeWindow:function(t){nTalk.isObject(t)&&t.talkVersion&&(e("html").addClass("full-html"),e("body").addClass("full-body"),t.addClass("full-iframe"),t.css("z-index","999999999"),e.browser.mobile&&0==e("meta[name=viewport]").length&&e({tag:"meta",id:"nTalk-window-meta",name:"viewport",content:"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"}).appendTo(e("head")))},_hideMobileIframeWindow:function(t,a){return nTalk.isObject(t)&&t.talkVersion?(e("html").removeClass("full-html"),e("body").removeClass("full-body"),t.removeClass("full-iframe"),t.css({"z-index":-1,display:"none"}),e.browser.mobile&&e("#nTalk-window-meta").remove(),void(a&&(t.remove(),e.removelistenerMessage()))):t},addMobileStyle:function(e){var t=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e)),t.appendChild(a)}}),e.extend({im_openInPageChat:function(t,a,i,o,n){var l,r,s,d;if(!e.base._startBase)return e.base.start(),void function(){s=arguments,e.base._startBase?e.im_openInPageChat(t,a,i,o,n):setTimeout(function(){s.callee()},50)}();if(e.base.chanageUserID())return void e.base.overloadedData(function(){e.im_openInPageChat(t,a,i,o,n)});if(e.invite&&e.invite._close(),e.Log("nTalk.im_openInPageChat()",1),t=!t&&i?"":t||e.global.settingid||"",l=e.global.settingid?e.global.settingid.split("_").splice(0,2).join("_"):"",r=t?t.split("_").splice(0,2).join("_"):"",d=e.global.sellerid&&e.global.sellerid.length?e.global.sellerid[0]:"",o=e.extend({},o),a||(r&&(""===r||r!=d&&r!=l)?(a="",n=""):(a=e.global.itemid,n=e.global.itemparam)),d=r!=e.global.siteid?r:"",e.Log("settingId:"+t+", itemId:"+a+", itemparam:"+n),(e.browser.mobile||e.global.pageinchat!==!0)&&!e.mobileOpenInChat)return this.im_openOutPageChat(t,a,i,o,n);2!=e.server.notrail||e.base.call_trail_status||(e.base.call_trail_status=!0,e.base.startTrail());var g=o&&o.single?o.single:"",c=o&&o.manual?1:0,b=!(!o||!e.isDefined(o.autoconnect))&&o.autoconnect,u=o&&o.edu_inviteid?o.edu_inviteid:"",h=o&&o.edu_visitid?o.edu_visitid:"";e.browser.mobile&&e.mobileOpenInChat&&this._createMobileOpenInPageWindow(u),e.base.startChat(t,i,a,n,d,b,g,c,u,h)},im_openOutPageChat:function(t,a,i,o,n){var l,r,s,d;if(!e.base._startBase)return e.base.start(),void function(){s=arguments,e.base._startBase?e.im_openInPageChat(t,a,i,o,n):setTimeout(function(){s.callee()},50)}();if(e.base.chanageUserID())return void e.base.overloadedData(function(){e.im_openInPageChat(t,a,i,o,n)});e.Log("nTalk.im_openOutPageChat()",1),t=t||e.global.settingid||"",l=e.global.settingid?e.global.settingid.split("_").splice(0,2).join("_"):"",r=t?t.split("_").splice(0,2).join("_"):"",d=e.global.sellerid&&e.global.sellerid.length?e.global.sellerid[0]:"",o=e.extend({},o),a||(r&&(""===r||r!=d&&r!=l)?(a="",n=""):(a=e.global.itemid,n=e.global.itemparam)),d=r!=e.global.siteid?r:"",e.Log("settingId:"+t+", itemId:"+a+", itemparam:"+n);var g,c=e.browser.mobile?"_self":"_blank",b=o&&o.single?o.single:"",u=(o&&o.manual?1:0,{v:e.version.script,siteid:e.global.siteid,sellerid:d,settingid:t,baseuri:e.baseURI,mobile:e.browser.mobile?1:0,lan:e.extParmas.lan||"",ref:e.enCut(e.url,255),tit:e.global.title,iframechat:o.iframechat||"0",header:e.isDefined(o.header)?o.header:"1",edu_inviteid:o&&o.edu_inviteid?o.edu_inviteid:"",edu_visitid:o&&o.edu_visitid?o.edu_visitid:"",backURL:e.global.backURL,rnd:e.getTime()}),h={uid:e.user.id,uname:e.user.name,pcid:e.global.pcid,vip:e.global.isvip,ulevel:e.global.userlevel,destid:i||"",single:b?b:i?i.indexOf("GT2D")>-1?0:1:-1,chattype:"",chatvalue:"",itemid:a,itemparam:n,erpparam:e.global.erpparam,"ntalker-debug":e.params["ntalker-debug"]||e.cache.get("debug"),exparams:e.global.exparams};if("undefined"!=typeof ntalker&&ntalker.openChatWindow){sdkQuery=e.extend({},u,h),sdkQuery.uid=e.base.toShortID(sdkQuery.uid),sdkQuery.flashserver=e.server.flashserver,e.Log("call ntalker.openChatWindow()",2);var m=ntalker.openChatWindow(e.JSON.toJSONString(sdkQuery));if(e.Log("call ntalker.openChatWindow()>>"+m,3),0===m)return;e.Log("call ntalker.openChatWindow()>>"+m,3)}return e.global.themes&&(u.themes=e.global.themes),o.iframechat?(c="ntalk-mobile-chat",e.require({animate:"nt2.js"+e.baseExt},function(t){return e.animate?(g=e._createMobileIframeWindow(c),(!g||g&&g.created===!0)&&(e.objectPost=new e.POST(e.server.flashserver+"chat.php?"+e.toURI(u,!0,"&"),h,function(){e.Log("open chat window complete",1)},c)),void e._showMobileIframeWindow(g.element)):void e.Log("Loaded $nt2 mode failed",3)}),null):((!g||g&&g.created===!0)&&(e.objectPost=new e.POST(e.server.flashserver+"chat.php?"+e.toURI(u,!0,"&"),h,function(){e.Log("open chat window complete",1)},c)),g?g.element:e.objectPost.iframeElement)},im_getAppChatWindowURL:function(t,a){var i,o,n,l,r,s,d,g,c;if(!e.base._startBase)return e.base.start(),void function(){n=arguments,e.base._startBase?e.im_getAppChatWindowURL(t,a):setTimeout(function(){n.callee()},50)}();if(e.base.chanageUserID())return void e.base.overloadedData(function(){e.im_getAppChatWindowURL(t,a)});e.Log("nTalk.im_getAppChatWindowURL()",1),"function"==typeof t?(a=t,t={}):t=e.extend({},t),r=t.destid||"",s=t.settingId||e.global.settingid||"",i=e.global.settingid?e.global.settingid.split("_").splice(0,2).join("_"):"",o=t.settingid?t.settingid.split("_").splice(0,2).join("_"):"",l=e.global.sellerid&&e.global.sellerid.length?e.global.sellerid[0]:"",c=e.extend({},t.options),t.itemid?(d=t.itemid,g=t.itemparam):o&&(""===o||o!==l&&o!==i)?(d="",g=""):(d=e.global.itemid,g=e.global.itemparam),l=o!=e.global.siteid?o:"",e.Log("settingId:"+s+", itemId:"+d+", itemparam:"+g);var b=c&&c.single?c.single:"",u=(c&&c.manual?1:0,{v:e.version.script,siteid:e.global.siteid,sellerid:l,settingid:s,baseuri:e.baseURI,mobile:e.browser.mobile?1:0,lan:e.extParmas.lan||"",header:e.isDefined(c.header)?c.header:"1",uid:e.user.id,uname:e.user.name,pcid:e.global.pcid,vip:e.global.isvip,ulevel:e.global.userlevel,destid:r||"",single:b?b:r?r.indexOf("GT2D")>-1?0:1:-1,chattype:"",chatvalue:"",itemid:d,itemparam:g,erpparam:e.global.erpparam,ref:e.enCut(e.url,255),tit:e.global.title,"ntalker-debug":e.params["ntalker-debug"]||e.cache.get("debug")||"",exparams:e.global.exparams});e.isFunction(a)&&a.call(self,e.server.flashserver+"recieve.php?"+e.toURI(u,!0,"&"))},im_updatePageInfo:function(t){e.base.overloadedData(t)},im_addTrailInfo:function(t,a,i){e.referrer=e.url,e.title=t||document.title,e.url=a||document.location.href,e.base.overloadedData(i)},t2d:{openChatWindow:function(t,a,i){e.im_openOutPageChat(i,"",t,null,"")}},enableDebug:function(){return e.cache.get("debug")||e.cache.set("debug",2),e.mDebug||e.require({mDebug:"debug.js"+e.baseExt,Window:"nt2.js"+e.baseExt},function(t){t&&!t.error&&(e.mDebug.initialize(),e.Log=e.mDebug.Log,e.debug=e.mDebug)}),e.cache.get("debug")}}),!e.isDefined(CON_SERVER))throw"CON_SERVER is not defined";e.imageloading=e.sourceURI+"images/loading.gif",e.server=e.extend({},e.protocolFilter(CON_SERVER)),e.version=e.extend({},e.version,CON_VERSION),e.baseExt="?siteid="+(e.extParmas.siteid||"")+"&v="+e.version.dir+"&t="+e.version.release,parseFloat(e.params["ntalker-debug"])>0||+e.cache.get("debug")>0?e.require({mDebug:"debug.js"+e.baseExt,Window:"nt2.js"+e.baseExt},function(t){t&&!t.error&&(e.mDebug.initialize(),e.Log=e.mDebug.Log,e.debug=e.mDebug,e.base.start())}):(e.Log=r,e.debug={Log:e.Log},e.base.start()),e._showMobileInPageWindow=function(){e("html").addClass("full-html"),e("body").addClass("full-inpage"),e("body").css("padding")&&(e.rememberBodyPadding=e("body").css("padding"),e("body").css({padding:0})),e(".ntalk-mobile-inpage-background").css({"z-index":999999999,display:"block"}),e(".ntalk-mobile-inpage-window").css({display:"block",width:"100%",height:e.flashserver.reversechat&&(e.browser.micromessenger||e.browser.weibo)?"90%":"100%"})},e._hideMobileInPageWindow=function(){e.rememberBodyPadding&&e("body").css({padding:e.rememberBodyPadding}),e("html").removeClass("full-html"),e("body").removeClass("full-inpage"),e(".ntalk-mobile-inpage-background").css({"z-index":-1,display:"none"}),e(".nTalk-window-offLine").css("display","none"),e.fim_offlineMssage("","","",!0)},e._closeMobileInPageWindow=function(){e.rememberBodyPadding&&e("body").css({padding:e.rememberBodyPadding}),e("html").removeClass("full-html"),e("body").removeClass("full-inpage"),e("#ntalk-chat-loading").length>0&&e("#ntalk-chat-loading").remove(),e(".ntalk-mobile-inpage-background").remove(),e(".nTalk-window-offLine").css("display","none")},e.require(e.imageloading),e.extend({getUserInfo:function(){if(e.global&&e.global.pcid&&e.user&&e.user.id)return{clientId:e.global.pcid,userId:e.user.id,userName:e.user.name,shortId:""==e.global.shortid?e.user.id.substr(e.user.id.indexOf("_ISME9754_")+10):e.global.shortid}},getTrailSessionId:function(){if(e.global&&e.global.trailid)return e.global.trailid},setBackUrl:function(t){e.global?e.global.backURL=encodeURIComponent(t):setTimeout(function(){nTalk.setBackUrl(t)},300)}})}}(nTalk);